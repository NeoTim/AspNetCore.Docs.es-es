---
title: Enrutamiento en ASP.NET Core
author: rick-anderson
description: Descubra cómo el enrutamiento de ASP.NET Core es responsable de asignar URI de solicitud a los selectores de punto de conexión y de distribuir las solicitudes entrantes a los puntos de conexión.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 09/24/2019
uid: fundamentals/routing
ms.openlocfilehash: 8b4da4e1e262ec82225413d0338b3492d0b5e152
ms.sourcegitcommit: 032113208bb55ecfb2faeb6d3e9ea44eea827950
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/31/2019
ms.locfileid: "73190506"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="f7739-103">Enrutamiento en ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="f7739-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="f7739-104">Por [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/) y [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="f7739-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="f7739-105">El enrutamiento es responsable de asignar URI de solicitud a los puntos de conexión y de distribuir las solicitudes entrantes a esos puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-105">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="f7739-106">Las rutas se definen en la aplicación y se configuran cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-106">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f7739-107">Una ruta puede extraer opcionalmente valores de la dirección URL contenida en la solicitud, que se pueden usar para procesar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f7739-108">Con la información de ruta de la aplicación, el enrutamiento también puede generar direcciones URL que se asignan a puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-108">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f7739-109">En este documento se describe el enrutamiento de ASP.NET Core de bajo nivel.</span><span class="sxs-lookup"><span data-stu-id="f7739-109">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f7739-110">Para obtener información sobre el enrutamiento de ASP.NET Core MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-110">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f7739-111">Para obtener más información sobre las convenciones de enrutamiento en Razor Pages, consulte <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-111">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-112">[Vea o descargue el código de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f7739-112">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f7739-113">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-113">Routing basics</span></span>

<span data-ttu-id="f7739-114">La mayoría de las aplicaciones deben elegir un esquema de enrutamiento básico y descriptivo para que las direcciones URL sean legibles y significativas.</span><span class="sxs-lookup"><span data-stu-id="f7739-114">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f7739-115">La ruta convencional predeterminada `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f7739-115">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f7739-116">Admite un esquema de enrutamiento básico y descriptivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-116">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f7739-117">Se trata de un punto de partida útil para las aplicaciones basadas en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="f7739-117">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f7739-118">Los desarrolladores suelen agregar rutas breves adicionales a áreas de mucho tráfico de una aplicación en situaciones especializadas (por ejemplo, puntos de conexión de blog y comercio electrónico) con el [enrutamiento mediante atributos](xref:mvc/controllers/routing#attribute-routing) o rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f7739-118">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f7739-119">Las API web deben usar el enrutamiento mediante atributos para modelar la funcionalidad de la aplicación como un conjunto de recursos donde las operaciones se representan mediante verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-119">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f7739-120">Esto significa que muchas operaciones (por ejemplo, GET y POST) del mismo recurso lógico usarán la misma dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-120">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f7739-121">El enrutamiento mediante atributos proporciona un nivel de control que es necesario para diseñar cuidadosamente un diseño de puntos de conexión públicos de la API.</span><span class="sxs-lookup"><span data-stu-id="f7739-121">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f7739-122">En las aplicaciones de Razor Pages se usa el enrutamiento convencional predeterminado para proporcionar recursos con nombre en la carpeta *Páginas* de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-122">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f7739-123">Existen convenciones adicionales que permiten personalizar el comportamiento de enrutamiento de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-123">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f7739-124">Para obtener más información, vea <xref:razor-pages/index> y <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-124">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-125">La compatibilidad de la generación de direcciones URL permite desarrollar la aplicación sin codificar de forma rígida las direcciones URL para vincular la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-125">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f7739-126">Esta compatibilidad permite empezar con una configuración de enrutamiento básica y modificar las rutas una vez determinado el diseño de los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-126">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f7739-127">El enrutamiento usa *puntos de conexión* (`Endpoint`) para representar los puntos de conexión lógicos en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-127">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="f7739-128">Un punto de conexión define un delegado para procesar las solicitudes y una colección de metadatos arbitrarios.</span><span class="sxs-lookup"><span data-stu-id="f7739-128">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="f7739-129">Los metadatos se usan para implementar cuestiones transversales según las directivas y la configuración asociada a cada punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-129">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="f7739-130">El sistema de enrutamiento tiene las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-130">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f7739-131">La sintaxis de plantilla de ruta se usa para definir las rutas con parámetros de ruta con tokens.</span><span class="sxs-lookup"><span data-stu-id="f7739-131">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f7739-132">Se permite la configuración de puntos de conexión de estilo convencional y de estilo de atributo.</span><span class="sxs-lookup"><span data-stu-id="f7739-132">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f7739-133">Se usa <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para determinar si un parámetro de dirección URL contiene un valor válido para una restricción de punto de conexión determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-133"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f7739-134">Los modelos de aplicación, como MVC y Razor Pages, registran todos sus puntos de conexión, que presentan una implementación predecible de los escenarios de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-134">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f7739-135">La implementación de enrutamiento toma decisiones relativas al enrutamiento siempre que sea lo deseado en la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="f7739-135">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="f7739-136">El middleware que aparece después de un middleware de enrutamiento puede inspeccionar el resultado de la decisión del punto de conexión del middleware de enrutamiento para un URI de solicitud determinado.</span><span class="sxs-lookup"><span data-stu-id="f7739-136">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="f7739-137">Se pueden enumerar todos los puntos de conexión de la aplicación en cualquier parte de la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="f7739-137">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="f7739-138">Una aplicación puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información del punto de conexión. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-138">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f7739-139">La generación de direcciones URL se basa en direcciones, que admiten la extensibilidad arbitraria:</span><span class="sxs-lookup"><span data-stu-id="f7739-139">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="f7739-140">La API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) se puede resolver en cualquier lugar mediante la [inserción de dependencias (DI)](xref:fundamentals/dependency-injection) para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-140">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="f7739-141">Cuando la API del generador de vínculos no está disponible a través de DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> ofrece métodos para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-141">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="f7739-142">La vinculación de puntos de conexión está limitada a las acciones y las páginas de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-142">Endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="f7739-143">Las expansiones de las funciones de vinculación de punto de conexión están previstas para próximas versiones.</span><span class="sxs-lookup"><span data-stu-id="f7739-143">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="f7739-144">La clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> conecta el enrutamiento a la canalización de [software intermedio](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="f7739-144">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f7739-145">[ASP.NET Core MVC](xref:mvc/overview) agrega enrutamiento a la canalización de middleware como parte de su configuración y controla el enrutamiento en las aplicaciones de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-145">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f7739-146">Para obtener información sobre cómo usar el enrutamiento como componente independiente, vea la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f7739-146">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f7739-147">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-147">URL matching</span></span>

<span data-ttu-id="f7739-148">La coincidencia de dirección URL es el proceso por el cual el enrutamiento envía una solicitud entrante a un *punto de conexión*.</span><span class="sxs-lookup"><span data-stu-id="f7739-148">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="f7739-149">Este proceso se basa en datos de la ruta de dirección URL, pero se puede ampliar para tener en cuenta cualquier dato de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-149">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f7739-150">La capacidad de enviar solicitudes a controladores independientes es clave para escalar el tamaño y la complejidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-150">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f7739-151">Cuando se ejecuta un middleware de enrutamiento, se establece un punto de conexión (`Endpoint`) y se enrutan los valores a una característica de <xref:Microsoft.AspNetCore.Http.HttpContext>.</span><span class="sxs-lookup"><span data-stu-id="f7739-151">When a Routing Middleware executes, it sets an endpoint (`Endpoint`) and route values to a feature on the <xref:Microsoft.AspNetCore.Http.HttpContext>.</span></span> <span data-ttu-id="f7739-152">Para la solicitud actual:</span><span class="sxs-lookup"><span data-stu-id="f7739-152">For the current request:</span></span>

* <span data-ttu-id="f7739-153">Al llamar a `HttpContext.GetEndpoint` se obtiene el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-153">Calling `HttpContext.GetEndpoint` gets the endpoint.</span></span>
* <span data-ttu-id="f7739-154">`HttpRequest.RouteValues` obtiene la colección de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-154">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="f7739-155">El middleware que se ejecuta después del middleware de enrutamiento puede ver el punto de conexión y tomar medidas.</span><span class="sxs-lookup"><span data-stu-id="f7739-155">Middleware running after the Routing Middleware can see the endpoint and take action.</span></span> <span data-ttu-id="f7739-156">Por ejemplo, un middleware de autorización puede consultar la colección de metadatos del punto de conexión de una directiva de autorización.</span><span class="sxs-lookup"><span data-stu-id="f7739-156">For example, an Authorization Middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="f7739-157">Después de que se ejecuta todo el middleware en la canalización de procesamiento de solicitudes, se invoca al delegado del punto de conexión seleccionado.</span><span class="sxs-lookup"><span data-stu-id="f7739-157">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="f7739-158">El sistema de enrutamiento en el enrutamiento de punto de conexión es responsable de todas las decisiones relativas al envío.</span><span class="sxs-lookup"><span data-stu-id="f7739-158">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="f7739-159">Como el middleware aplica las directivas en función del punto de conexión seleccionado, es importante que cualquier decisión que pueda afectar a la distribución o la aplicación de directivas de seguridad se realice dentro del sistema de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-159">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="f7739-160">Cuando se ejecuta el delegado del punto de conexión, las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) se establecen en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="f7739-160">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f7739-161">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) es un diccionario de los *valores de ruta* generados desde la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-161">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f7739-162">Estos valores se suelen determinar mediante la conversión en tokens de la dirección URL, y se pueden usar para aceptar la entrada del usuario o para tomar otras decisiones sobre el envío dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-162">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f7739-163">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) es un contenedor de propiedades de datos adicionales relacionados con la ruta coincidente.</span><span class="sxs-lookup"><span data-stu-id="f7739-163">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f7739-164">Se proporcionan <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> para permitir la asociación de datos de estado con cada ruta, de modo que la aplicación pueda tomar decisiones en función de las rutas que han coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-164"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f7739-165">Estos valores los define el desarrollador y **no** afectan de ninguna manera al comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-165">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f7739-166">Además, los valores que se guardan provisionalmente en [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) pueden ser de cualquier tipo, a diferencia de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que deben poder convertirse fácilmente en cadenas y a partir de estas.</span><span class="sxs-lookup"><span data-stu-id="f7739-166">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f7739-167">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) es una lista de las rutas que han participado en encontrar una coincidencia correcta con la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-167">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f7739-168">Las rutas se pueden anidar unas dentro de otras.</span><span class="sxs-lookup"><span data-stu-id="f7739-168">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f7739-169">La propiedad <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> refleja la ruta de acceso del árbol lógico de rutas que han tenido como resultado una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-169">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f7739-170">Por lo general, el primer elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es la colección de rutas y se debe usar para la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-170">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f7739-171">El último elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es el controlador de ruta que ha coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-171">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="f7739-172">Generación de direcciones URL con LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="f7739-172">URL generation with LinkGenerator</span></span>

<span data-ttu-id="f7739-173">La generación de dirección URL es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL basada en un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-173">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f7739-174">Esto permite una separación lógica entre los puntos de conexión y las direcciones URL que tienen acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="f7739-174">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="f7739-175">El enrutamiento de punto de conexión incluye la API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="f7739-175">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="f7739-176"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> es un servicio singleton que se puede recuperar a partir de la DI.</span><span class="sxs-lookup"><span data-stu-id="f7739-176"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="f7739-177">La API se puede usar fuera del contexto de una solicitud en ejecución.</span><span class="sxs-lookup"><span data-stu-id="f7739-177">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="f7739-178"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC y los escenarios que dependen de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como los [asistentes de etiquetas](xref:mvc/views/tag-helpers/intro), los de HTML y [los resultados de acción](xref:mvc/controllers/actions), usan el generador de vínculos para proporcionar funciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-178">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="f7739-179">El generador de vínculos está respaldado por el concepto de una *dirección* y *esquemas de direcciones*.</span><span class="sxs-lookup"><span data-stu-id="f7739-179">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="f7739-180">Un esquema de direcciones es una manera de determinar los puntos de conexión que se deben tener en cuenta para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-180">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="f7739-181">Por ejemplo, los escenarios de nombre y valores de ruta de Razor Pages y MVC con los que muchos usuarios están familiarizados se implementan como un esquema de direcciones.</span><span class="sxs-lookup"><span data-stu-id="f7739-181">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="f7739-182">El generador de vínculos puede vincular a acciones y páginas de Razor Pages y MVC a través de los métodos de extensión siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-182">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="f7739-183">Una sobrecarga de estos métodos acepta argumentos que incluyan `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="f7739-183">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="f7739-184">Estos métodos son equivalentes funcionalmente a `Url.Action` y `Url.Page`, pero ofrecen flexibilidad y opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-184">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="f7739-185">Los métodos `GetPath*` son más similares a `Url.Action` y `Url.Page`, dado que generan un URI que contiene una ruta de acceso absoluta.</span><span class="sxs-lookup"><span data-stu-id="f7739-185">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="f7739-186">Los métodos `GetUri*` siempre generan un URI absoluto que contiene un esquema y un host.</span><span class="sxs-lookup"><span data-stu-id="f7739-186">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="f7739-187">Los métodos que aceptan `HttpContext` generan un URI en el contexto de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="f7739-187">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="f7739-188">A menos que se reemplacen, se usan los valores de ruta de ambiente, la ruta de acceso base de la dirección URL, el esquema y el host de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="f7739-188">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="f7739-189">Se llama a <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con una dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-189"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="f7739-190">La generación de un URI se produce en dos pasos:</span><span class="sxs-lookup"><span data-stu-id="f7739-190">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="f7739-191">Se enlaza una dirección a una lista de puntos de conexión que coincidan con la dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-191">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="f7739-192">Se evalúa el elemento `RoutePattern` de cada punto de conexión hasta que se encuentra un patrón de ruta que coincida con los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-192">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="f7739-193">La salida resultante se combina con otras partes del URI proporcionadas al generador de vínculos y devueltas.</span><span class="sxs-lookup"><span data-stu-id="f7739-193">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="f7739-194">Los métodos proporcionados por <xref:Microsoft.AspNetCore.Routing.LinkGenerator> admiten funciones estándar de generación de vínculos para cualquier tipo de dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-194">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="f7739-195">La forma más útil de usar el generador de vínculos es a través de métodos de extensión que realicen operaciones para un tipo de dirección específica.</span><span class="sxs-lookup"><span data-stu-id="f7739-195">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="f7739-196">Método de extensión</span><span class="sxs-lookup"><span data-stu-id="f7739-196">Extension Method</span></span> | <span data-ttu-id="f7739-197">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="f7739-197">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="f7739-198">Genera un URI con una ruta de acceso absoluta en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-198">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="f7739-199">Genera un URI absoluto en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-199">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="f7739-200">Preste atención a las consecuencias siguientes de llamar a los métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="f7739-200">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="f7739-201">Use los métodos de extensión `GetUri*` con precaución en una configuración de aplicación en la que no se valide el encabezado `Host` de las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="f7739-201">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="f7739-202">Si no se valida el encabezado `Host` de las solicitudes entrantes, la entrada de la solicitud que no sea de confianza se puede devolver al cliente en los URI de una página o vista.</span><span class="sxs-lookup"><span data-stu-id="f7739-202">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="f7739-203">Se recomienda que todas las aplicaciones de producción configuren su servidor para validar el encabezado `Host` en función de valores válidos conocidos.</span><span class="sxs-lookup"><span data-stu-id="f7739-203">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="f7739-204">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con precaución en el middleware junto con `Map` o `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="f7739-204">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="f7739-205">`Map*` cambia la ruta de acceso base de la solicitud que se ejecuta, lo que afecta a la salida de la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-205">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="f7739-206">Todas las API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permiten especificar una ruta de acceso base.</span><span class="sxs-lookup"><span data-stu-id="f7739-206">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="f7739-207">Especifique siempre una ruta de acceso base vacía para deshacer el efecto de `Map*` en la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-207">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="f7739-208">Diferencias con respecto a versiones anteriores del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-208">Differences from earlier versions of routing</span></span>

<span data-ttu-id="f7739-209">Existen algunas diferencias entre el enrutamiento de punto de conexión y las versiones anteriores del enrutamiento anteriores a ASP.NET Core 2.2:</span><span class="sxs-lookup"><span data-stu-id="f7739-209">A few differences exist between endpoint routing and versions of routing earlier than in ASP.NET Core 2.2:</span></span>

* <span data-ttu-id="f7739-210">El sistema de enrutamiento de punto de conexión no es compatible con la extensibilidad basada en <xref:Microsoft.AspNetCore.Routing.IRouter>, incluida la herencia de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-210">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="f7739-211">El enrutamiento de punto de conexión no es compatible con [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="f7739-211">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="f7739-212">Utilice la [versión compatibilidad](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) para seguir usando la corrección de compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="f7739-212">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="f7739-213">El enrutamiento de punto de conexión tiene un comportamiento diferente para el uso de mayúsculas y minúsculas en los URI generados al usar rutas convencionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-213">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="f7739-214">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-214">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f7739-215">Supongamos que genera un vínculo a una acción mediante la ruta siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-215">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="f7739-216">Con el enrutamiento basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, este código genera un URI de `/blog/ReadPost/17`, que respeta las mayúsculas y minúsculas del valor de ruta proporcionado.</span><span class="sxs-lookup"><span data-stu-id="f7739-216">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="f7739-217">El enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17` ("Blog" se pone mayúscula).</span><span class="sxs-lookup"><span data-stu-id="f7739-217">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="f7739-218">El enrutamiento de punto de conexión proporciona la interfaz `IOutboundParameterTransformer`, que se puede usar para personalizar este comportamiento de forma global, o bien para aplicar otras convenciones para la asignación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-218">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="f7739-219">Para obtener más información, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-219">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="f7739-220">La generación de vínculos que se usa en Razor Pages y MVC con las rutas convencionales tiene un comportamiento diferente al intentar vincularlo a un controlador o una acción, o a una página que no existe.</span><span class="sxs-lookup"><span data-stu-id="f7739-220">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="f7739-221">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-221">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f7739-222">Supongamos que genera un vínculo a una acción mediante la plantilla predeterminada con lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-222">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="f7739-223">Con el enrutamiento basado en `IRouter`, el resultado siempre es `/Blog/ReadPost/17`, incluso aunque `BlogController` no exista o no tenga un método de acción `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="f7739-223">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="f7739-224">Como se esperaba, si el método de acción existe, el enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17`.</span><span class="sxs-lookup"><span data-stu-id="f7739-224">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="f7739-225">*Sin embargo, si la acción no existe, el enrutamiento de punto de conexión genera una cadena vacía.*</span><span class="sxs-lookup"><span data-stu-id="f7739-225">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="f7739-226">Conceptualmente, el enrutamiento de punto de conexión no supone que, si la acción no existe, sí que exista el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-226">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="f7739-227">El *algoritmo de invalidación del valor de ambiente* de la generación de vínculos tiene otro comportamiento al usarlo con el enrutamiento de punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-227">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="f7739-228">La *invalidación del valor de ambiente* es el algoritmo que decide qué valores de ruta de la solicitud que se ejecuta actualmente (los valores de ambiente) se pueden usar en las operaciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-228">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="f7739-229">El enrutamiento convencional siempre invalida los valores de ruta adicionales al vincular a otra acción.</span><span class="sxs-lookup"><span data-stu-id="f7739-229">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="f7739-230">El enrutamiento mediante atributos no tenía este comportamiento antes del lanzamiento de ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="f7739-230">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="f7739-231">En versiones anteriores de ASP.NET Core, los vínculos a otra acción que usara los mismos nombres de parámetro de ruta producían errores de generación de vínculo.</span><span class="sxs-lookup"><span data-stu-id="f7739-231">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="f7739-232">En ASP.NET Core 2.2 o versiones posteriores, las dos formas de enrutamiento invalidan los valores cuando se vincula a otra acción.</span><span class="sxs-lookup"><span data-stu-id="f7739-232">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="f7739-233">Considere el ejemplo siguiente de ASP.NET Core 2.1 o una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="f7739-233">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f7739-234">Al vincular a otra acción (o a otra página), los valores de ruta se pueden reutilizar de formas no deseadas.</span><span class="sxs-lookup"><span data-stu-id="f7739-234">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="f7739-235">En */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f7739-235">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="f7739-236">En */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f7739-236">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="f7739-237">Si el URI es `/Store/Product/18` en ASP.NET Core 2.1 o versiones anteriores, el vínculo que genera `@Url.Page("/Login")` en la página Store/Info es `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="f7739-237">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="f7739-238">Se reutiliza el valor `id` de 18, aunque el destino del vínculo sea otro elemento totalmente distinto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-238">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="f7739-239">El valor de ruta `id` en el contexto de la página `/Login` probablemente sea un valor de id. de usuario, no un valor de id. de producto de tienda.</span><span class="sxs-lookup"><span data-stu-id="f7739-239">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="f7739-240">En el enrutamiento de punto de conexión con ASP.NET Core 2.2 o versiones posteriores, el resultado es `/Login`.</span><span class="sxs-lookup"><span data-stu-id="f7739-240">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="f7739-241">Los valores de ambiente no se reutilizan cuando el destino vinculado es otra acción o página.</span><span class="sxs-lookup"><span data-stu-id="f7739-241">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="f7739-242">Sintaxis de parámetro de ruta de ida y vuelta: las barras diagonales no se codifican cuando se usa una sintaxis de parámetro comodín de doble asterisco (`**`).</span><span class="sxs-lookup"><span data-stu-id="f7739-242">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="f7739-243">Durante la generación de vínculos, el sistema de enrutamiento codifica el valor capturado en un parámetro comodín de doble asterisco (`**`; por ejemplo, `{**myparametername}`), excepto las barras diagonales.</span><span class="sxs-lookup"><span data-stu-id="f7739-243">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="f7739-244">El comodín de doble asterisco es compatible con el enrutamiento basado en `IRouter` en ASP.NET Core 2.2 o versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="f7739-244">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="f7739-245">La sintaxis de parámetro comodín de un único asterisco en versiones anteriores de ASP.NET Core (`{*myparametername}`) sigue siendo compatible y las barras diagonales se codifican.</span><span class="sxs-lookup"><span data-stu-id="f7739-245">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="f7739-246">Ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-246">Route</span></span>              | <span data-ttu-id="f7739-247">Vínculo generado con</span><span class="sxs-lookup"><span data-stu-id="f7739-247">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="f7739-248">`/search/admin%2Fproducts` (la barra diagonal se codifica)</span><span class="sxs-lookup"><span data-stu-id="f7739-248">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="f7739-249">Ejemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="f7739-249">Middleware example</span></span>

<span data-ttu-id="f7739-250">En el ejemplo siguiente, un middleware usa la API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para crear el vínculo a un método de acción que enumera los productos de la tienda.</span><span class="sxs-lookup"><span data-stu-id="f7739-250">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="f7739-251">El uso del generador de vínculos mediante su inserción en una clase y la llamada a `GenerateLink` está disponible para cualquier clase de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-251">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="f7739-252">Creación de rutas</span><span class="sxs-lookup"><span data-stu-id="f7739-252">Create routes</span></span>

<span data-ttu-id="f7739-253">La mayoría de las aplicaciones crea rutas mediante una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> o a uno de los métodos de extensión similares definidos en <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f7739-253">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f7739-254">Todos los métodos de extensión <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> crean una instancia de <xref:Microsoft.AspNetCore.Routing.Route> y la agregan a la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="f7739-254">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f7739-255"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> no acepta un parámetro de controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-255"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f7739-256"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> solo agrega las rutas que se controlan mediante <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-256"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f7739-257">Para obtener más información sobre el enrutamiento en MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-257">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f7739-258">El código siguiente es un ejemplo de una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por una definición de ruta típica de ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f7739-258">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-259">Esta plantilla coincide con una ruta de dirección URL y extrae los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-259">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f7739-260">Por ejemplo, la ruta de acceso `/Products/Details/17` genera los valores de ruta siguientes: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-260">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f7739-261">Los valores de ruta se determinan al dividir la ruta de dirección URL en segmentos y hacer coincidir cada segmento con el nombre del *parámetro de ruta* en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-261">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f7739-262">Los parámetros de ruta tienen un nombre asignado.</span><span class="sxs-lookup"><span data-stu-id="f7739-262">Route parameters are named.</span></span> <span data-ttu-id="f7739-263">Para definir los parámetros, el nombre del parámetro se incluye entre llaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-263">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f7739-264">La plantilla anterior también podría coincidir con la ruta de dirección URL `/` y generar los valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-264">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f7739-265">Esto se debe a que los parámetros de ruta `{controller}` y `{action}` tienen valores predeterminados y el parámetro de ruta `id` es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-265">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f7739-266">Un signo igual (`=`) seguido de un valor después del nombre del parámetro de ruta define un valor predeterminado para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-266">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f7739-267">Un signo de interrogación (`?`) después del nombre del parámetro de ruta define un parámetro opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-267">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f7739-268">Los parámetros de ruta con un valor predeterminado *siempre* generan un valor de ruta cuando la ruta coincide.</span><span class="sxs-lookup"><span data-stu-id="f7739-268">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f7739-269">Los parámetros opcionales no generan un valor de ruta si no existió el segmento de ruta de dirección URL correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-269">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f7739-270">Vea la sección [Referencia de plantilla de ruta](#route-template-reference) para obtener una descripción detallada de los escenarios y la sintaxis de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-270">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f7739-271">En el ejemplo siguiente, la definición de parámetro de ruta `{id:int}` define una [restricción de ruta](#route-constraint-reference) para el parámetro de ruta `id`:</span><span class="sxs-lookup"><span data-stu-id="f7739-271">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f7739-272">Esta plantilla coincide con una ruta de dirección URL como `/Products/Details/17`, pero no con `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f7739-272">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f7739-273">Las restricciones de ruta implementan <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspeccionan los valores de ruta para comprobarlos.</span><span class="sxs-lookup"><span data-stu-id="f7739-273">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f7739-274">En este ejemplo, el valor de ruta `id` debe poder convertirse en un entero.</span><span class="sxs-lookup"><span data-stu-id="f7739-274">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f7739-275">Vea la [Referencia de restricción de ruta](#route-constraint-reference) para obtener una explicación de las restricciones de ruta proporcionadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f7739-275">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f7739-276">Las sobrecargas adicionales de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceptan valores para `constraints`, `dataTokens` y `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f7739-276">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f7739-277">Estos parámetros suelen usarse para pasar un objeto de tipo anónimo, donde los nombres de propiedad del tipo anónimo coinciden con los nombres de los parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-277">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f7739-278">En los ejemplos <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> siguientes se crean rutas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f7739-278">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f7739-279">La sintaxis insertada para definir las restricciones y los valores predeterminados puede ser conveniente para las rutas simples.</span><span class="sxs-lookup"><span data-stu-id="f7739-279">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f7739-280">Pero hay algunos escenarios, como los tokens de datos, que no son compatibles con la sintaxis insertada.</span><span class="sxs-lookup"><span data-stu-id="f7739-280">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f7739-281">En el ejemplo siguiente se muestran algunos escenarios más:</span><span class="sxs-lookup"><span data-stu-id="f7739-281">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f7739-282">La plantilla anterior coincide con una ruta de dirección URL como `/Blog/All-About-Routing/Introduction` y extrae los valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-282">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f7739-283">La ruta genera los valores de ruta predeterminados para `controller` y `action`, incluso si no hay parámetros de ruta correspondientes en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="f7739-283">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f7739-284">Los valores predeterminados pueden especificarse en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-284">Default values can be specified in the route template.</span></span> <span data-ttu-id="f7739-285">El parámetro de ruta `article` se define como un *comodín* por la aparición de un asterisco doble (`**`) antes del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-285">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="f7739-286">Los parámetros de ruta comodín capturan el resto de la ruta de dirección URL y también pueden coincidir con la cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-286">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f7739-287">En el ejemplo siguiente se agregan restricciones de ruta y tokens de datos:</span><span class="sxs-lookup"><span data-stu-id="f7739-287">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f7739-288">La plantilla anterior coincide con una ruta de dirección URL como `/en-US/Products/5` y extrae los valores `{ controller = Products, action = Details, id = 5 }` y los tokens de datos `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-288">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens de Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f7739-290">Generación de direcciones URL de clase de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-290">Route class URL generation</span></span>

<span data-ttu-id="f7739-291">La clase <xref:Microsoft.AspNetCore.Routing.Route> también puede llevar a cabo la generación de dirección URL mediante la combinación de un conjunto de valores de ruta con su plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-291">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f7739-292">Se trata lógicamente del proceso inverso de hacer coincidir la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-292">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-293">Para entender mejor la generación de direcciones URL, imagine qué dirección URL quiere generar y, después, piense cómo coincidiría una plantilla de ruta con esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-293">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f7739-294">¿Qué valores se generarían?</span><span class="sxs-lookup"><span data-stu-id="f7739-294">What values would be produced?</span></span> <span data-ttu-id="f7739-295">Este es un equivalente aproximado de cómo funciona la generación de dirección URL en la clase <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-295">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f7739-296">En el ejemplo siguiente se usa una ruta predeterminada de ASP.NET Core MVC general:</span><span class="sxs-lookup"><span data-stu-id="f7739-296">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-297">Con los valores de ruta `{ controller = Products, action = List }`, se genera la dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-297">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f7739-298">Los valores de ruta se sustituyen por los parámetros de ruta correspondientes para formar la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-298">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f7739-299">Como `id` es un parámetro de ruta opcional, la dirección URL se ha generado correctamente sin ningún valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f7739-299">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f7739-300">Con los valores de ruta `{ controller = Home, action = Index }`, se genera la dirección URL `/`.</span><span class="sxs-lookup"><span data-stu-id="f7739-300">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f7739-301">Los valores de ruta proporcionados coinciden con los valores predeterminados, y los segmentos correspondientes a los valores predeterminados se omiten sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="f7739-301">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f7739-302">Ambas direcciones URL generadas realizan un recorrido de ida y vuelta con la definición de ruta siguiente (`/Home/Index` y `/`) y generan los mismos valores de ruta que se usaron para generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-302">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f7739-303">Las aplicaciones con ASP.NET Core MVC deben usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para generar direcciones URL en lugar de llamar directamente al enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-303">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f7739-304">Para obtener más información sobre la generación de direcciones URL, vea la sección [Referencia de generación de direcciones URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-304">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f7739-305">Uso de software intermedio de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-305">Use Routing Middleware</span></span>

<span data-ttu-id="f7739-306">Haga referencia al [metapaquete Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) en el archivo de proyecto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-306">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f7739-307">Agregue enrutamiento al contenedor de servicios en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-307">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f7739-308">Las rutas se deben configurar en el método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f7739-308">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f7739-309">En la aplicación de ejemplo se usan las API siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-309">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f7739-310"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; solo coincide con solicitudes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-310"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f7739-311">En la tabla siguiente se muestran las respuestas con los URI especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-311">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f7739-312">Identificador URI</span><span class="sxs-lookup"><span data-stu-id="f7739-312">URI</span></span>                    | <span data-ttu-id="f7739-313">Respuesta</span><span class="sxs-lookup"><span data-stu-id="f7739-313">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f7739-314">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-314">Hello!</span></span> <span data-ttu-id="f7739-315">Valores de ruta: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f7739-315">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f7739-316">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-316">Hello!</span></span> <span data-ttu-id="f7739-317">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-317">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f7739-318">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-318">Hello!</span></span> <span data-ttu-id="f7739-319">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-319">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f7739-320">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-320">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f7739-321">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="f7739-321">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f7739-322">La solicitud pasa; solo coincide con HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-322">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f7739-323">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-323">The request falls through, no match.</span></span>              |

<span data-ttu-id="f7739-324">El marco de trabajo proporciona un conjunto de métodos de extensión para crear rutas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f7739-324">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f7739-325">Los métodos `Map[Verb]` usan restricciones para limitar la ruta al verbo HTTP en el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="f7739-325">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f7739-326">Por ejemplo, vea <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> y <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-326">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f7739-327">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-327">Route template reference</span></span>

<span data-ttu-id="f7739-328">Los tokens entre llaves (`{ ... }`) definen *parámetros de ruta* que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-328">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f7739-329">Puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="f7739-329">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f7739-330">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-330">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f7739-331">Estos parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-331">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f7739-332">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-332">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f7739-333">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-333">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f7739-334">Para que el delimitador de parámetro de ruta literal coincida (`{` o `}`), repita el carácter (`{{` o `}}`) para usarlo como secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-334">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f7739-335">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-335">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f7739-336">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-336">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f7739-337">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="f7739-337">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f7739-338">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el punto final (`.`) es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-338">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f7739-339">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="f7739-339">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f7739-340">Se puede usar un asterisco (`*`) o un asterisco doble (`**`) como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="f7739-340">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f7739-341">Se denominan parámetros *comodín*.</span><span class="sxs-lookup"><span data-stu-id="f7739-341">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="f7739-342">Por ejemplo, `blog/{**slug}` coincide con cualquier URI que empiece por `/blog` y que vaya seguido de cualquier valor, que se asigna al valor de ruta `slug`.</span><span class="sxs-lookup"><span data-stu-id="f7739-342">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f7739-343">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-343">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f7739-344">El parámetro catch-all inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos caracteres de separación de ruta de acceso (`/`).</span><span class="sxs-lookup"><span data-stu-id="f7739-344">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f7739-345">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f7739-345">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f7739-346">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-346">Note the escaped forward slash.</span></span> <span data-ttu-id="f7739-347">Para los caracteres separadores de ruta de acceso de ida y vuelta, use el prefijo de parámetro de ruta `**`.</span><span class="sxs-lookup"><span data-stu-id="f7739-347">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="f7739-348">La ruta `foo/{**path}` con `{ path = "my/path" }` genera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="f7739-348">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="f7739-349">Los parámetros de ruta pueden tener *valores predeterminados* designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f7739-349">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f7739-350">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f7739-350">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f7739-351">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-351">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f7739-352">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro, como en `id?`.</span><span class="sxs-lookup"><span data-stu-id="f7739-352">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f7739-353">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es que un parámetro de ruta con un valor predeterminado siempre genera un valor, mientras que un parámetro opcional tiene un valor solo cuando la dirección URL de solicitud lo proporciona.</span><span class="sxs-lookup"><span data-stu-id="f7739-353">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f7739-354">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-354">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f7739-355">Si se agrega un carácter de dos puntos (`:`) y un nombre de restricción después del nombre del parámetro de ruta, se especifica una *restricción insertada* en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-355">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f7739-356">Si la restricción requiere argumentos, se incluyen entre paréntesis (`(...)`) después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-356">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f7739-357">Se pueden especificar varias restricciones insertadas si se anexa otro carácter de dos puntos (`:`) y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-357">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f7739-358">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-358">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f7739-359">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f7739-359">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f7739-360">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-360">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f7739-361">Los parámetros de ruta también pueden tener transformadores de parámetros, que transforman el valor de un parámetro al generar vínculos y acciones y páginas coincidentes para las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-361">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="f7739-362">Al igual que las restricciones, los transformadores de parámetros se pueden agregar en línea a un parámetro de ruta al incorporar un carácter de dos puntos (`:`) y un nombre de transformador después del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-362">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="f7739-363">Por ejemplo, la plantilla de ruta `blog/{article:slugify}` especifica un transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="f7739-363">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="f7739-364">Para obtener más información sobre los transformadores de parámetros, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-364">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="f7739-365">En la tabla siguiente se muestran algunas plantillas de ruta de ejemplo y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-365">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f7739-366">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-366">Route Template</span></span>                           | <span data-ttu-id="f7739-367">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-367">Example Matching URI</span></span>    | <span data-ttu-id="f7739-368">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="f7739-368">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f7739-369">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f7739-369">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f7739-370">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="f7739-370">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f7739-371">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f7739-371">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f7739-372">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-372">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f7739-373">Se asigna al controlador `Products` y la acción `Details` (`id` se establece en 123).</span><span class="sxs-lookup"><span data-stu-id="f7739-373">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f7739-374">Se asigna al controlador `Home` y al método `Index` (`id` se omite).</span><span class="sxs-lookup"><span data-stu-id="f7739-374">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f7739-375">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="f7739-375">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f7739-376">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-376">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-377">Habilite el [registro](xref:fundamentals/logging/index) para ver de qué forma las implementaciones de enrutamiento integradas, como <xref:Microsoft.AspNetCore.Routing.Route>, coinciden con las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-377">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f7739-378">Nombres de enrutamientos reservados</span><span class="sxs-lookup"><span data-stu-id="f7739-378">Reserved routing names</span></span>

<span data-ttu-id="f7739-379">Las siguientes palabras clave son nombres reservados y no se pueden usar como nombres de ruta o parámetros:</span><span class="sxs-lookup"><span data-stu-id="f7739-379">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f7739-380">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-380">Route constraint reference</span></span>

<span data-ttu-id="f7739-381">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-381">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f7739-382">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-382">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f7739-383">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="f7739-383">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f7739-384">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-384">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f7739-385">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-385">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f7739-386">No use las restricciones para las **validación de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f7739-386">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f7739-387">Si las restricciones se usan para la **validación de entrada**, los resultados de entrada no válidos producirán un error *404 - No encontrado* en lugar de un error *400 - Solicitud incorrecta* con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="f7739-387">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f7739-388">Las restricciones de ruta se usan para **eliminar la ambigüedad** entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-388">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f7739-389">En la tabla siguiente se muestran algunas restricciones de ruta de ejemplo y su comportamiento esperado.</span><span class="sxs-lookup"><span data-stu-id="f7739-389">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f7739-390">restricción</span><span class="sxs-lookup"><span data-stu-id="f7739-390">constraint</span></span> | <span data-ttu-id="f7739-391">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-391">Example</span></span> | <span data-ttu-id="f7739-392">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-392">Example Matches</span></span> | <span data-ttu-id="f7739-393">Notas</span><span class="sxs-lookup"><span data-stu-id="f7739-393">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f7739-394">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-394">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-395">Coincide con cualquier entero</span><span class="sxs-lookup"><span data-stu-id="f7739-395">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f7739-396">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f7739-396">`true`, `FALSE`</span></span> | <span data-ttu-id="f7739-397">Coincide con `true` o `false` (no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-397">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f7739-398">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f7739-398">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f7739-399">Coincide con un valor `DateTime` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-399">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f7739-400">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f7739-400">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f7739-401">Coincide con un valor `decimal` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-401">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f7739-402">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-402">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-403">Coincide con un valor `double` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-403">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f7739-404">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-404">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-405">Coincide con un valor `float` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-405">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f7739-406">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f7739-406">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f7739-407">Coincide con un valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-407">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f7739-408">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-408">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-409">Coincide con un valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-409">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f7739-410">La cadena debe tener al menos cuatro caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-410">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f7739-411">La cadena no debe tener más de ocho caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-411">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f7739-412">La cadena debe tener una longitud de exactamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-412">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f7739-413">La cadena debe tener una longitud como mínimo de ocho caracteres y como máximo de 16</span><span class="sxs-lookup"><span data-stu-id="f7739-413">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f7739-414">El valor entero debe ser como mínimo 18</span><span class="sxs-lookup"><span data-stu-id="f7739-414">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f7739-415">El valor entero debe ser como máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-415">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f7739-416">El valor entero debe ser como mínimo 18 y máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-416">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f7739-417">La cadena debe constar de uno o más caracteres alfabéticos (`a`-`z`, no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-417">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f7739-418">La cadena debe coincidir con la expresión regular (vea las sugerencias sobre cómo definir una expresión regular)</span><span class="sxs-lookup"><span data-stu-id="f7739-418">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f7739-419">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-419">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f7739-420">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-420">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f7739-421">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="f7739-421">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f7739-422">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR (como `int` o `DateTime`) usan siempre la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="f7739-422">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f7739-423">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="f7739-423">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f7739-424">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-424">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f7739-425">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="f7739-425">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f7739-426">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="f7739-426">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f7739-427">Expresiones regulares</span><span class="sxs-lookup"><span data-stu-id="f7739-427">Regular expressions</span></span>

<span data-ttu-id="f7739-428">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-428">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f7739-429">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="f7739-429">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f7739-430">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="f7739-430">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f7739-431">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-431">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f7739-432">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en el enrutamiento, los caracteres `\` (una barra diagonal inversa) de la cadena se deben proporcionar como caracteres `\\` (barra diagonal inversa doble) en el archivo de código fuente de C# para que el carácter de escape de cadena `\` tenga una secuencia de escape (a menos que se usen [literales de cadena textuales](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f7739-432">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f7739-433">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento (`{`, `}`, `[` y `]`), duplique los caracteres en la expresión (`{{`, `}`, `[[` y `]]`).</span><span class="sxs-lookup"><span data-stu-id="f7739-433">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f7739-434">En la tabla siguiente se muestra una expresión regular y la versión con la secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-434">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f7739-435">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="f7739-435">Regular Expression</span></span>    | <span data-ttu-id="f7739-436">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="f7739-436">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f7739-437">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter de acento circunflejo (`^`) y coinciden con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-437">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f7739-438">Las expresiones suelen terminar con el carácter del signo de dólar (`$`) y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-438">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f7739-439">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-439">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f7739-440">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, algo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="f7739-440">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f7739-441">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-441">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f7739-442">Expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-442">Expression</span></span>   | <span data-ttu-id="f7739-443">String</span><span class="sxs-lookup"><span data-stu-id="f7739-443">String</span></span>    | <span data-ttu-id="f7739-444">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="f7739-444">Match</span></span> | <span data-ttu-id="f7739-445">Comentario</span><span class="sxs-lookup"><span data-stu-id="f7739-445">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f7739-446">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-446">hello</span></span>     | <span data-ttu-id="f7739-447">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-447">Yes</span></span>   | <span data-ttu-id="f7739-448">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-448">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-449">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-449">123abc456</span></span> | <span data-ttu-id="f7739-450">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-450">Yes</span></span>   | <span data-ttu-id="f7739-451">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-451">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-452">mz</span><span class="sxs-lookup"><span data-stu-id="f7739-452">mz</span></span>        | <span data-ttu-id="f7739-453">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-453">Yes</span></span>   | <span data-ttu-id="f7739-454">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-454">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f7739-455">MZ</span><span class="sxs-lookup"><span data-stu-id="f7739-455">MZ</span></span>        | <span data-ttu-id="f7739-456">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-456">Yes</span></span>   | <span data-ttu-id="f7739-457">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f7739-457">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-458">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-458">hello</span></span>     | <span data-ttu-id="f7739-459">No</span><span class="sxs-lookup"><span data-stu-id="f7739-459">No</span></span>    | <span data-ttu-id="f7739-460">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-460">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-461">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-461">123abc456</span></span> | <span data-ttu-id="f7739-462">No</span><span class="sxs-lookup"><span data-stu-id="f7739-462">No</span></span>    | <span data-ttu-id="f7739-463">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-463">See `^` and `$` above</span></span> |

<span data-ttu-id="f7739-464">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-464">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f7739-465">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="f7739-465">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f7739-466">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="f7739-466">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f7739-467">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="f7739-467">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f7739-468">Las restricciones que se pasan al diccionario de restricciones (no insertado en una plantilla) que no coinciden con una de las restricciones conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-468">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f7739-469">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="f7739-469">Custom Route Constraints</span></span>

<span data-ttu-id="f7739-470">Además de las restricciones de ruta integradas, se pueden crear restricciones de ruta personalizadas implementando la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f7739-470">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f7739-471">La interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contiene un único método, `Match`, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="f7739-471">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f7739-472">Para utilizar una restricción <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, el tipo de restricción de ruta debe registrarse con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-472">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f7739-473"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> es un diccionario que asigna claves de restricciones de ruta a implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="f7739-473">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f7739-474">El parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f7739-474">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f7739-475">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-475">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f7739-476">La restricción puede aplicarse a las rutas de la manera habitual, usando el nombre especificado al registrar el tipo de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-476">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f7739-477">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-477">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="f7739-478">Referencia de transformadores de parámetros</span><span class="sxs-lookup"><span data-stu-id="f7739-478">Parameter transformer reference</span></span>

<span data-ttu-id="f7739-479">Transformadores de parámetros:</span><span class="sxs-lookup"><span data-stu-id="f7739-479">Parameter transformers:</span></span>

* <span data-ttu-id="f7739-480">Se ejecutan al generar un vínculo para <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-480">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="f7739-481">Implemente `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="f7739-481">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="f7739-482">Se configuran con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="f7739-482">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="f7739-483">Toman el valor de ruta del parámetro y lo transforman en un nuevo valor de cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-483">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="f7739-484">Como resultado, el valor transformado se usa en el vínculo generado.</span><span class="sxs-lookup"><span data-stu-id="f7739-484">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="f7739-485">Por ejemplo, un transformador de parámetros personalizado `slugify` en el patrón de ruta `blog\{article:slugify}` con `Url.Action(new { article = "MyTestArticle" })` genera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="f7739-485">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="f7739-486">Para usar un transformador de parámetros en un patrón de ruta, configúrelo primero con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-486">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="f7739-487">El marco usa los transformadores de parámetros para transformar el URI en el que se resuelve un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-487">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="f7739-488">Por ejemplo, ASP.NET Core MVC usa transformadores de parámetros para transformar el valor de ruta usado para hacer coincidir elementos `area`, `controller`, `action` y `page`.</span><span class="sxs-lookup"><span data-stu-id="f7739-488">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="f7739-489">Con la ruta anterior, la acción `SubscriptionManagementController.GetAll()` coincide con el URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f7739-489">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="f7739-490">Un transformador de parámetros no cambia los valores de ruta usados para generar un vínculo.</span><span class="sxs-lookup"><span data-stu-id="f7739-490">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="f7739-491">Por ejemplo, `Url.Action("GetAll", "SubscriptionManagement")` genera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f7739-491">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="f7739-492">ASP.NET Core proporciona las convenciones de API para usar transformadores de parámetros con rutas generadas:</span><span class="sxs-lookup"><span data-stu-id="f7739-492">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="f7739-493">ASP.NET Core MVC tiene la convención de API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f7739-493">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="f7739-494">Esta convención aplica un transformador de parámetro especificado a todas las rutas de atributo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-494">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="f7739-495">El transformador de parámetro transforma los tokens de rutas de atributo a medida que se reemplazan.</span><span class="sxs-lookup"><span data-stu-id="f7739-495">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="f7739-496">Para más información, consulte [Usar un transformador de parámetro para personalizar el reemplazo de tokens](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="f7739-496">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="f7739-497">Razor Pages tiene la convención de API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f7739-497">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="f7739-498">Esta convención aplica un transformador de parámetros especificado a todas las instancias de Razor Pages detectadas de forma automática.</span><span class="sxs-lookup"><span data-stu-id="f7739-498">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="f7739-499">El transformador de parámetros transforma los segmentos de nombre de archivo y carpeta de las rutas de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-499">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="f7739-500">Para más información, consulte el artículo sobre cómo [usar un transformador de parámetro para personalizar rutas de Razor Pages](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="f7739-500">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="f7739-501">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="f7739-501">URL generation reference</span></span>

<span data-ttu-id="f7739-502">En el ejemplo siguiente se muestra cómo se genera un vínculo a una ruta, dado un diccionario de valores de ruta y un valor <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f7739-502">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f7739-503">El valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generado al final del ejemplo anterior es `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f7739-503">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f7739-504">El diccionario proporciona los valores de ruta `operation` e `id` de la plantilla "Ruta de paquete de seguimiento", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-504">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f7739-505">Para obtener más información, vea el código de ejemplo de la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware) o la [aplicación de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f7739-505">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f7739-506">El segundo parámetro del constructor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> es una colección de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f7739-506">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f7739-507">Los valores de ambiente son adecuados porque limitan el número de valores que el desarrollador debe especificar dentro de un contexto de solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-507">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f7739-508">Los valores de ruta actuales de la solicitud actual se consideran valores de ambiente para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-508">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f7739-509">En la acción `About` de `HomeController` de una aplicación ASP.NET Core MVC, no es necesario especificar el valor de ruta de controlador para vincular a la acción `Index` (se usará el valor de ambiente `Home`).</span><span class="sxs-lookup"><span data-stu-id="f7739-509">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f7739-510">Los valores de ambiente que no coincidan con un parámetro se omiten.</span><span class="sxs-lookup"><span data-stu-id="f7739-510">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f7739-511">También se omiten los valores de ambiente cuando un valor proporcionado de forma explícita invalida el valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-511">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f7739-512">La coincidencia se produce de izquierda a derecha en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-512">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f7739-513">Los valores que se proporcionan de forma explícita pero que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="f7739-513">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f7739-514">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-514">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f7739-515">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f7739-515">Ambient Values</span></span>                     | <span data-ttu-id="f7739-516">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f7739-516">Explicit Values</span></span>                        | <span data-ttu-id="f7739-517">Resultado</span><span class="sxs-lookup"><span data-stu-id="f7739-517">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f7739-518">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-518">controller = "Home"</span></span>                | <span data-ttu-id="f7739-519">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-519">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-520">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-520">controller = "Home"</span></span>                | <span data-ttu-id="f7739-521">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-521">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f7739-522">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-522">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f7739-523">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-523">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-524">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-524">controller = "Home"</span></span>                | <span data-ttu-id="f7739-525">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-525">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f7739-526">Si una ruta tiene un valor predeterminado que no se corresponde con un parámetro y ese valor se proporciona de forma explícita, debe coincidir con el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="f7739-526">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f7739-527">La generación de vínculos solo genera un vínculo para esta ruta si se proporcionan los valores coincidentes para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="f7739-527">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f7739-528">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="f7739-528">Complex segments</span></span>

<span data-ttu-id="f7739-529">Los segmentos complejos (por ejemplo, `[Route("/x{token}y")]`), se procesan buscando coincidencias de literales de derecha a izquierda de un modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-529">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f7739-530">Consulte [este código](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para obtener una explicación detallada de cómo se comparan los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-530">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f7739-531">El [código de ejemplo](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) no se usa en ASP.NET Core, pero proporciona una buena explicación de los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-531">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="f7739-532">Configuración de metadatos de punto de conexión</span><span class="sxs-lookup"><span data-stu-id="f7739-532">Configuring endpoint metadata</span></span>

<span data-ttu-id="f7739-533">Los vínculos siguientes proporcionan información sobre la configuración de metadatos de punto de conexión:</span><span class="sxs-lookup"><span data-stu-id="f7739-533">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="f7739-534">Habilitación de CORS con enrutamiento de punto de conexión</span><span class="sxs-lookup"><span data-stu-id="f7739-534">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="f7739-535">[Ejemplo de IAuthorizationPolicyProvider](https://github.com/aspnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) con un atributo `[MinimumAgeAuthorize]` personalizado</span><span class="sxs-lookup"><span data-stu-id="f7739-535">[IAuthorizationPolicyProvider sample](https://github.com/aspnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="f7739-536">[Autenticación de pruebas con el atributo [Authorize]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="f7739-536">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="f7739-537">[Selección del esquema con el atributo [Authorize]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="f7739-537">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="f7739-538">[Aplicación de directivas con el atributo [Authorize]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="f7739-538">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="f7739-539">Comparación de host en rutas con RequireHost</span><span class="sxs-lookup"><span data-stu-id="f7739-539">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="f7739-540">`RequireHost` aplica una restricción a la ruta que requiere el host especificado.</span><span class="sxs-lookup"><span data-stu-id="f7739-540">`RequireHost` applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="f7739-541">Los parámetros `RequireHost` o `[Host]` pueden ser:</span><span class="sxs-lookup"><span data-stu-id="f7739-541">The `RequireHost` or `[Host]` parameter can be:</span></span>

* <span data-ttu-id="f7739-542">Host: `www.domain.com` (compara `www.domain.com` con cualquier puerto)</span><span class="sxs-lookup"><span data-stu-id="f7739-542">Host: `www.domain.com` (matches `www.domain.com` with any port)</span></span>
* <span data-ttu-id="f7739-543">Host con carácter comodín: `*.domain.com` (coincide con `www.domain.com`, `subdomain.domain.com` o `www.subdomain.domain.com` en cualquier puerto)</span><span class="sxs-lookup"><span data-stu-id="f7739-543">Host with wildcard: `*.domain.com` (matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port)</span></span>
* <span data-ttu-id="f7739-544">Puerto: `*:5000` (coincide con el puerto 5000 con cualquier host)</span><span class="sxs-lookup"><span data-stu-id="f7739-544">Port: `*:5000` (matches port 5000 with any host)</span></span>
* <span data-ttu-id="f7739-545">Host y puerto: `www.domain.com:5000`, `*.domain.com:5000` (coincide con el host y el puerto)</span><span class="sxs-lookup"><span data-stu-id="f7739-545">Host and port: `www.domain.com:5000`, `*.domain.com:5000` (matches host and port)</span></span>

<span data-ttu-id="f7739-546">Se pueden especificar varios parámetros mediante `RequireHost` o `[Host]`.</span><span class="sxs-lookup"><span data-stu-id="f7739-546">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="f7739-547">La restricción coincidirá con los hosts válidos para cualquiera de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="f7739-547">The constraint will match hosts valid for any of the parameters.</span></span> <span data-ttu-id="f7739-548">Por ejemplo, `[Host("domain.com", "*.domain.com")]` coincidirá con `domain.com`, `www.domain.com` o `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="f7739-548">For example, `[Host("domain.com", "*.domain.com")]` will match `domain.com`, `www.domain.com`, or `subdomain.domain.com`.</span></span>

<span data-ttu-id="f7739-549">En el código siguiente se usa `RequireHost` para requerir el host especificado en la ruta:</span><span class="sxs-lookup"><span data-stu-id="f7739-549">The following code uses `RequireHost` to require the specified host on the route:</span></span>

```csharp
public void Configure(IApplicationBuilder app)
{
    app.UseRouting();

    app.UseEndpoints(endpoints =>
    {
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi Contoso!"))
            .RequireHost("contoso.com");
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi AdventureWorks!"))
            .RequireHost("adventure-works.com");
        endpoints.MapHealthChecks("/healthz").RequireHost("*:8080");
    });
}
```

<span data-ttu-id="f7739-550">En el código siguiente se usa el atributo `[Host]` para requerir el host especificado en el controlador:</span><span class="sxs-lookup"><span data-stu-id="f7739-550">The following code uses the `[Host]` attribute to require the specified host on the controller:</span></span>

```csharp
[Host("contoso.com", "adventure-works.com")]
public class HomeController : Controller
{
    private readonly ILogger<HomeController> _logger;

    public HomeController(ILogger<HomeController> logger)
    {
        _logger = logger;
    }

    public IActionResult Index()
    {
        return View();
    }

    [Host("example.com:8080")]
    public IActionResult Privacy()
    {
        return View();
    }

}
```

<span data-ttu-id="f7739-551">Cuando el atributo `[Host]` se aplica al método de acción y al controlador:</span><span class="sxs-lookup"><span data-stu-id="f7739-551">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="f7739-552">Se usa el atributo en la acción.</span><span class="sxs-lookup"><span data-stu-id="f7739-552">The attribute on the action is used.</span></span>
* <span data-ttu-id="f7739-553">Se omite el atributo del controlador.</span><span class="sxs-lookup"><span data-stu-id="f7739-553">The controller attribute is ignored.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="f7739-554">El enrutamiento es responsable de asignar URI de solicitud a los puntos de conexión y de distribuir las solicitudes entrantes a esos puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-554">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="f7739-555">Las rutas se definen en la aplicación y se configuran cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-555">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f7739-556">Una ruta puede extraer opcionalmente valores de la dirección URL contenida en la solicitud, que se pueden usar para procesar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-556">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f7739-557">Con la información de ruta de la aplicación, el enrutamiento también puede generar direcciones URL que se asignan a puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-557">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="f7739-558">Para usar los escenarios de enrutamiento más recientes de ASP.NET Core 2.2, especifique la [versión de compatibilidad](xref:mvc/compatibility-version) en el registro de servicios de MVC en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-558">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="f7739-559">La opción <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> determina si el enrutamiento debe usar de forma interna la lógica basada en el punto de conexión o la lógica basada en <xref:Microsoft.AspNetCore.Routing.IRouter> de ASP.NET Core 2.1 o una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="f7739-559">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f7739-560">Cuando la versión de compatibilidad se establece en 2.2 o una versión posterior, el valor predeterminado es `true`.</span><span class="sxs-lookup"><span data-stu-id="f7739-560">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="f7739-561">Establezca el valor en `false` para usar la lógica de enrutamiento anterior:</span><span class="sxs-lookup"><span data-stu-id="f7739-561">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="f7739-562">Para obtener más información sobre el enrutamiento basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, vea la [versión para ASP.NET Core 2.1 de este tema](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="f7739-562">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f7739-563">En este documento se describe el enrutamiento de ASP.NET Core de bajo nivel.</span><span class="sxs-lookup"><span data-stu-id="f7739-563">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f7739-564">Para obtener información sobre el enrutamiento de ASP.NET Core MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-564">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f7739-565">Para obtener más información sobre las convenciones de enrutamiento en Razor Pages, consulte <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-565">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-566">[Vea o descargue el código de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f7739-566">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f7739-567">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-567">Routing basics</span></span>

<span data-ttu-id="f7739-568">La mayoría de las aplicaciones deben elegir un esquema de enrutamiento básico y descriptivo para que las direcciones URL sean legibles y significativas.</span><span class="sxs-lookup"><span data-stu-id="f7739-568">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f7739-569">La ruta convencional predeterminada `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f7739-569">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f7739-570">Admite un esquema de enrutamiento básico y descriptivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-570">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f7739-571">Se trata de un punto de partida útil para las aplicaciones basadas en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="f7739-571">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f7739-572">Los desarrolladores suelen agregar rutas breves adicionales a áreas de mucho tráfico de una aplicación en situaciones especializadas (por ejemplo, puntos de conexión de blog y comercio electrónico) con el [enrutamiento mediante atributos](xref:mvc/controllers/routing#attribute-routing) o rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f7739-572">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f7739-573">Las API web deben usar el enrutamiento mediante atributos para modelar la funcionalidad de la aplicación como un conjunto de recursos donde las operaciones se representan mediante verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-573">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f7739-574">Esto significa que muchas operaciones (por ejemplo, GET y POST) del mismo recurso lógico usarán la misma dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-574">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f7739-575">El enrutamiento mediante atributos proporciona un nivel de control que es necesario para diseñar cuidadosamente un diseño de puntos de conexión públicos de la API.</span><span class="sxs-lookup"><span data-stu-id="f7739-575">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f7739-576">En las aplicaciones de Razor Pages se usa el enrutamiento convencional predeterminado para proporcionar recursos con nombre en la carpeta *Páginas* de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-576">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f7739-577">Existen convenciones adicionales que permiten personalizar el comportamiento de enrutamiento de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-577">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f7739-578">Para obtener más información, vea <xref:razor-pages/index> y <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-578">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-579">La compatibilidad de la generación de direcciones URL permite desarrollar la aplicación sin codificar de forma rígida las direcciones URL para vincular la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-579">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f7739-580">Esta compatibilidad permite empezar con una configuración de enrutamiento básica y modificar las rutas una vez determinado el diseño de los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-580">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f7739-581">El enrutamiento usa *puntos de conexión* (`Endpoint`) para representar los puntos de conexión lógicos en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-581">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="f7739-582">Un punto de conexión define un delegado para procesar las solicitudes y una colección de metadatos arbitrarios.</span><span class="sxs-lookup"><span data-stu-id="f7739-582">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="f7739-583">Los metadatos se usan para implementar cuestiones transversales según las directivas y la configuración asociada a cada punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-583">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="f7739-584">El sistema de enrutamiento tiene las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-584">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f7739-585">La sintaxis de plantilla de ruta se usa para definir las rutas con parámetros de ruta con tokens.</span><span class="sxs-lookup"><span data-stu-id="f7739-585">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f7739-586">Se permite la configuración de puntos de conexión de estilo convencional y de estilo de atributo.</span><span class="sxs-lookup"><span data-stu-id="f7739-586">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f7739-587">Se usa <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para determinar si un parámetro de dirección URL contiene un valor válido para una restricción de punto de conexión determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-587"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f7739-588">Los modelos de aplicación, como MVC y Razor Pages, registran todos sus puntos de conexión, que presentan una implementación predecible de los escenarios de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-588">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f7739-589">La implementación de enrutamiento toma decisiones relativas al enrutamiento siempre que sea lo deseado en la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="f7739-589">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="f7739-590">El middleware que aparece después de un middleware de enrutamiento puede inspeccionar el resultado de la decisión del punto de conexión del middleware de enrutamiento para un URI de solicitud determinado.</span><span class="sxs-lookup"><span data-stu-id="f7739-590">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="f7739-591">Se pueden enumerar todos los puntos de conexión de la aplicación en cualquier parte de la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="f7739-591">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="f7739-592">Una aplicación puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información del punto de conexión. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-592">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f7739-593">La generación de direcciones URL se basa en direcciones, que admiten la extensibilidad arbitraria:</span><span class="sxs-lookup"><span data-stu-id="f7739-593">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="f7739-594">La API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) se puede resolver en cualquier lugar mediante la [inserción de dependencias (DI)](xref:fundamentals/dependency-injection) para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-594">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="f7739-595">Cuando la API del generador de vínculos no está disponible a través de DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> ofrece métodos para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-595">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="f7739-596">Con el lanzamiento del enrutamiento de punto de conexión en ASP.NET Core 2.2, la vinculación de punto de conexión se limita a acciones y páginas de Razor Pages y MVC.</span><span class="sxs-lookup"><span data-stu-id="f7739-596">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="f7739-597">Las expansiones de las funciones de vinculación de punto de conexión están previstas para próximas versiones.</span><span class="sxs-lookup"><span data-stu-id="f7739-597">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="f7739-598">La clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> conecta el enrutamiento a la canalización de [software intermedio](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="f7739-598">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f7739-599">[ASP.NET Core MVC](xref:mvc/overview) agrega enrutamiento a la canalización de middleware como parte de su configuración y controla el enrutamiento en las aplicaciones de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-599">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f7739-600">Para obtener información sobre cómo usar el enrutamiento como componente independiente, vea la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f7739-600">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f7739-601">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-601">URL matching</span></span>

<span data-ttu-id="f7739-602">La coincidencia de dirección URL es el proceso por el cual el enrutamiento envía una solicitud entrante a un *punto de conexión*.</span><span class="sxs-lookup"><span data-stu-id="f7739-602">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="f7739-603">Este proceso se basa en datos de la ruta de dirección URL, pero se puede ampliar para tener en cuenta cualquier dato de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-603">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f7739-604">La capacidad de enviar solicitudes a controladores independientes es clave para escalar el tamaño y la complejidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-604">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f7739-605">El sistema de enrutamiento en el enrutamiento de punto de conexión es responsable de todas las decisiones relativas al envío.</span><span class="sxs-lookup"><span data-stu-id="f7739-605">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="f7739-606">Como el middleware aplica las directivas en función del punto de conexión seleccionado, es importante que cualquier decisión que pueda afectar a la distribución o la aplicación de directivas de seguridad se realice dentro del sistema de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-606">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="f7739-607">Cuando se ejecuta el delegado del punto de conexión, las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) se establecen en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="f7739-607">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f7739-608">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) es un diccionario de los *valores de ruta* generados desde la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-608">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f7739-609">Estos valores se suelen determinar mediante la conversión en tokens de la dirección URL, y se pueden usar para aceptar la entrada del usuario o para tomar otras decisiones sobre el envío dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-609">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f7739-610">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) es un contenedor de propiedades de datos adicionales relacionados con la ruta coincidente.</span><span class="sxs-lookup"><span data-stu-id="f7739-610">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f7739-611">Se proporcionan <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> para permitir la asociación de datos de estado con cada ruta, de modo que la aplicación pueda tomar decisiones en función de las rutas que han coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-611"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f7739-612">Estos valores los define el desarrollador y **no** afectan de ninguna manera al comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-612">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f7739-613">Además, los valores que se guardan provisionalmente en [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) pueden ser de cualquier tipo, a diferencia de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que deben poder convertirse fácilmente en cadenas y a partir de estas.</span><span class="sxs-lookup"><span data-stu-id="f7739-613">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f7739-614">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) es una lista de las rutas que han participado en encontrar una coincidencia correcta con la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-614">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f7739-615">Las rutas se pueden anidar unas dentro de otras.</span><span class="sxs-lookup"><span data-stu-id="f7739-615">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f7739-616">La propiedad <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> refleja la ruta de acceso del árbol lógico de rutas que han tenido como resultado una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-616">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f7739-617">Por lo general, el primer elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es la colección de rutas y se debe usar para la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-617">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f7739-618">El último elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es el controlador de ruta que ha coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-618">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="f7739-619">Generación de direcciones URL con LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="f7739-619">URL generation with LinkGenerator</span></span>

<span data-ttu-id="f7739-620">La generación de dirección URL es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL basada en un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-620">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f7739-621">Esto permite una separación lógica entre los puntos de conexión y las direcciones URL que tienen acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="f7739-621">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="f7739-622">El enrutamiento de punto de conexión incluye la API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="f7739-622">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="f7739-623"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> es un servicio singleton que se puede recuperar a partir de la DI.</span><span class="sxs-lookup"><span data-stu-id="f7739-623"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="f7739-624">La API se puede usar fuera del contexto de una solicitud en ejecución.</span><span class="sxs-lookup"><span data-stu-id="f7739-624">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="f7739-625"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC y los escenarios que dependen de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como los [asistentes de etiquetas](xref:mvc/views/tag-helpers/intro), los de HTML y [los resultados de acción](xref:mvc/controllers/actions), usan el generador de vínculos para proporcionar funciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-625">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="f7739-626">El generador de vínculos está respaldado por el concepto de una *dirección* y *esquemas de direcciones*.</span><span class="sxs-lookup"><span data-stu-id="f7739-626">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="f7739-627">Un esquema de direcciones es una manera de determinar los puntos de conexión que se deben tener en cuenta para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-627">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="f7739-628">Por ejemplo, los escenarios de nombre y valores de ruta de Razor Pages y MVC con los que muchos usuarios están familiarizados se implementan como un esquema de direcciones.</span><span class="sxs-lookup"><span data-stu-id="f7739-628">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="f7739-629">El generador de vínculos puede vincular a acciones y páginas de Razor Pages y MVC a través de los métodos de extensión siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-629">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="f7739-630">Una sobrecarga de estos métodos acepta argumentos que incluyan `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="f7739-630">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="f7739-631">Estos métodos son equivalentes funcionalmente a `Url.Action` y `Url.Page`, pero ofrecen flexibilidad y opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-631">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="f7739-632">Los métodos `GetPath*` son más similares a `Url.Action` y `Url.Page`, dado que generan un URI que contiene una ruta de acceso absoluta.</span><span class="sxs-lookup"><span data-stu-id="f7739-632">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="f7739-633">Los métodos `GetUri*` siempre generan un URI absoluto que contiene un esquema y un host.</span><span class="sxs-lookup"><span data-stu-id="f7739-633">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="f7739-634">Los métodos que aceptan `HttpContext` generan un URI en el contexto de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="f7739-634">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="f7739-635">A menos que se reemplacen, se usan los valores de ruta de ambiente, la ruta de acceso base de la dirección URL, el esquema y el host de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="f7739-635">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="f7739-636">Se llama a <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con una dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-636"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="f7739-637">La generación de un URI se produce en dos pasos:</span><span class="sxs-lookup"><span data-stu-id="f7739-637">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="f7739-638">Se enlaza una dirección a una lista de puntos de conexión que coincidan con la dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-638">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="f7739-639">Se evalúa el elemento `RoutePattern` de cada punto de conexión hasta que se encuentra un patrón de ruta que coincida con los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-639">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="f7739-640">La salida resultante se combina con otras partes del URI proporcionadas al generador de vínculos y devueltas.</span><span class="sxs-lookup"><span data-stu-id="f7739-640">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="f7739-641">Los métodos proporcionados por <xref:Microsoft.AspNetCore.Routing.LinkGenerator> admiten funciones estándar de generación de vínculos para cualquier tipo de dirección.</span><span class="sxs-lookup"><span data-stu-id="f7739-641">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="f7739-642">La forma más útil de usar el generador de vínculos es a través de métodos de extensión que realicen operaciones para un tipo de dirección específica.</span><span class="sxs-lookup"><span data-stu-id="f7739-642">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="f7739-643">Método de extensión</span><span class="sxs-lookup"><span data-stu-id="f7739-643">Extension Method</span></span>   | <span data-ttu-id="f7739-644">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="f7739-644">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="f7739-645">Genera un URI con una ruta de acceso absoluta en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-645">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="f7739-646">Genera un URI absoluto en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="f7739-646">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="f7739-647">Preste atención a las consecuencias siguientes de llamar a los métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="f7739-647">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="f7739-648">Use los métodos de extensión `GetUri*` con precaución en una configuración de aplicación en la que no se valide el encabezado `Host` de las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="f7739-648">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="f7739-649">Si no se valida el encabezado `Host` de las solicitudes entrantes, la entrada de la solicitud que no sea de confianza se puede devolver al cliente en los URI de una página o vista.</span><span class="sxs-lookup"><span data-stu-id="f7739-649">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="f7739-650">Se recomienda que todas las aplicaciones de producción configuren su servidor para validar el encabezado `Host` en función de valores válidos conocidos.</span><span class="sxs-lookup"><span data-stu-id="f7739-650">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="f7739-651">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con precaución en el middleware junto con `Map` o `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="f7739-651">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="f7739-652">`Map*` cambia la ruta de acceso base de la solicitud que se ejecuta, lo que afecta a la salida de la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-652">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="f7739-653">Todas las API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permiten especificar una ruta de acceso base.</span><span class="sxs-lookup"><span data-stu-id="f7739-653">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="f7739-654">Especifique siempre una ruta de acceso base vacía para deshacer el efecto de `Map*` en la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-654">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="f7739-655">Diferencias con respecto a versiones anteriores del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-655">Differences from earlier versions of routing</span></span>

<span data-ttu-id="f7739-656">Existen algunas diferencias entre el enrutamiento de punto de conexión de ASP.NET Core 2.2 o posterior, y las versiones anteriores del enrutamiento en ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="f7739-656">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="f7739-657">El sistema de enrutamiento de punto de conexión no es compatible con la extensibilidad basada en <xref:Microsoft.AspNetCore.Routing.IRouter>, incluida la herencia de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-657">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="f7739-658">El enrutamiento de punto de conexión no es compatible con [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="f7739-658">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="f7739-659">Utilice la [versión compatibilidad](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) para seguir usando la corrección de compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="f7739-659">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="f7739-660">El enrutamiento de punto de conexión tiene un comportamiento diferente para el uso de mayúsculas y minúsculas en los URI generados al usar rutas convencionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-660">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="f7739-661">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-661">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f7739-662">Supongamos que genera un vínculo a una acción mediante la ruta siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-662">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="f7739-663">Con el enrutamiento basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, este código genera un URI de `/blog/ReadPost/17`, que respeta las mayúsculas y minúsculas del valor de ruta proporcionado.</span><span class="sxs-lookup"><span data-stu-id="f7739-663">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="f7739-664">El enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17` ("Blog" se pone mayúscula).</span><span class="sxs-lookup"><span data-stu-id="f7739-664">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="f7739-665">El enrutamiento de punto de conexión proporciona la interfaz `IOutboundParameterTransformer`, que se puede usar para personalizar este comportamiento de forma global, o bien para aplicar otras convenciones para la asignación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-665">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="f7739-666">Para obtener más información, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-666">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="f7739-667">La generación de vínculos que se usa en Razor Pages y MVC con las rutas convencionales tiene un comportamiento diferente al intentar vincularlo a un controlador o una acción, o a una página que no existe.</span><span class="sxs-lookup"><span data-stu-id="f7739-667">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="f7739-668">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-668">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="f7739-669">Supongamos que genera un vínculo a una acción mediante la plantilla predeterminada con lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7739-669">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="f7739-670">Con el enrutamiento basado en `IRouter`, el resultado siempre es `/Blog/ReadPost/17`, incluso aunque `BlogController` no exista o no tenga un método de acción `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="f7739-670">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="f7739-671">Como se esperaba, si el método de acción existe, el enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17`.</span><span class="sxs-lookup"><span data-stu-id="f7739-671">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="f7739-672">*Sin embargo, si la acción no existe, el enrutamiento de punto de conexión genera una cadena vacía.*</span><span class="sxs-lookup"><span data-stu-id="f7739-672">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="f7739-673">Conceptualmente, el enrutamiento de punto de conexión no supone que, si la acción no existe, sí que exista el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-673">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="f7739-674">El *algoritmo de invalidación del valor de ambiente* de la generación de vínculos tiene otro comportamiento al usarlo con el enrutamiento de punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-674">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="f7739-675">La *invalidación del valor de ambiente* es el algoritmo que decide qué valores de ruta de la solicitud que se ejecuta actualmente (los valores de ambiente) se pueden usar en las operaciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-675">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="f7739-676">El enrutamiento convencional siempre invalida los valores de ruta adicionales al vincular a otra acción.</span><span class="sxs-lookup"><span data-stu-id="f7739-676">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="f7739-677">El enrutamiento mediante atributos no tenía este comportamiento antes del lanzamiento de ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="f7739-677">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="f7739-678">En versiones anteriores de ASP.NET Core, los vínculos a otra acción que usara los mismos nombres de parámetro de ruta producían errores de generación de vínculo.</span><span class="sxs-lookup"><span data-stu-id="f7739-678">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="f7739-679">En ASP.NET Core 2.2 o versiones posteriores, las dos formas de enrutamiento invalidan los valores cuando se vincula a otra acción.</span><span class="sxs-lookup"><span data-stu-id="f7739-679">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="f7739-680">Considere el ejemplo siguiente de ASP.NET Core 2.1 o una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="f7739-680">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="f7739-681">Al vincular a otra acción (o a otra página), los valores de ruta se pueden reutilizar de formas no deseadas.</span><span class="sxs-lookup"><span data-stu-id="f7739-681">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="f7739-682">En */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f7739-682">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="f7739-683">En */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="f7739-683">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="f7739-684">Si el URI es `/Store/Product/18` en ASP.NET Core 2.1 o versiones anteriores, el vínculo que genera `@Url.Page("/Login")` en la página Store/Info es `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="f7739-684">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="f7739-685">Se reutiliza el valor `id` de 18, aunque el destino del vínculo sea otro elemento totalmente distinto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-685">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="f7739-686">El valor de ruta `id` en el contexto de la página `/Login` probablemente sea un valor de id. de usuario, no un valor de id. de producto de tienda.</span><span class="sxs-lookup"><span data-stu-id="f7739-686">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="f7739-687">En el enrutamiento de punto de conexión con ASP.NET Core 2.2 o versiones posteriores, el resultado es `/Login`.</span><span class="sxs-lookup"><span data-stu-id="f7739-687">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="f7739-688">Los valores de ambiente no se reutilizan cuando el destino vinculado es otra acción o página.</span><span class="sxs-lookup"><span data-stu-id="f7739-688">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="f7739-689">Sintaxis de parámetro de ruta de ida y vuelta: las barras diagonales no se codifican cuando se usa una sintaxis de parámetro comodín de doble asterisco (`**`).</span><span class="sxs-lookup"><span data-stu-id="f7739-689">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="f7739-690">Durante la generación de vínculos, el sistema de enrutamiento codifica el valor capturado en un parámetro comodín de doble asterisco (`**`; por ejemplo, `{**myparametername}`), excepto las barras diagonales.</span><span class="sxs-lookup"><span data-stu-id="f7739-690">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="f7739-691">El comodín de doble asterisco es compatible con el enrutamiento basado en `IRouter` en ASP.NET Core 2.2 o versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="f7739-691">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="f7739-692">La sintaxis de parámetro comodín de un único asterisco en versiones anteriores de ASP.NET Core (`{*myparametername}`) sigue siendo compatible y las barras diagonales se codifican.</span><span class="sxs-lookup"><span data-stu-id="f7739-692">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="f7739-693">Ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-693">Route</span></span>              | <span data-ttu-id="f7739-694">Vínculo generado con</span><span class="sxs-lookup"><span data-stu-id="f7739-694">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="f7739-695">`/search/admin%2Fproducts` (la barra diagonal se codifica)</span><span class="sxs-lookup"><span data-stu-id="f7739-695">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="f7739-696">Ejemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="f7739-696">Middleware example</span></span>

<span data-ttu-id="f7739-697">En el ejemplo siguiente, un middleware usa la API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para crear el vínculo a un método de acción que enumera los productos de la tienda.</span><span class="sxs-lookup"><span data-stu-id="f7739-697">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="f7739-698">El uso del generador de vínculos mediante su inserción en una clase y la llamada a `GenerateLink` está disponible para cualquier clase de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-698">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="f7739-699">Creación de rutas</span><span class="sxs-lookup"><span data-stu-id="f7739-699">Create routes</span></span>

<span data-ttu-id="f7739-700">La mayoría de las aplicaciones crea rutas mediante una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> o a uno de los métodos de extensión similares definidos en <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f7739-700">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f7739-701">Todos los métodos de extensión <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> crean una instancia de <xref:Microsoft.AspNetCore.Routing.Route> y la agregan a la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="f7739-701">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f7739-702"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> no acepta un parámetro de controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-702"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f7739-703"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> solo agrega las rutas que se controlan mediante <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-703"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f7739-704">Para obtener más información sobre el enrutamiento en MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-704">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f7739-705">El código siguiente es un ejemplo de una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por una definición de ruta típica de ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f7739-705">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-706">Esta plantilla coincide con una ruta de dirección URL y extrae los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-706">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f7739-707">Por ejemplo, la ruta de acceso `/Products/Details/17` genera los valores de ruta siguientes: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-707">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f7739-708">Los valores de ruta se determinan al dividir la ruta de dirección URL en segmentos y hacer coincidir cada segmento con el nombre del *parámetro de ruta* en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-708">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f7739-709">Los parámetros de ruta tienen un nombre asignado.</span><span class="sxs-lookup"><span data-stu-id="f7739-709">Route parameters are named.</span></span> <span data-ttu-id="f7739-710">Para definir los parámetros, el nombre del parámetro se incluye entre llaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-710">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f7739-711">La plantilla anterior también podría coincidir con la ruta de dirección URL `/` y generar los valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-711">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f7739-712">Esto se debe a que los parámetros de ruta `{controller}` y `{action}` tienen valores predeterminados y el parámetro de ruta `id` es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-712">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f7739-713">Un signo igual (`=`) seguido de un valor después del nombre del parámetro de ruta define un valor predeterminado para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-713">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f7739-714">Un signo de interrogación (`?`) después del nombre del parámetro de ruta define un parámetro opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-714">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f7739-715">Los parámetros de ruta con un valor predeterminado *siempre* generan un valor de ruta cuando la ruta coincide.</span><span class="sxs-lookup"><span data-stu-id="f7739-715">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f7739-716">Los parámetros opcionales no generan un valor de ruta si no existió el segmento de ruta de dirección URL correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-716">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f7739-717">Vea la sección [Referencia de plantilla de ruta](#route-template-reference) para obtener una descripción detallada de los escenarios y la sintaxis de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-717">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f7739-718">En el ejemplo siguiente, la definición de parámetro de ruta `{id:int}` define una [restricción de ruta](#route-constraint-reference) para el parámetro de ruta `id`:</span><span class="sxs-lookup"><span data-stu-id="f7739-718">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f7739-719">Esta plantilla coincide con una ruta de dirección URL como `/Products/Details/17`, pero no con `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f7739-719">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f7739-720">Las restricciones de ruta implementan <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspeccionan los valores de ruta para comprobarlos.</span><span class="sxs-lookup"><span data-stu-id="f7739-720">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f7739-721">En este ejemplo, el valor de ruta `id` debe poder convertirse en un entero.</span><span class="sxs-lookup"><span data-stu-id="f7739-721">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f7739-722">Vea la [Referencia de restricción de ruta](#route-constraint-reference) para obtener una explicación de las restricciones de ruta proporcionadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f7739-722">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f7739-723">Las sobrecargas adicionales de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceptan valores para `constraints`, `dataTokens` y `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f7739-723">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f7739-724">Estos parámetros suelen usarse para pasar un objeto de tipo anónimo, donde los nombres de propiedad del tipo anónimo coinciden con los nombres de los parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-724">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f7739-725">En los ejemplos <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> siguientes se crean rutas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f7739-725">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f7739-726">La sintaxis insertada para definir las restricciones y los valores predeterminados puede ser conveniente para las rutas simples.</span><span class="sxs-lookup"><span data-stu-id="f7739-726">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f7739-727">Pero hay algunos escenarios, como los tokens de datos, que no son compatibles con la sintaxis insertada.</span><span class="sxs-lookup"><span data-stu-id="f7739-727">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f7739-728">En el ejemplo siguiente se muestran algunos escenarios más:</span><span class="sxs-lookup"><span data-stu-id="f7739-728">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f7739-729">La plantilla anterior coincide con una ruta de dirección URL como `/Blog/All-About-Routing/Introduction` y extrae los valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-729">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f7739-730">La ruta genera los valores de ruta predeterminados para `controller` y `action`, incluso si no hay parámetros de ruta correspondientes en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="f7739-730">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f7739-731">Los valores predeterminados pueden especificarse en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-731">Default values can be specified in the route template.</span></span> <span data-ttu-id="f7739-732">El parámetro de ruta `article` se define como un *comodín* por la aparición de un asterisco doble (`**`) antes del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-732">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="f7739-733">Los parámetros de ruta comodín capturan el resto de la ruta de dirección URL y también pueden coincidir con la cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-733">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f7739-734">En el ejemplo siguiente se agregan restricciones de ruta y tokens de datos:</span><span class="sxs-lookup"><span data-stu-id="f7739-734">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f7739-735">La plantilla anterior coincide con una ruta de dirección URL como `/en-US/Products/5` y extrae los valores `{ controller = Products, action = Details, id = 5 }` y los tokens de datos `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-735">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens de Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f7739-737">Generación de direcciones URL de clase de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-737">Route class URL generation</span></span>

<span data-ttu-id="f7739-738">La clase <xref:Microsoft.AspNetCore.Routing.Route> también puede llevar a cabo la generación de dirección URL mediante la combinación de un conjunto de valores de ruta con su plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-738">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f7739-739">Se trata lógicamente del proceso inverso de hacer coincidir la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-739">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-740">Para entender mejor la generación de direcciones URL, imagine qué dirección URL quiere generar y, después, piense cómo coincidiría una plantilla de ruta con esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-740">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f7739-741">¿Qué valores se generarían?</span><span class="sxs-lookup"><span data-stu-id="f7739-741">What values would be produced?</span></span> <span data-ttu-id="f7739-742">Este es un equivalente aproximado de cómo funciona la generación de dirección URL en la clase <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-742">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f7739-743">En el ejemplo siguiente se usa una ruta predeterminada de ASP.NET Core MVC general:</span><span class="sxs-lookup"><span data-stu-id="f7739-743">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-744">Con los valores de ruta `{ controller = Products, action = List }`, se genera la dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-744">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f7739-745">Los valores de ruta se sustituyen por los parámetros de ruta correspondientes para formar la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-745">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f7739-746">Como `id` es un parámetro de ruta opcional, la dirección URL se ha generado correctamente sin ningún valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f7739-746">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f7739-747">Con los valores de ruta `{ controller = Home, action = Index }`, se genera la dirección URL `/`.</span><span class="sxs-lookup"><span data-stu-id="f7739-747">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f7739-748">Los valores de ruta proporcionados coinciden con los valores predeterminados, y los segmentos correspondientes a los valores predeterminados se omiten sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="f7739-748">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f7739-749">Ambas direcciones URL generadas realizan un recorrido de ida y vuelta con la definición de ruta siguiente (`/Home/Index` y `/`) y generan los mismos valores de ruta que se usaron para generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-749">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f7739-750">Las aplicaciones con ASP.NET Core MVC deben usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para generar direcciones URL en lugar de llamar directamente al enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-750">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f7739-751">Para obtener más información sobre la generación de direcciones URL, vea la sección [Referencia de generación de direcciones URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-751">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f7739-752">Uso de software intermedio de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-752">Use Routing Middleware</span></span>

<span data-ttu-id="f7739-753">Haga referencia al [metapaquete Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) en el archivo de proyecto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-753">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f7739-754">Agregue enrutamiento al contenedor de servicios en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-754">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f7739-755">Las rutas se deben configurar en el método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f7739-755">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f7739-756">En la aplicación de ejemplo se usan las API siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-756">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f7739-757"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; solo coincide con solicitudes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-757"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f7739-758">En la tabla siguiente se muestran las respuestas con los URI especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-758">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f7739-759">Identificador URI</span><span class="sxs-lookup"><span data-stu-id="f7739-759">URI</span></span>                    | <span data-ttu-id="f7739-760">Respuesta</span><span class="sxs-lookup"><span data-stu-id="f7739-760">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f7739-761">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-761">Hello!</span></span> <span data-ttu-id="f7739-762">Valores de ruta: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f7739-762">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f7739-763">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-763">Hello!</span></span> <span data-ttu-id="f7739-764">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-764">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f7739-765">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-765">Hello!</span></span> <span data-ttu-id="f7739-766">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-766">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f7739-767">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-767">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f7739-768">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="f7739-768">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f7739-769">La solicitud pasa; solo coincide con HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-769">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f7739-770">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-770">The request falls through, no match.</span></span>              |

<span data-ttu-id="f7739-771">El marco de trabajo proporciona un conjunto de métodos de extensión para crear rutas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f7739-771">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f7739-772">Los métodos `Map[Verb]` usan restricciones para limitar la ruta al verbo HTTP en el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="f7739-772">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f7739-773">Por ejemplo, vea <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> y <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-773">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f7739-774">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-774">Route template reference</span></span>

<span data-ttu-id="f7739-775">Los tokens entre llaves (`{ ... }`) definen *parámetros de ruta* que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-775">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f7739-776">Puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="f7739-776">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f7739-777">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-777">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f7739-778">Estos parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-778">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f7739-779">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-779">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f7739-780">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-780">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f7739-781">Para que el delimitador de parámetro de ruta literal coincida (`{` o `}`), repita el carácter (`{{` o `}}`) para usarlo como secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-781">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f7739-782">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-782">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f7739-783">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-783">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f7739-784">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="f7739-784">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f7739-785">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el punto final (`.`) es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-785">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f7739-786">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="f7739-786">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f7739-787">Se puede usar un asterisco (`*`) o un asterisco doble (`**`) como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="f7739-787">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f7739-788">Se denominan parámetros *comodín*.</span><span class="sxs-lookup"><span data-stu-id="f7739-788">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="f7739-789">Por ejemplo, `blog/{**slug}` coincide con cualquier URI que empiece por `/blog` y que vaya seguido de cualquier valor, que se asigna al valor de ruta `slug`.</span><span class="sxs-lookup"><span data-stu-id="f7739-789">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f7739-790">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-790">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f7739-791">El parámetro catch-all inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos caracteres de separación de ruta de acceso (`/`).</span><span class="sxs-lookup"><span data-stu-id="f7739-791">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f7739-792">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f7739-792">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f7739-793">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-793">Note the escaped forward slash.</span></span> <span data-ttu-id="f7739-794">Para los caracteres separadores de ruta de acceso de ida y vuelta, use el prefijo de parámetro de ruta `**`.</span><span class="sxs-lookup"><span data-stu-id="f7739-794">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="f7739-795">La ruta `foo/{**path}` con `{ path = "my/path" }` genera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="f7739-795">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="f7739-796">Los parámetros de ruta pueden tener *valores predeterminados* designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f7739-796">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f7739-797">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f7739-797">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f7739-798">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-798">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f7739-799">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro, como en `id?`.</span><span class="sxs-lookup"><span data-stu-id="f7739-799">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f7739-800">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es que un parámetro de ruta con un valor predeterminado siempre genera un valor, mientras que un parámetro opcional tiene un valor solo cuando la dirección URL de solicitud lo proporciona.</span><span class="sxs-lookup"><span data-stu-id="f7739-800">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f7739-801">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-801">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f7739-802">Si se agrega un carácter de dos puntos (`:`) y un nombre de restricción después del nombre del parámetro de ruta, se especifica una *restricción insertada* en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-802">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f7739-803">Si la restricción requiere argumentos, se incluyen entre paréntesis (`(...)`) después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-803">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f7739-804">Se pueden especificar varias restricciones insertadas si se anexa otro carácter de dos puntos (`:`) y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-804">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f7739-805">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-805">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f7739-806">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f7739-806">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f7739-807">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-807">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f7739-808">Los parámetros de ruta también pueden tener transformadores de parámetros, que transforman el valor de un parámetro al generar vínculos y acciones y páginas coincidentes para las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-808">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="f7739-809">Al igual que las restricciones, los transformadores de parámetros se pueden agregar en línea a un parámetro de ruta al incorporar un carácter de dos puntos (`:`) y un nombre de transformador después del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-809">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="f7739-810">Por ejemplo, la plantilla de ruta `blog/{article:slugify}` especifica un transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="f7739-810">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="f7739-811">Para obtener más información sobre los transformadores de parámetros, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-811">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="f7739-812">En la tabla siguiente se muestran algunas plantillas de ruta de ejemplo y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-812">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f7739-813">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-813">Route Template</span></span>                           | <span data-ttu-id="f7739-814">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-814">Example Matching URI</span></span>    | <span data-ttu-id="f7739-815">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="f7739-815">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f7739-816">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f7739-816">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f7739-817">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="f7739-817">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f7739-818">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f7739-818">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f7739-819">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-819">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f7739-820">Se asigna al controlador `Products` y la acción `Details` (`id` se establece en 123).</span><span class="sxs-lookup"><span data-stu-id="f7739-820">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f7739-821">Se asigna al controlador `Home` y al método `Index` (`id` se omite).</span><span class="sxs-lookup"><span data-stu-id="f7739-821">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f7739-822">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="f7739-822">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f7739-823">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-823">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-824">Habilite el [registro](xref:fundamentals/logging/index) para ver de qué forma las implementaciones de enrutamiento integradas, como <xref:Microsoft.AspNetCore.Routing.Route>, coinciden con las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-824">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f7739-825">Nombres de enrutamientos reservados</span><span class="sxs-lookup"><span data-stu-id="f7739-825">Reserved routing names</span></span>

<span data-ttu-id="f7739-826">Las siguientes palabras clave son nombres reservados y no se pueden usar como nombres de ruta o parámetros:</span><span class="sxs-lookup"><span data-stu-id="f7739-826">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f7739-827">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-827">Route constraint reference</span></span>

<span data-ttu-id="f7739-828">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-828">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f7739-829">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-829">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f7739-830">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="f7739-830">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f7739-831">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-831">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f7739-832">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-832">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f7739-833">No use las restricciones para las **validación de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f7739-833">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f7739-834">Si las restricciones se usan para la **validación de entrada**, los resultados de entrada no válidos producirán un error *404 - No encontrado* en lugar de un error *400 - Solicitud incorrecta* con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="f7739-834">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f7739-835">Las restricciones de ruta se usan para **eliminar la ambigüedad** entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-835">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f7739-836">En la tabla siguiente se muestran algunas restricciones de ruta de ejemplo y su comportamiento esperado.</span><span class="sxs-lookup"><span data-stu-id="f7739-836">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f7739-837">restricción</span><span class="sxs-lookup"><span data-stu-id="f7739-837">constraint</span></span> | <span data-ttu-id="f7739-838">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-838">Example</span></span> | <span data-ttu-id="f7739-839">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-839">Example Matches</span></span> | <span data-ttu-id="f7739-840">Notas</span><span class="sxs-lookup"><span data-stu-id="f7739-840">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f7739-841">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-841">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-842">Coincide con cualquier entero</span><span class="sxs-lookup"><span data-stu-id="f7739-842">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f7739-843">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f7739-843">`true`, `FALSE`</span></span> | <span data-ttu-id="f7739-844">Coincide con `true` o `false` (no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-844">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f7739-845">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f7739-845">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f7739-846">Coincide con un valor `DateTime` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-846">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f7739-847">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f7739-847">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f7739-848">Coincide con un valor `decimal` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-848">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f7739-849">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-849">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-850">Coincide con un valor `double` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-850">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f7739-851">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-851">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-852">Coincide con un valor `float` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-852">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f7739-853">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f7739-853">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f7739-854">Coincide con un valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-854">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f7739-855">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-855">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-856">Coincide con un valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-856">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f7739-857">La cadena debe tener al menos cuatro caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-857">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f7739-858">La cadena no debe tener más de ocho caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-858">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f7739-859">La cadena debe tener una longitud de exactamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-859">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f7739-860">La cadena debe tener una longitud como mínimo de ocho caracteres y como máximo de 16</span><span class="sxs-lookup"><span data-stu-id="f7739-860">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f7739-861">El valor entero debe ser como mínimo 18</span><span class="sxs-lookup"><span data-stu-id="f7739-861">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f7739-862">El valor entero debe ser como máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-862">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f7739-863">El valor entero debe ser como mínimo 18 y máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-863">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f7739-864">La cadena debe constar de uno o más caracteres alfabéticos (`a`-`z`, no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-864">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f7739-865">La cadena debe coincidir con la expresión regular (vea las sugerencias sobre cómo definir una expresión regular)</span><span class="sxs-lookup"><span data-stu-id="f7739-865">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f7739-866">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-866">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f7739-867">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-867">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f7739-868">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="f7739-868">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f7739-869">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR (como `int` o `DateTime`) usan siempre la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="f7739-869">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f7739-870">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="f7739-870">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f7739-871">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-871">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f7739-872">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="f7739-872">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f7739-873">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="f7739-873">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f7739-874">Expresiones regulares</span><span class="sxs-lookup"><span data-stu-id="f7739-874">Regular expressions</span></span>

<span data-ttu-id="f7739-875">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-875">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f7739-876">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="f7739-876">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f7739-877">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="f7739-877">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f7739-878">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-878">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f7739-879">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en el enrutamiento, los caracteres `\` (una barra diagonal inversa) de la cadena se deben proporcionar como caracteres `\\` (barra diagonal inversa doble) en el archivo de código fuente de C# para que el carácter de escape de cadena `\` tenga una secuencia de escape (a menos que se usen [literales de cadena textuales](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f7739-879">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f7739-880">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento (`{`, `}`, `[` y `]`), duplique los caracteres en la expresión (`{{`, `}`, `[[` y `]]`).</span><span class="sxs-lookup"><span data-stu-id="f7739-880">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f7739-881">En la tabla siguiente se muestra una expresión regular y la versión con la secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-881">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f7739-882">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="f7739-882">Regular Expression</span></span>    | <span data-ttu-id="f7739-883">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="f7739-883">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f7739-884">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter de acento circunflejo (`^`) y coinciden con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-884">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f7739-885">Las expresiones suelen terminar con el carácter del signo de dólar (`$`) y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-885">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f7739-886">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-886">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f7739-887">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, algo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="f7739-887">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f7739-888">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-888">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f7739-889">Expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-889">Expression</span></span>   | <span data-ttu-id="f7739-890">String</span><span class="sxs-lookup"><span data-stu-id="f7739-890">String</span></span>    | <span data-ttu-id="f7739-891">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="f7739-891">Match</span></span> | <span data-ttu-id="f7739-892">Comentario</span><span class="sxs-lookup"><span data-stu-id="f7739-892">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f7739-893">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-893">hello</span></span>     | <span data-ttu-id="f7739-894">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-894">Yes</span></span>   | <span data-ttu-id="f7739-895">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-895">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-896">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-896">123abc456</span></span> | <span data-ttu-id="f7739-897">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-897">Yes</span></span>   | <span data-ttu-id="f7739-898">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-898">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-899">mz</span><span class="sxs-lookup"><span data-stu-id="f7739-899">mz</span></span>        | <span data-ttu-id="f7739-900">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-900">Yes</span></span>   | <span data-ttu-id="f7739-901">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-901">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f7739-902">MZ</span><span class="sxs-lookup"><span data-stu-id="f7739-902">MZ</span></span>        | <span data-ttu-id="f7739-903">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-903">Yes</span></span>   | <span data-ttu-id="f7739-904">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f7739-904">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-905">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-905">hello</span></span>     | <span data-ttu-id="f7739-906">No</span><span class="sxs-lookup"><span data-stu-id="f7739-906">No</span></span>    | <span data-ttu-id="f7739-907">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-907">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-908">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-908">123abc456</span></span> | <span data-ttu-id="f7739-909">No</span><span class="sxs-lookup"><span data-stu-id="f7739-909">No</span></span>    | <span data-ttu-id="f7739-910">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-910">See `^` and `$` above</span></span> |

<span data-ttu-id="f7739-911">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-911">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f7739-912">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="f7739-912">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f7739-913">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="f7739-913">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f7739-914">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="f7739-914">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f7739-915">Las restricciones que se pasan al diccionario de restricciones (no insertado en una plantilla) que no coinciden con una de las restricciones conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-915">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f7739-916">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="f7739-916">Custom Route Constraints</span></span>

<span data-ttu-id="f7739-917">Además de las restricciones de ruta integradas, se pueden crear restricciones de ruta personalizadas implementando la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f7739-917">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f7739-918">La interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contiene un único método, `Match`, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="f7739-918">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f7739-919">Para utilizar una restricción <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, el tipo de restricción de ruta debe registrarse con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-919">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f7739-920"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> es un diccionario que asigna claves de restricciones de ruta a implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="f7739-920">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f7739-921">El parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f7739-921">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f7739-922">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-922">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f7739-923">La restricción puede aplicarse a las rutas de la manera habitual, usando el nombre especificado al registrar el tipo de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-923">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f7739-924">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-924">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="f7739-925">Referencia de transformadores de parámetros</span><span class="sxs-lookup"><span data-stu-id="f7739-925">Parameter transformer reference</span></span>

<span data-ttu-id="f7739-926">Transformadores de parámetros:</span><span class="sxs-lookup"><span data-stu-id="f7739-926">Parameter transformers:</span></span>

* <span data-ttu-id="f7739-927">Se ejecutan al generar un vínculo para <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-927">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="f7739-928">Implemente `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="f7739-928">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="f7739-929">Se configuran con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="f7739-929">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="f7739-930">Toman el valor de ruta del parámetro y lo transforman en un nuevo valor de cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-930">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="f7739-931">Como resultado, el valor transformado se usa en el vínculo generado.</span><span class="sxs-lookup"><span data-stu-id="f7739-931">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="f7739-932">Por ejemplo, un transformador de parámetros personalizado `slugify` en el patrón de ruta `blog\{article:slugify}` con `Url.Action(new { article = "MyTestArticle" })` genera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="f7739-932">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="f7739-933">Para usar un transformador de parámetros en un patrón de ruta, configúrelo primero con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-933">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="f7739-934">El marco usa los transformadores de parámetros para transformar el URI en el que se resuelve un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="f7739-934">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="f7739-935">Por ejemplo, ASP.NET Core MVC usa transformadores de parámetros para transformar el valor de ruta usado para hacer coincidir elementos `area`, `controller`, `action` y `page`.</span><span class="sxs-lookup"><span data-stu-id="f7739-935">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="f7739-936">Con la ruta anterior, la acción `SubscriptionManagementController.GetAll()` coincide con el URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f7739-936">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="f7739-937">Un transformador de parámetros no cambia los valores de ruta usados para generar un vínculo.</span><span class="sxs-lookup"><span data-stu-id="f7739-937">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="f7739-938">Por ejemplo, `Url.Action("GetAll", "SubscriptionManagement")` genera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="f7739-938">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="f7739-939">ASP.NET Core proporciona las convenciones de API para usar transformadores de parámetros con rutas generadas:</span><span class="sxs-lookup"><span data-stu-id="f7739-939">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="f7739-940">ASP.NET Core MVC tiene la convención de API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f7739-940">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="f7739-941">Esta convención aplica un transformador de parámetro especificado a todas las rutas de atributo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-941">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="f7739-942">El transformador de parámetro transforma los tokens de rutas de atributo a medida que se reemplazan.</span><span class="sxs-lookup"><span data-stu-id="f7739-942">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="f7739-943">Para más información, consulte [Usar un transformador de parámetro para personalizar el reemplazo de tokens](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="f7739-943">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="f7739-944">Razor Pages tiene la convención de API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="f7739-944">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="f7739-945">Esta convención aplica un transformador de parámetros especificado a todas las instancias de Razor Pages detectadas de forma automática.</span><span class="sxs-lookup"><span data-stu-id="f7739-945">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="f7739-946">El transformador de parámetros transforma los segmentos de nombre de archivo y carpeta de las rutas de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-946">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="f7739-947">Para más información, consulte el artículo sobre cómo [usar un transformador de parámetro para personalizar rutas de Razor Pages](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="f7739-947">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="f7739-948">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="f7739-948">URL generation reference</span></span>

<span data-ttu-id="f7739-949">En el ejemplo siguiente se muestra cómo se genera un vínculo a una ruta, dado un diccionario de valores de ruta y un valor <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f7739-949">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f7739-950">El valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generado al final del ejemplo anterior es `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f7739-950">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f7739-951">El diccionario proporciona los valores de ruta `operation` e `id` de la plantilla "Ruta de paquete de seguimiento", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-951">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f7739-952">Para obtener más información, vea el código de ejemplo de la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware) o la [aplicación de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f7739-952">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f7739-953">El segundo parámetro del constructor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> es una colección de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f7739-953">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f7739-954">Los valores de ambiente son adecuados porque limitan el número de valores que el desarrollador debe especificar dentro de un contexto de solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-954">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f7739-955">Los valores de ruta actuales de la solicitud actual se consideran valores de ambiente para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-955">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f7739-956">En la acción `About` de `HomeController` de una aplicación ASP.NET Core MVC, no es necesario especificar el valor de ruta de controlador para vincular a la acción `Index` (se usará el valor de ambiente `Home`).</span><span class="sxs-lookup"><span data-stu-id="f7739-956">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f7739-957">Los valores de ambiente que no coincidan con un parámetro se omiten.</span><span class="sxs-lookup"><span data-stu-id="f7739-957">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f7739-958">También se omiten los valores de ambiente cuando un valor proporcionado de forma explícita invalida el valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-958">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f7739-959">La coincidencia se produce de izquierda a derecha en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-959">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f7739-960">Los valores que se proporcionan de forma explícita pero que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="f7739-960">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f7739-961">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-961">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f7739-962">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f7739-962">Ambient Values</span></span>                     | <span data-ttu-id="f7739-963">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f7739-963">Explicit Values</span></span>                        | <span data-ttu-id="f7739-964">Resultado</span><span class="sxs-lookup"><span data-stu-id="f7739-964">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f7739-965">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-965">controller = "Home"</span></span>                | <span data-ttu-id="f7739-966">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-966">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-967">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-967">controller = "Home"</span></span>                | <span data-ttu-id="f7739-968">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-968">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f7739-969">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-969">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f7739-970">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-970">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-971">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-971">controller = "Home"</span></span>                | <span data-ttu-id="f7739-972">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-972">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f7739-973">Si una ruta tiene un valor predeterminado que no se corresponde con un parámetro y ese valor se proporciona de forma explícita, debe coincidir con el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="f7739-973">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f7739-974">La generación de vínculos solo genera un vínculo para esta ruta si se proporcionan los valores coincidentes para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="f7739-974">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f7739-975">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="f7739-975">Complex segments</span></span>

<span data-ttu-id="f7739-976">Los segmentos complejos (por ejemplo, `[Route("/x{token}y")]`), se procesan buscando coincidencias de literales de derecha a izquierda de un modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-976">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f7739-977">Consulte [este código](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para obtener una explicación detallada de cómo se comparan los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-977">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f7739-978">El [código de ejemplo](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) no se usa en ASP.NET Core, pero proporciona una buena explicación de los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-978">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="f7739-979">El enrutamiento es responsable de asignar los URI de solicitud a los controladores de ruta y de distribuir las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="f7739-979">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="f7739-980">Las rutas se definen en la aplicación y se configuran cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-980">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="f7739-981">Una ruta puede extraer opcionalmente valores de la dirección URL contenida en la solicitud, que se pueden usar para procesar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-981">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="f7739-982">Mediante las rutas configuradas de la aplicación, el enrutamiento puede generar direcciones URL que se asignan a los controladores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-982">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="f7739-983">Para usar los escenarios de enrutamiento más recientes de ASP.NET Core 2.1, especifique la [versión de compatibilidad](xref:mvc/compatibility-version) en el registro de servicios de MVC en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-983">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="f7739-984">En este documento se describe el enrutamiento de ASP.NET Core de bajo nivel.</span><span class="sxs-lookup"><span data-stu-id="f7739-984">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="f7739-985">Para obtener información sobre el enrutamiento de ASP.NET Core MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-985">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="f7739-986">Para obtener más información sobre las convenciones de enrutamiento en Razor Pages, consulte <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-986">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-987">[Vea o descargue el código de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f7739-987">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="f7739-988">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-988">Routing basics</span></span>

<span data-ttu-id="f7739-989">La mayoría de las aplicaciones deben elegir un esquema de enrutamiento básico y descriptivo para que las direcciones URL sean legibles y significativas.</span><span class="sxs-lookup"><span data-stu-id="f7739-989">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="f7739-990">La ruta convencional predeterminada `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="f7739-990">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="f7739-991">Admite un esquema de enrutamiento básico y descriptivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-991">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="f7739-992">Se trata de un punto de partida útil para las aplicaciones basadas en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="f7739-992">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="f7739-993">Los desarrolladores suelen agregar rutas breves adicionales a áreas de mucho tráfico de una aplicación en situaciones especializadas (por ejemplo, puntos de conexión de blog y comercio electrónico) con el [enrutamiento mediante atributos](xref:mvc/controllers/routing#attribute-routing) o rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="f7739-993">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="f7739-994">Las API web deben usar el enrutamiento mediante atributos para modelar la funcionalidad de la aplicación como un conjunto de recursos donde las operaciones se representan mediante verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-994">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="f7739-995">Esto significa que muchas operaciones (por ejemplo, GET y POST) del mismo recurso lógico usarán la misma dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-995">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="f7739-996">El enrutamiento mediante atributos proporciona un nivel de control que es necesario para diseñar cuidadosamente un diseño de puntos de conexión públicos de la API.</span><span class="sxs-lookup"><span data-stu-id="f7739-996">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="f7739-997">En las aplicaciones de Razor Pages se usa el enrutamiento convencional predeterminado para proporcionar recursos con nombre en la carpeta *Páginas* de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-997">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="f7739-998">Existen convenciones adicionales que permiten personalizar el comportamiento de enrutamiento de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-998">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="f7739-999">Para obtener más información, vea <xref:razor-pages/index> y <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="f7739-999">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="f7739-1000">La compatibilidad de la generación de direcciones URL permite desarrollar la aplicación sin codificar de forma rígida las direcciones URL para vincular la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1000">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="f7739-1001">Esta compatibilidad permite empezar con una configuración de enrutamiento básica y modificar las rutas una vez determinado el diseño de los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1001">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="f7739-1002">El enrutamiento usa *rutas* (implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouter>) para:</span><span class="sxs-lookup"><span data-stu-id="f7739-1002">Routing uses *routes* (implementations of <xref:Microsoft.AspNetCore.Routing.IRouter>) to:</span></span>

* <span data-ttu-id="f7739-1003">Asignar las solicitudes entrantes a *controladores de ruta*.</span><span class="sxs-lookup"><span data-stu-id="f7739-1003">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="f7739-1004">Generar las direcciones URL que se usan en las respuestas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1004">Generate the URLs used in responses.</span></span>

<span data-ttu-id="f7739-1005">De forma predeterminada, una aplicación tiene una sola colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1005">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="f7739-1006">Cuando llega una solicitud, las rutas de la colección se procesan en el orden en el que se encuentran en la colección.</span><span class="sxs-lookup"><span data-stu-id="f7739-1006">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="f7739-1007">El marco de trabajo intenta hacer coincidir una dirección URL de solicitud entrante con una ruta de la colección mediante una llamada al método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> en cada ruta de la colección.</span><span class="sxs-lookup"><span data-stu-id="f7739-1007">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="f7739-1008">Una respuesta puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información de ruta. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1008">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="f7739-1009">El sistema de enrutamiento tiene las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-1009">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="f7739-1010">La sintaxis de plantilla de ruta se usa para definir las rutas con parámetros de ruta con tokens.</span><span class="sxs-lookup"><span data-stu-id="f7739-1010">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="f7739-1011">Se permite la configuración de puntos de conexión de estilo convencional y de estilo de atributo.</span><span class="sxs-lookup"><span data-stu-id="f7739-1011">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="f7739-1012">Se usa <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para determinar si un parámetro de dirección URL contiene un valor válido para una restricción de punto de conexión determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-1012"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="f7739-1013">Los modelos de aplicación, como MVC y Razor Pages, registran todas sus rutas, que tienen una implementación predecible de los escenarios de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1013">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="f7739-1014">Una respuesta puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información de ruta. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1014">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="f7739-1015">La generación de direcciones URL se basa en rutas, que admiten la extensibilidad arbitraria.</span><span class="sxs-lookup"><span data-stu-id="f7739-1015">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="f7739-1016"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> ofrece métodos para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1016"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

<span data-ttu-id="f7739-1017">La clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> conecta el enrutamiento a la canalización de [software intermedio](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="f7739-1017">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="f7739-1018">[ASP.NET Core MVC](xref:mvc/overview) agrega enrutamiento a la canalización de middleware como parte de su configuración y controla el enrutamiento en las aplicaciones de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="f7739-1018">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="f7739-1019">Para obtener información sobre cómo usar el enrutamiento como componente independiente, vea la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="f7739-1019">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="f7739-1020">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-1020">URL matching</span></span>

<span data-ttu-id="f7739-1021">La coincidencia de dirección URL es el proceso por el cual el enrutamiento envía una solicitud entrante a un *controlador*.</span><span class="sxs-lookup"><span data-stu-id="f7739-1021">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="f7739-1022">Este proceso se basa en datos de la ruta de dirección URL, pero se puede ampliar para tener en cuenta cualquier dato de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-1022">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="f7739-1023">La capacidad de enviar solicitudes a controladores independientes es clave para escalar el tamaño y la complejidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1023">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="f7739-1024">Las solicitudes entrantes especifican la clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, que llama al método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> en cada ruta de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-1024">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="f7739-1025">La instancia de <xref:Microsoft.AspNetCore.Routing.IRouter> decide si *controla* la solicitud mediante el establecimiento de [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) en un <xref:Microsoft.AspNetCore.Http.RequestDelegate> que no sea NULL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1025">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="f7739-1026">Si una ruta establece un controlador para la solicitud, el procesamiento de rutas se detiene y se invoca el controlador para procesar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-1026">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="f7739-1027">Si no se encuentra ningún controlador de ruta para procesar la solicitud, el middleware entrega la solicitud al siguiente middleware en la canalización de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-1027">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="f7739-1028">La entrada principal para <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> es el [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) asociado a la solicitud actual.</span><span class="sxs-lookup"><span data-stu-id="f7739-1028">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="f7739-1029">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) y [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) son salidas que se establecen después de que una ruta coincida.</span><span class="sxs-lookup"><span data-stu-id="f7739-1029">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="f7739-1030">Una coincidencia que llama a <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> también establece las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1030">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="f7739-1031">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) es un diccionario de los *valores de ruta* generados desde la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1031">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="f7739-1032">Estos valores se suelen determinar mediante la conversión en tokens de la dirección URL, y se pueden usar para aceptar la entrada del usuario o para tomar otras decisiones sobre el envío dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1032">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="f7739-1033">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) es un contenedor de propiedades de datos adicionales relacionados con la ruta coincidente.</span><span class="sxs-lookup"><span data-stu-id="f7739-1033">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="f7739-1034">Se proporcionan <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> para permitir la asociación de datos de estado con cada ruta, de modo que la aplicación pueda tomar decisiones en función de las rutas que han coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-1034"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="f7739-1035">Estos valores los define el desarrollador y **no** afectan de ninguna manera al comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1035">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="f7739-1036">Además, los valores que se guardan provisionalmente en [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) pueden ser de cualquier tipo, a diferencia de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que deben poder convertirse fácilmente en cadenas y a partir de estas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1036">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="f7739-1037">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) es una lista de las rutas que han participado en encontrar una coincidencia correcta con la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-1037">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="f7739-1038">Las rutas se pueden anidar unas dentro de otras.</span><span class="sxs-lookup"><span data-stu-id="f7739-1038">Routes can be nested inside of one another.</span></span> <span data-ttu-id="f7739-1039">La propiedad <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> refleja la ruta de acceso del árbol lógico de rutas que han tenido como resultado una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-1039">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="f7739-1040">Por lo general, el primer elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es la colección de rutas y se debe usar para la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1040">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="f7739-1041">El último elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es el controlador de ruta que ha coincidido.</span><span class="sxs-lookup"><span data-stu-id="f7739-1041">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="f7739-1042">Generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-1042">URL generation</span></span>

<span data-ttu-id="f7739-1043">La generación de dirección URL es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL basada en un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1043">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="f7739-1044">Esto permite una separación lógica entre los controladores de ruta y las direcciones URL que tienen acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1044">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="f7739-1045">La generación de direcciones URL sigue un proceso iterativo similar, pero se inicia cuando el código de usuario o de marco de trabajo llama al método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1045">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="f7739-1046">Se llama en secuencia al método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de cada *ruta* hasta que se devuelva un valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData> distinto de NULL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1046">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="f7739-1047">La principal entradas de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> son:</span><span class="sxs-lookup"><span data-stu-id="f7739-1047">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="f7739-1048">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="f7739-1048">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="f7739-1049">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="f7739-1049">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="f7739-1050">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="f7739-1050">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="f7739-1051">Las rutas usan principalmente los valores de ruta proporcionados por <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> y <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> para decidir si es posible generar una dirección URL y qué valores se van a incluir.</span><span class="sxs-lookup"><span data-stu-id="f7739-1051">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="f7739-1052"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> son el conjunto de valores de ruta producidos a partir de la coincidencia con la solicitud actual.</span><span class="sxs-lookup"><span data-stu-id="f7739-1052">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="f7739-1053">En cambio, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> son los valores de ruta que especifican cómo se genera la dirección URL deseada para la operación actual.</span><span class="sxs-lookup"><span data-stu-id="f7739-1053">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="f7739-1054">Se proporciona <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> por si una ruta debe obtener servicios o datos adicionales asociados con el contexto actual.</span><span class="sxs-lookup"><span data-stu-id="f7739-1054">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-1055">Piense en [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) como un conjunto de invalidaciones para [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="f7739-1055">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="f7739-1056">La generación de direcciones URL intenta reutilizar los valores de ruta de la solicitud actual para generar direcciones URL para los vínculos con la misma ruta o valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1056">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="f7739-1057">La salida de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> es <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1057">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="f7739-1058"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> es un valor paralelo de <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1058"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="f7739-1059"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contiene el valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> de la dirección URL de salida y algunas propiedades más que la ruta debe establecer.</span><span class="sxs-lookup"><span data-stu-id="f7739-1059"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="f7739-1060">La propiedad [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) contiene la *ruta de acceso virtual* generada por la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1060">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="f7739-1061">Es posible que deba procesar aún más la ruta de acceso, según sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="f7739-1061">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="f7739-1062">Si quiere representar la dirección URL generada en HTML, anteponga la ruta de acceso base de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1062">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="f7739-1063">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) es una referencia a la ruta que ha generado correctamente la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1063">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="f7739-1064">La propiedad [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) es un diccionario de datos adicionales relacionados con la ruta que ha generado la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1064">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="f7739-1065">Se trata del valor paralelo de [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="f7739-1065">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="f7739-1066">Creación de rutas</span><span class="sxs-lookup"><span data-stu-id="f7739-1066">Create routes</span></span>

<span data-ttu-id="f7739-1067">El enrutamiento proporciona la clase <xref:Microsoft.AspNetCore.Routing.Route> como implementación estándar de <xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1067">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="f7739-1068"><xref:Microsoft.AspNetCore.Routing.Route> usa la sintaxis de *plantilla de ruta* para definir patrones que se hacen coincidir con la ruta de dirección URL cuando se llama a <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1068"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="f7739-1069"><xref:Microsoft.AspNetCore.Routing.Route> usa la misma plantilla de ruta para generar una dirección URL cuando se llama a <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1069"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="f7739-1070">La mayoría de las aplicaciones crea rutas mediante una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> o a uno de los métodos de extensión similares definidos en <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1070">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="f7739-1071">Todos los métodos de extensión <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> crean una instancia de <xref:Microsoft.AspNetCore.Routing.Route> y la agregan a la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1071">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="f7739-1072"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> no acepta un parámetro de controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1072"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="f7739-1073"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> solo agrega las rutas que se controlan mediante <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1073"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="f7739-1074">El controlador predeterminado es un elemento `IRouter`, y es posible que el controlador no pueda atender la solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-1074">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="f7739-1075">Por ejemplo, ASP.NET Core MVC se suele configurar como un controlador predeterminado que solo controla las solicitudes que coinciden con un controlador y una acción disponibles.</span><span class="sxs-lookup"><span data-stu-id="f7739-1075">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="f7739-1076">Para obtener más información sobre el enrutamiento en MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1076">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="f7739-1077">El código siguiente es un ejemplo de una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por una definición de ruta típica de ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="f7739-1077">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-1078">Esta plantilla coincide con una ruta de dirección URL y extrae los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1078">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="f7739-1079">Por ejemplo, la ruta de acceso `/Products/Details/17` genera los valores de ruta siguientes: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1079">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="f7739-1080">Los valores de ruta se determinan al dividir la ruta de dirección URL en segmentos y hacer coincidir cada segmento con el nombre del *parámetro de ruta* en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1080">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="f7739-1081">Los parámetros de ruta tienen un nombre asignado.</span><span class="sxs-lookup"><span data-stu-id="f7739-1081">Route parameters are named.</span></span> <span data-ttu-id="f7739-1082">Para definir los parámetros, el nombre del parámetro se incluye entre llaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1082">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="f7739-1083">La plantilla anterior también podría coincidir con la ruta de dirección URL `/` y generar los valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1083">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="f7739-1084">Esto se debe a que los parámetros de ruta `{controller}` y `{action}` tienen valores predeterminados y el parámetro de ruta `id` es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-1084">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="f7739-1085">Un signo igual (`=`) seguido de un valor después del nombre del parámetro de ruta define un valor predeterminado para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-1085">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="f7739-1086">Un signo de interrogación (`?`) después del nombre del parámetro de ruta define un parámetro opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-1086">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="f7739-1087">Los parámetros de ruta con un valor predeterminado *siempre* generan un valor de ruta cuando la ruta coincide.</span><span class="sxs-lookup"><span data-stu-id="f7739-1087">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="f7739-1088">Los parámetros opcionales no generan un valor de ruta si no existió el segmento de ruta de dirección URL correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-1088">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="f7739-1089">Vea la sección [Referencia de plantilla de ruta](#route-template-reference) para obtener una descripción detallada de los escenarios y la sintaxis de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1089">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="f7739-1090">En el ejemplo siguiente, la definición de parámetro de ruta `{id:int}` define una [restricción de ruta](#route-constraint-reference) para el parámetro de ruta `id`:</span><span class="sxs-lookup"><span data-stu-id="f7739-1090">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="f7739-1091">Esta plantilla coincide con una ruta de dirección URL como `/Products/Details/17`, pero no con `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1091">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="f7739-1092">Las restricciones de ruta implementan <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspeccionan los valores de ruta para comprobarlos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1092">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="f7739-1093">En este ejemplo, el valor de ruta `id` debe poder convertirse en un entero.</span><span class="sxs-lookup"><span data-stu-id="f7739-1093">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="f7739-1094">Vea la [Referencia de restricción de ruta](#route-constraint-reference) para obtener una explicación de las restricciones de ruta proporcionadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f7739-1094">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="f7739-1095">Las sobrecargas adicionales de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceptan valores para `constraints`, `dataTokens` y `defaults`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1095">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="f7739-1096">Estos parámetros suelen usarse para pasar un objeto de tipo anónimo, donde los nombres de propiedad del tipo anónimo coinciden con los nombres de los parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1096">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="f7739-1097">En los ejemplos <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> siguientes se crean rutas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="f7739-1097">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="f7739-1098">La sintaxis insertada para definir las restricciones y los valores predeterminados puede ser conveniente para las rutas simples.</span><span class="sxs-lookup"><span data-stu-id="f7739-1098">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="f7739-1099">Pero hay algunos escenarios, como los tokens de datos, que no son compatibles con la sintaxis insertada.</span><span class="sxs-lookup"><span data-stu-id="f7739-1099">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="f7739-1100">En el ejemplo siguiente se muestran algunos escenarios más:</span><span class="sxs-lookup"><span data-stu-id="f7739-1100">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="f7739-1101">La plantilla anterior coincide con una ruta de dirección URL como `/Blog/All-About-Routing/Introduction` y extrae los valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1101">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="f7739-1102">La ruta genera los valores de ruta predeterminados para `controller` y `action`, incluso si no hay parámetros de ruta correspondientes en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="f7739-1102">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="f7739-1103">Los valores predeterminados pueden especificarse en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1103">Default values can be specified in the route template.</span></span> <span data-ttu-id="f7739-1104">El parámetro de ruta `article` se define como un *comodín* por la aparición de un asterisco (`*`) antes del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1104">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="f7739-1105">Los parámetros de ruta comodín capturan el resto de la ruta de dirección URL y también pueden coincidir con la cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-1105">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="f7739-1106">En el ejemplo siguiente se agregan restricciones de ruta y tokens de datos:</span><span class="sxs-lookup"><span data-stu-id="f7739-1106">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="f7739-1107">La plantilla anterior coincide con una ruta de dirección URL como `/en-US/Products/5` y extrae los valores `{ controller = Products, action = Details, id = 5 }` y los tokens de datos `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1107">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens de Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="f7739-1109">Generación de direcciones URL de clase de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-1109">Route class URL generation</span></span>

<span data-ttu-id="f7739-1110">La clase <xref:Microsoft.AspNetCore.Routing.Route> también puede llevar a cabo la generación de dirección URL mediante la combinación de un conjunto de valores de ruta con su plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1110">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="f7739-1111">Se trata lógicamente del proceso inverso de hacer coincidir la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1111">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-1112">Para entender mejor la generación de direcciones URL, imagine qué dirección URL quiere generar y, después, piense cómo coincidiría una plantilla de ruta con esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1112">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="f7739-1113">¿Qué valores se generarían?</span><span class="sxs-lookup"><span data-stu-id="f7739-1113">What values would be produced?</span></span> <span data-ttu-id="f7739-1114">Este es un equivalente aproximado de cómo funciona la generación de dirección URL en la clase <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1114">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="f7739-1115">En el ejemplo siguiente se usa una ruta predeterminada de ASP.NET Core MVC general:</span><span class="sxs-lookup"><span data-stu-id="f7739-1115">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="f7739-1116">Con los valores de ruta `{ controller = Products, action = List }`, se genera la dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1116">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="f7739-1117">Los valores de ruta se sustituyen por los parámetros de ruta correspondientes para formar la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1117">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="f7739-1118">Como `id` es un parámetro de ruta opcional, la dirección URL se ha generado correctamente sin ningún valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1118">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="f7739-1119">Con los valores de ruta `{ controller = Home, action = Index }`, se genera la dirección URL `/`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1119">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="f7739-1120">Los valores de ruta proporcionados coinciden con los valores predeterminados, y los segmentos correspondientes a los valores predeterminados se omiten sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="f7739-1120">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="f7739-1121">Ambas direcciones URL generadas realizan un recorrido de ida y vuelta con la definición de ruta siguiente (`/Home/Index` y `/`) y generan los mismos valores de ruta que se usaron para generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1121">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="f7739-1122">Las aplicaciones con ASP.NET Core MVC deben usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para generar direcciones URL en lugar de llamar directamente al enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1122">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="f7739-1123">Para obtener más información sobre la generación de direcciones URL, vea la sección [Referencia de generación de direcciones URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-1123">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="f7739-1124">Uso de software intermedio de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="f7739-1124">Use Routing Middleware</span></span>

<span data-ttu-id="f7739-1125">Haga referencia al [metapaquete Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) en el archivo de proyecto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1125">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="f7739-1126">Agregue enrutamiento al contenedor de servicios en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="f7739-1126">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="f7739-1127">Las rutas se deben configurar en el método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1127">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="f7739-1128">En la aplicación de ejemplo se usan las API siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7739-1128">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="f7739-1129"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; solo coincide con solicitudes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-1129"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="f7739-1130">En la tabla siguiente se muestran las respuestas con los URI especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-1130">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="f7739-1131">Identificador URI</span><span class="sxs-lookup"><span data-stu-id="f7739-1131">URI</span></span>                    | <span data-ttu-id="f7739-1132">Respuesta</span><span class="sxs-lookup"><span data-stu-id="f7739-1132">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="f7739-1133">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-1133">Hello!</span></span> <span data-ttu-id="f7739-1134">Valores de ruta: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="f7739-1134">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="f7739-1135">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-1135">Hello!</span></span> <span data-ttu-id="f7739-1136">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-1136">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="f7739-1137">Hello!</span><span class="sxs-lookup"><span data-stu-id="f7739-1137">Hello!</span></span> <span data-ttu-id="f7739-1138">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="f7739-1138">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="f7739-1139">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-1139">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="f7739-1140">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="f7739-1140">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="f7739-1141">La solicitud pasa; solo coincide con HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="f7739-1141">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="f7739-1142">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="f7739-1142">The request falls through, no match.</span></span>              |

<span data-ttu-id="f7739-1143">Si va a configurar una única ruta, pase una instancia de `IRouter` para llamar a <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1143">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="f7739-1144">No tendrá que usar <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1144">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="f7739-1145">El marco de trabajo proporciona un conjunto de métodos de extensión para crear rutas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="f7739-1145">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="f7739-1146">Algunos de los métodos enumerados, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, requieren un <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1146">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="f7739-1147">El valor <xref:Microsoft.AspNetCore.Http.RequestDelegate> se usa como *controlador de ruta* cuando la ruta coincida.</span><span class="sxs-lookup"><span data-stu-id="f7739-1147">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="f7739-1148">Otros métodos de esta familia permiten configurar una canalización de software intermedio para usarla como controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1148">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="f7739-1149">Si el método `Map*` no acepta un controlador, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, usa <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1149">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="f7739-1150">Los métodos `Map[Verb]` usan restricciones para limitar la ruta al verbo HTTP en el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="f7739-1150">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="f7739-1151">Por ejemplo, vea <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> y <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1151">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="f7739-1152">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-1152">Route template reference</span></span>

<span data-ttu-id="f7739-1153">Los tokens entre llaves (`{ ... }`) definen *parámetros de ruta* que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1153">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="f7739-1154">Puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="f7739-1154">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="f7739-1155">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1155">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="f7739-1156">Estos parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="f7739-1156">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="f7739-1157">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1157">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="f7739-1158">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1158">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="f7739-1159">Para que el delimitador de parámetro de ruta literal coincida (`{` o `}`), repita el carácter (`{{` o `}}`) para usarlo como secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-1159">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="f7739-1160">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="f7739-1160">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="f7739-1161">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1161">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="f7739-1162">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="f7739-1162">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="f7739-1163">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el punto final (`.`) es opcional.</span><span class="sxs-lookup"><span data-stu-id="f7739-1163">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="f7739-1164">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="f7739-1164">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="f7739-1165">Se puede usar el asterisco (`*`) como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="f7739-1165">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="f7739-1166">Es lo que se denomina un parámetro *comodín*.</span><span class="sxs-lookup"><span data-stu-id="f7739-1166">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="f7739-1167">Por ejemplo, `blog/{*slug}` coincide con cualquier URI que empiece por `/blog` y que vaya seguido de cualquier valor, que se asigna al valor de ruta `slug`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1167">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="f7739-1168">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="f7739-1168">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="f7739-1169">El parámetro catch-all inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos caracteres de separación de ruta de acceso (`/`).</span><span class="sxs-lookup"><span data-stu-id="f7739-1169">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="f7739-1170">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1170">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="f7739-1171">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-1171">Note the escaped forward slash.</span></span>

<span data-ttu-id="f7739-1172">Los parámetros de ruta pueden tener *valores predeterminados* designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="f7739-1172">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="f7739-1173">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1173">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="f7739-1174">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-1174">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="f7739-1175">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro, como en `id?`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1175">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="f7739-1176">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es que un parámetro de ruta con un valor predeterminado siempre genera un valor, mientras que un parámetro opcional tiene un valor solo cuando la dirección URL de solicitud lo proporciona.</span><span class="sxs-lookup"><span data-stu-id="f7739-1176">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="f7739-1177">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1177">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="f7739-1178">Si se agrega un carácter de dos puntos (`:`) y un nombre de restricción después del nombre del parámetro de ruta, se especifica una *restricción insertada* en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1178">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="f7739-1179">Si la restricción requiere argumentos, se incluyen entre paréntesis (`(...)`) después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-1179">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="f7739-1180">Se pueden especificar varias restricciones insertadas si se anexa otro carácter de dos puntos (`:`) y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-1180">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="f7739-1181">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1181">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="f7739-1182">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1182">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="f7739-1183">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-1183">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="f7739-1184">En la tabla siguiente se muestran algunas plantillas de ruta de ejemplo y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="f7739-1184">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="f7739-1185">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-1185">Route Template</span></span>                           | <span data-ttu-id="f7739-1186">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-1186">Example Matching URI</span></span>    | <span data-ttu-id="f7739-1187">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="f7739-1187">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="f7739-1188">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1188">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="f7739-1189">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1189">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="f7739-1190">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1190">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="f7739-1191">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1191">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="f7739-1192">Se asigna al controlador `Products` y la acción `Details` (`id` se establece en 123).</span><span class="sxs-lookup"><span data-stu-id="f7739-1192">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="f7739-1193">Se asigna al controlador `Home` y al método `Index` (`id` se omite).</span><span class="sxs-lookup"><span data-stu-id="f7739-1193">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="f7739-1194">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="f7739-1194">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="f7739-1195">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1195">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="f7739-1196">Habilite el [registro](xref:fundamentals/logging/index) para ver de qué forma las implementaciones de enrutamiento integradas, como <xref:Microsoft.AspNetCore.Routing.Route>, coinciden con las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="f7739-1196">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="f7739-1197">Nombres de enrutamientos reservados</span><span class="sxs-lookup"><span data-stu-id="f7739-1197">Reserved routing names</span></span>

<span data-ttu-id="f7739-1198">Las siguientes palabras clave son nombres reservados y no se pueden usar como nombres de ruta o parámetros:</span><span class="sxs-lookup"><span data-stu-id="f7739-1198">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="f7739-1199">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="f7739-1199">Route constraint reference</span></span>

<span data-ttu-id="f7739-1200">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1200">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="f7739-1201">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-1201">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="f7739-1202">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="f7739-1202">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="f7739-1203">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="f7739-1203">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="f7739-1204">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1204">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="f7739-1205">No use las restricciones para las **validación de entrada**.</span><span class="sxs-lookup"><span data-stu-id="f7739-1205">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="f7739-1206">Si las restricciones se usan para la **validación de entrada**, los resultados de entrada no válidos producirán un error *404 - No encontrado* en lugar de un error *400 - Solicitud incorrecta* con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="f7739-1206">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="f7739-1207">Las restricciones de ruta se usan para **eliminar la ambigüedad** entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="f7739-1207">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="f7739-1208">En la tabla siguiente se muestran algunas restricciones de ruta de ejemplo y su comportamiento esperado.</span><span class="sxs-lookup"><span data-stu-id="f7739-1208">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="f7739-1209">restricción</span><span class="sxs-lookup"><span data-stu-id="f7739-1209">constraint</span></span> | <span data-ttu-id="f7739-1210">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-1210">Example</span></span> | <span data-ttu-id="f7739-1211">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="f7739-1211">Example Matches</span></span> | <span data-ttu-id="f7739-1212">Notas</span><span class="sxs-lookup"><span data-stu-id="f7739-1212">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="f7739-1213">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-1213">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-1214">Coincide con cualquier entero</span><span class="sxs-lookup"><span data-stu-id="f7739-1214">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="f7739-1215">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="f7739-1215">`true`, `FALSE`</span></span> | <span data-ttu-id="f7739-1216">Coincide con `true` o `false` (no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-1216">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="f7739-1217">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="f7739-1217">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="f7739-1218">Coincide con un valor `DateTime` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-1218">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="f7739-1219">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="f7739-1219">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="f7739-1220">Coincide con un valor `decimal` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-1220">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="f7739-1221">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-1221">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-1222">Coincide con un valor `double` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-1222">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="f7739-1223">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="f7739-1223">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="f7739-1224">Coincide con un valor `float` válido (en la referencia cultural invariable; vea la advertencia)</span><span class="sxs-lookup"><span data-stu-id="f7739-1224">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="f7739-1225">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="f7739-1225">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="f7739-1226">Coincide con un valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-1226">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="f7739-1227">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="f7739-1227">`123456789`, `-123456789`</span></span> | <span data-ttu-id="f7739-1228">Coincide con un valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="f7739-1228">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="f7739-1229">La cadena debe tener al menos cuatro caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-1229">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="f7739-1230">La cadena no debe tener más de ocho caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-1230">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="f7739-1231">La cadena debe tener una longitud de exactamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="f7739-1231">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="f7739-1232">La cadena debe tener una longitud como mínimo de ocho caracteres y como máximo de 16</span><span class="sxs-lookup"><span data-stu-id="f7739-1232">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="f7739-1233">El valor entero debe ser como mínimo 18</span><span class="sxs-lookup"><span data-stu-id="f7739-1233">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="f7739-1234">El valor entero debe ser como máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-1234">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="f7739-1235">El valor entero debe ser como mínimo 18 y máximo 120</span><span class="sxs-lookup"><span data-stu-id="f7739-1235">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="f7739-1236">La cadena debe constar de uno o más caracteres alfabéticos (`a`-`z`, no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="f7739-1236">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="f7739-1237">La cadena debe coincidir con la expresión regular (vea las sugerencias sobre cómo definir una expresión regular)</span><span class="sxs-lookup"><span data-stu-id="f7739-1237">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="f7739-1238">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="f7739-1238">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="f7739-1239">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="f7739-1239">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="f7739-1240">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="f7739-1240">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="f7739-1241">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR (como `int` o `DateTime`) usan siempre la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="f7739-1241">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="f7739-1242">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="f7739-1242">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="f7739-1243">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1243">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="f7739-1244">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="f7739-1244">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="f7739-1245">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="f7739-1245">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="f7739-1246">Expresiones regulares</span><span class="sxs-lookup"><span data-stu-id="f7739-1246">Regular expressions</span></span>

<span data-ttu-id="f7739-1247">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-1247">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="f7739-1248">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="f7739-1248">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="f7739-1249">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="f7739-1249">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="f7739-1250">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-1250">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="f7739-1251">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en el enrutamiento, los caracteres `\` (una barra diagonal inversa) de la cadena se deben proporcionar como caracteres `\\` (barra diagonal inversa doble) en el archivo de código fuente de C# para que el carácter de escape de cadena `\` tenga una secuencia de escape (a menos que se usen [literales de cadena textuales](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="f7739-1251">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="f7739-1252">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento (`{`, `}`, `[` y `]`), duplique los caracteres en la expresión (`{{`, `}`, `[[` y `]]`).</span><span class="sxs-lookup"><span data-stu-id="f7739-1252">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="f7739-1253">En la tabla siguiente se muestra una expresión regular y la versión con la secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="f7739-1253">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="f7739-1254">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="f7739-1254">Regular Expression</span></span>    | <span data-ttu-id="f7739-1255">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="f7739-1255">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="f7739-1256">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter de acento circunflejo (`^`) y coinciden con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-1256">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="f7739-1257">Las expresiones suelen terminar con el carácter del signo de dólar (`$`) y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="f7739-1257">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="f7739-1258">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1258">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="f7739-1259">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, algo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="f7739-1259">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="f7739-1260">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no.</span><span class="sxs-lookup"><span data-stu-id="f7739-1260">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="f7739-1261">Expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-1261">Expression</span></span>   | <span data-ttu-id="f7739-1262">String</span><span class="sxs-lookup"><span data-stu-id="f7739-1262">String</span></span>    | <span data-ttu-id="f7739-1263">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="f7739-1263">Match</span></span> | <span data-ttu-id="f7739-1264">Comentario</span><span class="sxs-lookup"><span data-stu-id="f7739-1264">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="f7739-1265">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-1265">hello</span></span>     | <span data-ttu-id="f7739-1266">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-1266">Yes</span></span>   | <span data-ttu-id="f7739-1267">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-1267">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-1268">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-1268">123abc456</span></span> | <span data-ttu-id="f7739-1269">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-1269">Yes</span></span>   | <span data-ttu-id="f7739-1270">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="f7739-1270">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="f7739-1271">mz</span><span class="sxs-lookup"><span data-stu-id="f7739-1271">mz</span></span>        | <span data-ttu-id="f7739-1272">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-1272">Yes</span></span>   | <span data-ttu-id="f7739-1273">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="f7739-1273">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="f7739-1274">MZ</span><span class="sxs-lookup"><span data-stu-id="f7739-1274">MZ</span></span>        | <span data-ttu-id="f7739-1275">Sí</span><span class="sxs-lookup"><span data-stu-id="f7739-1275">Yes</span></span>   | <span data-ttu-id="f7739-1276">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="f7739-1276">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-1277">hello</span><span class="sxs-lookup"><span data-stu-id="f7739-1277">hello</span></span>     | <span data-ttu-id="f7739-1278">No</span><span class="sxs-lookup"><span data-stu-id="f7739-1278">No</span></span>    | <span data-ttu-id="f7739-1279">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-1279">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="f7739-1280">123abc456</span><span class="sxs-lookup"><span data-stu-id="f7739-1280">123abc456</span></span> | <span data-ttu-id="f7739-1281">No</span><span class="sxs-lookup"><span data-stu-id="f7739-1281">No</span></span>    | <span data-ttu-id="f7739-1282">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="f7739-1282">See `^` and `$` above</span></span> |

<span data-ttu-id="f7739-1283">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="f7739-1283">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="f7739-1284">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="f7739-1284">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="f7739-1285">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1285">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="f7739-1286">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="f7739-1286">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="f7739-1287">Las restricciones que se pasan al diccionario de restricciones (no insertado en una plantilla) que no coinciden con una de las restricciones conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="f7739-1287">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="f7739-1288">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="f7739-1288">Custom Route Constraints</span></span>

<span data-ttu-id="f7739-1289">Además de las restricciones de ruta integradas, se pueden crear restricciones de ruta personalizadas implementando la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1289">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="f7739-1290">La interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contiene un único método, `Match`, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="f7739-1290">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="f7739-1291">Para utilizar una restricción <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, el tipo de restricción de ruta debe registrarse con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7739-1291">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="f7739-1292"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> es un diccionario que asigna claves de restricciones de ruta a implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="f7739-1292">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="f7739-1293">El parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1293">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="f7739-1294">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-1294">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="f7739-1295">La restricción puede aplicarse a las rutas de la manera habitual, usando el nombre especificado al registrar el tipo de restricción.</span><span class="sxs-lookup"><span data-stu-id="f7739-1295">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="f7739-1296">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f7739-1296">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="f7739-1297">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="f7739-1297">URL generation reference</span></span>

<span data-ttu-id="f7739-1298">En el ejemplo siguiente se muestra cómo se genera un vínculo a una ruta, dado un diccionario de valores de ruta y un valor <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="f7739-1298">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="f7739-1299">El valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generado al final del ejemplo anterior es `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1299">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="f7739-1300">El diccionario proporciona los valores de ruta `operation` e `id` de la plantilla "Ruta de paquete de seguimiento", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1300">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="f7739-1301">Para obtener más información, vea el código de ejemplo de la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware) o la [aplicación de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="f7739-1301">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="f7739-1302">El segundo parámetro del constructor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> es una colección de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="f7739-1302">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="f7739-1303">Los valores de ambiente son adecuados porque limitan el número de valores que el desarrollador debe especificar dentro de un contexto de solicitud.</span><span class="sxs-lookup"><span data-stu-id="f7739-1303">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="f7739-1304">Los valores de ruta actuales de la solicitud actual se consideran valores de ambiente para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1304">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="f7739-1305">En la acción `About` de `HomeController` de una aplicación ASP.NET Core MVC, no es necesario especificar el valor de ruta de controlador para vincular a la acción `Index` (se usará el valor de ambiente `Home`).</span><span class="sxs-lookup"><span data-stu-id="f7739-1305">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="f7739-1306">Los valores de ambiente que no coincidan con un parámetro se omiten.</span><span class="sxs-lookup"><span data-stu-id="f7739-1306">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="f7739-1307">También se omiten los valores de ambiente cuando un valor proporcionado de forma explícita invalida el valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="f7739-1307">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="f7739-1308">La coincidencia se produce de izquierda a derecha en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="f7739-1308">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="f7739-1309">Los valores que se proporcionan de forma explícita pero que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="f7739-1309">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="f7739-1310">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1310">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="f7739-1311">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="f7739-1311">Ambient Values</span></span>                     | <span data-ttu-id="f7739-1312">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="f7739-1312">Explicit Values</span></span>                        | <span data-ttu-id="f7739-1313">Resultado</span><span class="sxs-lookup"><span data-stu-id="f7739-1313">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="f7739-1314">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-1314">controller = "Home"</span></span>                | <span data-ttu-id="f7739-1315">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-1315">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-1316">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-1316">controller = "Home"</span></span>                | <span data-ttu-id="f7739-1317">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-1317">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="f7739-1318">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-1318">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="f7739-1319">action = "About"</span><span class="sxs-lookup"><span data-stu-id="f7739-1319">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="f7739-1320">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="f7739-1320">controller = "Home"</span></span>                | <span data-ttu-id="f7739-1321">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="f7739-1321">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="f7739-1322">Si una ruta tiene un valor predeterminado que no se corresponde con un parámetro y ese valor se proporciona de forma explícita, debe coincidir con el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="f7739-1322">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="f7739-1323">La generación de vínculos solo genera un vínculo para esta ruta si se proporcionan los valores coincidentes para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="f7739-1323">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="f7739-1324">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="f7739-1324">Complex segments</span></span>

<span data-ttu-id="f7739-1325">Los segmentos complejos (por ejemplo, `[Route("/x{token}y")]`), se procesan buscando coincidencias de literales de derecha a izquierda de un modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="f7739-1325">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="f7739-1326">Consulte [este código](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para obtener una explicación detallada de cómo se comparan los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1326">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="f7739-1327">El [código de ejemplo](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) no se usa en ASP.NET Core, pero proporciona una buena explicación de los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="f7739-1327">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end
