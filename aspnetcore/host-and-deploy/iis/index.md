---
title: Hospedaje de ASP.NET Core en Windows con IIS
author: guardrex
description: Obtenga información sobre cómo hospedar aplicaciones de ASP.NET Core en Windows Server Internet Information Services (IIS).
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 01/13/2020
uid: host-and-deploy/iis/index
ms.openlocfilehash: 146a204509856186a2696b770cae2249d348fa34
ms.sourcegitcommit: eca76bd065eb94386165a0269f1e95092f23fa58
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2020
ms.locfileid: "76726838"
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="1a1ab-103">Hospedaje de ASP.NET Core en Windows con IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-103">Host ASP.NET Core on Windows with IIS</span></span>

<span data-ttu-id="1a1ab-104">Por [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="1a1ab-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="1a1ab-105">Para obtener una experiencia de tutorial en la publicación de una aplicación de ASP.NET Core en un servidor IIS, vea <xref:tutorials/publish-to-iis>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-105">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="1a1ab-106">Instalación del conjunto de hospedaje de .NET Core</span><span class="sxs-lookup"><span data-stu-id="1a1ab-106">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="1a1ab-107">Sistemas operativos admitidos</span><span class="sxs-lookup"><span data-stu-id="1a1ab-107">Supported operating systems</span></span>

<span data-ttu-id="1a1ab-108">Los siguientes sistemas operativos son compatibles:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-108">The following operating systems are supported:</span></span>

::: moniker range=">= aspnetcore-3.0"

* <span data-ttu-id="1a1ab-109">Windows 7 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-109">Windows 7 or later</span></span>
* <span data-ttu-id="1a1ab-110">Windows Server 2012 R2 o versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="1a1ab-110">Windows Server 2012 R2 or later</span></span>

::: moniker-end

::: moniker range="< aspnetcore-3.0"

* <span data-ttu-id="1a1ab-111">Windows 7 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-111">Windows 7 or later</span></span>
* <span data-ttu-id="1a1ab-112">Windows Server 2008 R2 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-112">Windows Server 2008 R2 or later</span></span>

::: moniker-end

<span data-ttu-id="1a1ab-113">El [servidor HTTP.sys](xref:fundamentals/servers/httpsys) (anteriormente denominado WebListener) no funciona en una configuración de proxy inverso con IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-113">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="1a1ab-114">Use el [servidor Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-114">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="1a1ab-115">Para obtener información sobre el hospedaje en Azure, vea <xref:host-and-deploy/azure-apps/index>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-115">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="1a1ab-116">Para obtener instrucciones de solución de problemas, vea <xref:test/troubleshoot>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-116">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="1a1ab-117">Plataformas compatibles</span><span class="sxs-lookup"><span data-stu-id="1a1ab-117">Supported platforms</span></span>

<span data-ttu-id="1a1ab-118">Se admiten las aplicaciones publicadas para implementaciones de 32 bits (x86) y 64 bits (x64).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-118">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="1a1ab-119">Implemente una aplicación de 32 bits con un SDK de .NET Core de 32 bits (x86) a menos que la aplicación:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-119">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="1a1ab-120">Requiera el espacio de direcciones de memoria virtual más grande disponible para una aplicación de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-120">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="1a1ab-121">Requiera el tamaño de la pila IIS más grande.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-121">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="1a1ab-122">Tenga dependencias nativas de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-122">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="1a1ab-123">Use un SDK de .NET Core de 64 bits (x64) para publicar una aplicación de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-123">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="1a1ab-124">Debe haber un tiempo de ejecución de 64 bits en el sistema host.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-124">A 64-bit runtime must be present on the host system.</span></span>

::: moniker range=">= aspnetcore-2.2"

## <a name="hosting-models"></a><span data-ttu-id="1a1ab-125">Modelos de hospedaje</span><span class="sxs-lookup"><span data-stu-id="1a1ab-125">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="1a1ab-126">Modelo de hospedaje en proceso</span><span class="sxs-lookup"><span data-stu-id="1a1ab-126">In-process hosting model</span></span>

<span data-ttu-id="1a1ab-127">Con el hospedaje en proceso, una aplicación ASP.NET Core se ejecuta en el mismo proceso que su proceso de trabajo de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-127">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="1a1ab-128">El hospedaje en proceso proporciona un rendimiento mejorado con respecto al hospedaje fuera de proceso porque las solicitudes no se realizan mediante proxy en el adaptador de bucle invertido, una interfaz de red que devuelve el tráfico saliente a la misma máquina.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-128">In-process hosting provides improved performance over out-of-process hosting because requests aren't proxied over the loopback adapter, a network interface that returns outgoing network traffic back to the same machine.</span></span> <span data-ttu-id="1a1ab-129">IIS controla la administración de procesos con el [Servicio de activación de procesos de Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-129">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="1a1ab-130">El [módulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="1a1ab-130">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="1a1ab-131">Realiza la inicialización de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-131">Performs app initialization.</span></span>
  * <span data-ttu-id="1a1ab-132">Carga [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-132">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="1a1ab-133">Llama a `Program.Main`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-133">Calls `Program.Main`.</span></span>
* <span data-ttu-id="1a1ab-134">Controla la duración de la solicitud nativa de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-134">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="1a1ab-135">No se admite el modelo de hospedaje en proceso para aplicaciones de ASP.NET Core que tienen como destino .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-135">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="1a1ab-136">En el siguiente diagrama se muestra la relación entre IIS, el módulo ASP.NET Core y una aplicación hospedada en proceso:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-136">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![Módulo ASP.NET Core en el escenario de hospedaje dentro de proceso](index/_static/ancm-inprocess.png)

<span data-ttu-id="1a1ab-138">Una solicitud llega de Internet al controlador HTTP.sys en modo kernel.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-138">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="1a1ab-139">El controlador enruta la solicitud nativa a IIS en el puerto configurado del sitio web, que suele ser el puerto 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-139">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="1a1ab-140">El módulo ASP.NET Core recibe la solicitud nativa y la pasa a IIS HTTP Server (`IISHttpServer`).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-140">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="1a1ab-141">El servidor HTTP de IIS es una implementación de servidor en proceso para IIS que convierte una solicitud nativa en administrada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-141">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="1a1ab-142">Una vez que IIS HTTP Server procesa la solicitud, la envía a la canalización de middleware de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-142">After the IIS HTTP Server processes the request, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="1a1ab-143">La canalización de middleware controla la solicitud y la pasa como una instancia de `HttpContext` a la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-143">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="1a1ab-144">La respuesta de la aplicación se pasa a IIS a través del servidor HTTP de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-144">The app's response is passed back to IIS through IIS HTTP Server.</span></span> <span data-ttu-id="1a1ab-145">IIS envía la respuesta al cliente que inició la solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-145">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="1a1ab-146">El hospedaje en proceso es opcional para las aplicaciones existentes, pero, para las plantillas [dotnet new](/dotnet/core/tools/dotnet-new), este modelo es el predeterminado para todos los escenarios de IIS e IIS Express.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-146">In-process hosting is opt-in for existing apps, but [dotnet new](/dotnet/core/tools/dotnet-new) templates default to the in-process hosting model for all IIS and IIS Express scenarios.</span></span>

<span data-ttu-id="1a1ab-147">`CreateDefaultBuilder` agrega una instancia <xref:Microsoft.AspNetCore.Hosting.Server.IServer> mediante una llamada al método <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> para iniciar [CoreCLR](/dotnet/standard/glossary#coreclr) y hospedar la aplicación dentro del proceso de trabajo de IIS (*w3wp.exe* o *iisexpress.exe*).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-147">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (*w3wp.exe* or *iisexpress.exe*).</span></span> <span data-ttu-id="1a1ab-148">Las pruebas de rendimiento indican que el hospedaje de una aplicación .NET Core en proceso proporciona un rendimiento de solicitud considerablemente mayor en comparación con el hospedaje de solicitudes de aplicaciones fuera de proceso y de proxy para el servidor [Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-148">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

::: moniker-end

::: moniker range=">= aspnetcore-3.0"

> [!NOTE]
> <span data-ttu-id="1a1ab-149">Las aplicaciones publicadas como un único archivo ejecutable no se pueden cargar por el modelo de hospedaje en proceso.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-149">Apps published as a single file executable can't be loaded by the in-process hosting model.</span></span>

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="1a1ab-150">Modelo de hospedaje fuera de proceso</span><span class="sxs-lookup"><span data-stu-id="1a1ab-150">Out-of-process hosting model</span></span>

<span data-ttu-id="1a1ab-151">Dado que las aplicaciones ASP.NET Core se ejecutan en un proceso independiente del proceso de trabajo de IIS, el módulo ASP.NET Core se encarga de la administración de procesos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-151">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="1a1ab-152">El módulo inicia el proceso de la aplicación ASP.NET Core cuando entra la primera solicitud y reinicia la aplicación si esta se apaga o se bloquea.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-152">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="1a1ab-153">Este comportamiento es básicamente el mismo que el de las aplicaciones que se ejecutan en proceso y se administran a través del [Servicio de activación de procesos de Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-153">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="1a1ab-154">En el siguiente diagrama se muestra la relación entre IIS, el módulo ASP.NET Core y una aplicación hospedada fuera de proceso:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-154">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Módulo ASP.NET Core en el escenario de hospedaje fuera de proceso](index/_static/ancm-outofprocess.png)

<span data-ttu-id="1a1ab-156">Las solicitudes llegan procedentes de Internet al controlador HTTP.sys en modo kernel.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-156">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="1a1ab-157">El controlador enruta las solicitudes a IIS en el puerto configurado del sitio web, que suele ser el puerto 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-157">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="1a1ab-158">El módulo reenvía las solicitudes a Kestrel en un puerto aleatorio de la aplicación, que no es ni 80 ni 443.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-158">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="1a1ab-159">El módulo especifica el puerto a través de la variable de entorno en el inicio, y la extensión <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> configura el servidor para que escuche en `http://localhost:{PORT}`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-159">The module specifies the port via an environment variable at startup, and the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="1a1ab-160">Se realizan más comprobaciones y se rechazan las solicitudes que no se hayan originado en el módulo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-160">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="1a1ab-161">El módulo no admite el reenvío de HTTPS, por lo que las solicitudes se reenvían a través de HTTP, aunque IIS las reciba a través de HTTPS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-161">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="1a1ab-162">Una vez que Kestrel toma la solicitud del módulo, la envía a la canalización de middleware de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-162">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="1a1ab-163">La canalización de middleware controla la solicitud y la pasa como una instancia de `HttpContext` a la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-163">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="1a1ab-164">El middleware agregado por la integración de IIS actualiza el esquema, la dirección IP remota y PathBase para responder del reenvío de la solicitud a Kestrel.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-164">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="1a1ab-165">La respuesta de la aplicación se vuelve a pasar a IIS, que la envía de nuevo al cliente HTTP que inició la solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-165">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="1a1ab-166">ASP.NET Core se distribuye con el [servidor Kestrel](xref:fundamentals/servers/kestrel), un servidor HTTP multiplataforma predeterminado.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-166">ASP.NET Core ships with [Kestrel server](xref:fundamentals/servers/kestrel), a default, cross-platform HTTP server.</span></span>

<span data-ttu-id="1a1ab-167">Al usar [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) o [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), la aplicación se ejecuta en un proceso distinto al del proceso de trabajo de IIS (*fuera de proceso*) con el [servidor Kestrel](xref:fundamentals/servers/index#kestrel).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-167">When using [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) or [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), the app runs in a process separate from the IIS worker process (*out-of-process*) with the [Kestrel server](xref:fundamentals/servers/index#kestrel).</span></span>

<span data-ttu-id="1a1ab-168">Dado que las aplicaciones ASP.NET Core se ejecutan en un proceso independiente del proceso de trabajo de IIS, el módulo se encarga de la administración de procesos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-168">Because ASP.NET Core apps run in a process separate from the IIS worker process, the module handles process management.</span></span> <span data-ttu-id="1a1ab-169">El módulo inicia el proceso de la aplicación ASP.NET Core cuando entra la primera solicitud y reinicia la aplicación si esta se apaga o se bloquea.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-169">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="1a1ab-170">Este comportamiento es básicamente el mismo que el de las aplicaciones que se ejecutan en proceso y se administran a través del [Servicio de activación de procesos de Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-170">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="1a1ab-171">En el siguiente diagrama se muestra la relación entre IIS, el módulo ASP.NET Core y una aplicación hospedada fuera de proceso:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-171">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Módulo ASP.NET Core](index/_static/ancm-outofprocess.png)

<span data-ttu-id="1a1ab-173">Las solicitudes llegan procedentes de Internet al controlador HTTP.sys en modo kernel.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-173">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="1a1ab-174">El controlador enruta las solicitudes a IIS en el puerto configurado del sitio web, que suele ser el puerto 80 (HTTP) o 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-174">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="1a1ab-175">El módulo reenvía las solicitudes a Kestrel en un puerto aleatorio de la aplicación, que no es ni 80 ni 443.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-175">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="1a1ab-176">El módulo especifica el puerto a través de la variable de entorno en el inicio, y el [middleware de integración de IIS](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configura el servidor para que escuche en `http://localhost:{port}`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-176">The module specifies the port via an environment variable at startup, and the [IIS Integration Middleware](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="1a1ab-177">Se realizan más comprobaciones y se rechazan las solicitudes que no se hayan originado en el módulo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-177">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="1a1ab-178">El módulo no admite el reenvío de HTTPS, por lo que las solicitudes se reenvían a través de HTTP, aunque IIS las reciba a través de HTTPS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-178">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="1a1ab-179">Una vez que Kestrel toma la solicitud del módulo, la envía a la canalización de middleware de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-179">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="1a1ab-180">La canalización de middleware controla la solicitud y la pasa como una instancia de `HttpContext` a la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-180">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="1a1ab-181">El middleware agregado por la integración de IIS actualiza el esquema, la dirección IP remota y PathBase para responder del reenvío de la solicitud a Kestrel.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-181">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="1a1ab-182">La respuesta de la aplicación se vuelve a pasar a IIS, que la envía de nuevo al cliente HTTP que inició la solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-182">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="1a1ab-183">`CreateDefaultBuilder` configura el servidor [Kestrel](xref:fundamentals/servers/kestrel) como servidor web y habilita IIS Integration mediante la configuración de la ruta de acceso y el puerto base para el [módulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-183">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="1a1ab-184">El módulo ASP.NET Core genera un puerto dinámico que se asigna al proceso back-end.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-184">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="1a1ab-185">`CreateDefaultBuilder` llama al método <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-185">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="1a1ab-186">`UseIISIntegration` configura Kestrel para escuchar en el puerto dinámico en la dirección IP de localhost (`127.0.0.1`).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-186">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="1a1ab-187">Si el puerto dinámico es 1234, Kestrel escucha en `127.0.0.1:1234`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-187">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="1a1ab-188">Esta configuración reemplaza a otras configuraciones de dirección URL proporcionadas por:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-188">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="1a1ab-189">API de escucha de Kestrel</span><span class="sxs-lookup"><span data-stu-id="1a1ab-189">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="1a1ab-190">[Configuración](xref:fundamentals/configuration/index) (u [opción --urls de la línea de comandos](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="1a1ab-190">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="1a1ab-191">No es necesario realizar llamadas a `UseUrls` o a la API `Listen` de Kestrel cuando se usa el módulo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-191">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="1a1ab-192">Si se llama a `UseUrls` o `Listen`, Kestrel escucha en el puerto especificado cuando se ejecuta la aplicación sin IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-192">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

::: moniker-end

<span data-ttu-id="1a1ab-193">Para obtener instrucciones sobre la configuración del módulo ASP.NET Core, vea <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-193">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="1a1ab-194">Para obtener más información sobre el hospedaje, consulte [Hospedaje en ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-194">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="1a1ab-195">Configuración de aplicación</span><span class="sxs-lookup"><span data-stu-id="1a1ab-195">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="1a1ab-196">Habilitación de los componentes de integración con IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-196">Enable the IISIntegration components</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="1a1ab-197">Al compilar un host en `CreateHostBuilder` (*Program.cs*), llame a <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder*> para permitir la integración de IIS:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-197">When building a host in `CreateHostBuilder` (*Program.cs*), call <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder*> to enable IIS integration:</span></span>

```csharp
public static IHostBuilder CreateHostBuilder(string[] args) =>
    Host.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="1a1ab-198">Para más información sobre `CreateDefaultBuilder`, consulte <xref:fundamentals/host/generic-host#default-builder-settings>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-198">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/generic-host#default-builder-settings>.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-3.0"

<span data-ttu-id="1a1ab-199">Al compilar un host en `CreateWebHostBuilder` (*Program.cs*), llame a <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> para permitir la integración de IIS:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-199">When building a host in `CreateWebHostBuilder` (*Program.cs*), call <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to enable IIS integration:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="1a1ab-200">Para más información sobre `CreateDefaultBuilder`, consulte <xref:fundamentals/host/web-host#set-up-a-host>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-200">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/web-host#set-up-a-host>.</span></span>

::: moniker-end

### <a name="iis-options"></a><span data-ttu-id="1a1ab-201">Opciones de IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-201">IIS options</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="1a1ab-202">**Modelo de hospedaje en proceso**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-202">**In-process hosting model**</span></span>

<span data-ttu-id="1a1ab-203">Para configurar las opciones del servidor de IIS, incluya una configuración de servicio para <xref:Microsoft.AspNetCore.Builder.IISServerOptions> en <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-203">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="1a1ab-204">Con el ejemplo siguiente se deshabilita AutomaticAuthentication:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-204">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

::: moniker-end

::: moniker range=">= aspnetcore-3.0"

| <span data-ttu-id="1a1ab-205">Opción</span><span class="sxs-lookup"><span data-stu-id="1a1ab-205">Option</span></span>                         | <span data-ttu-id="1a1ab-206">Default</span><span class="sxs-lookup"><span data-stu-id="1a1ab-206">Default</span></span> | <span data-ttu-id="1a1ab-207">Parámetro</span><span class="sxs-lookup"><span data-stu-id="1a1ab-207">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="1a1ab-208">Si es `true`, el servidor IIS establece el `HttpContext.User` autenticado mediante la [autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-208">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="1a1ab-209">Si es `false`, el servidor solo proporciona una identidad para `HttpContext.User` y responde a los desafíos cuando se le solicita explícitamente mediante el `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-209">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="1a1ab-210">Autenticación de Windows debe estar habilitado en IIS para que `AutomaticAuthentication` funcione.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-210">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="1a1ab-211">Para obtener más información, vea [Autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-211">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="1a1ab-212">Establece el nombre para mostrar que se muestra a los usuarios en las páginas de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-212">Sets the display name shown to users on login pages.</span></span> |
| `AllowSynchronousIO`           | `false` | <span data-ttu-id="1a1ab-213">Si se permiten la E/S sincrónica para `HttpContext.Request` y `HttpContext.Response`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-213">Whether synchronous IO is allowed for the `HttpContext.Request` and the `HttpContext.Response`.</span></span> |
| `MaxRequestBodySize`           | `30000000`  | <span data-ttu-id="1a1ab-214">Obtiene o establece el tamaño máximo del cuerpo de solicitud para `HttpRequest`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-214">Gets or sets the max request body size for the `HttpRequest`.</span></span> <span data-ttu-id="1a1ab-215">Tenga en cuenta que el propio IIS tiene el límite de `maxAllowedContentLength`, que se procesará antes que el valor de `MaxRequestBodySize` establecido en `IISServerOptions`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-215">Note that IIS itself has the limit `maxAllowedContentLength` which will be processed before the `MaxRequestBodySize` set in the `IISServerOptions`.</span></span> <span data-ttu-id="1a1ab-216">El cambio de `MaxRequestBodySize` no afectará a `maxAllowedContentLength`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-216">Changing the `MaxRequestBodySize` won't affect the `maxAllowedContentLength`.</span></span> <span data-ttu-id="1a1ab-217">Para aumentar `maxAllowedContentLength`, agregue una entrada al archivo *web.config* para establecer `maxAllowedContentLength` en un valor superior.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-217">To increase `maxAllowedContentLength`, add an entry in the *web.config* to set `maxAllowedContentLength` to a higher value.</span></span> <span data-ttu-id="1a1ab-218">Para más información, consulte [Configuración](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-218">For more details, see [Configuration](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span></span> |

<span data-ttu-id="1a1ab-219">**Modelo de hospedaje fuera de proceso**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-219">**Out-of-process hosting model**</span></span>

::: moniker-end

::: moniker range="< aspnetcore-3.0"

| <span data-ttu-id="1a1ab-220">Opción</span><span class="sxs-lookup"><span data-stu-id="1a1ab-220">Option</span></span>                         | <span data-ttu-id="1a1ab-221">Default</span><span class="sxs-lookup"><span data-stu-id="1a1ab-221">Default</span></span> | <span data-ttu-id="1a1ab-222">Parámetro</span><span class="sxs-lookup"><span data-stu-id="1a1ab-222">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="1a1ab-223">Si es `true`, el servidor IIS establece el `HttpContext.User` autenticado mediante la [autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-223">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="1a1ab-224">Si es `false`, el servidor solo proporciona una identidad para `HttpContext.User` y responde a los desafíos cuando se le solicita explícitamente mediante el `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-224">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="1a1ab-225">Autenticación de Windows debe estar habilitado en IIS para que `AutomaticAuthentication` funcione.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-225">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="1a1ab-226">Para obtener más información, vea [Autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-226">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="1a1ab-227">Establece el nombre para mostrar que se muestra a los usuarios en las páginas de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-227">Sets the display name shown to users on login pages.</span></span> |

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="1a1ab-228">**Modelo de hospedaje fuera de proceso**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-228">**Out-of-process hosting model**</span></span>

::: moniker-end

<span data-ttu-id="1a1ab-229">Para configurar las opciones de IIS, incluya una configuración de servicio para <xref:Microsoft.AspNetCore.Builder.IISOptions> en <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-229">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="1a1ab-230">En el ejemplo siguiente se impide que la aplicación rellene `HttpContext.Connection.ClientCertificate`:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-230">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="1a1ab-231">Opción</span><span class="sxs-lookup"><span data-stu-id="1a1ab-231">Option</span></span>                         | <span data-ttu-id="1a1ab-232">Default</span><span class="sxs-lookup"><span data-stu-id="1a1ab-232">Default</span></span> | <span data-ttu-id="1a1ab-233">Parámetro</span><span class="sxs-lookup"><span data-stu-id="1a1ab-233">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="1a1ab-234">Si es `true`, el [middleware de integración con IIS](#enable-the-iisintegration-components) establece el `HttpContext.User` autenticado mediante [autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-234">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="1a1ab-235">Si es `false`, el middleware solo proporciona una identidad para `HttpContext.User` y responde a los desafíos cuando se le solicita explícitamente mediante el `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-235">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="1a1ab-236">Autenticación de Windows debe estar habilitado en IIS para que `AutomaticAuthentication` funcione.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-236">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="1a1ab-237">Para más información, consulte el tema [Autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-237">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="1a1ab-238">Establece el nombre para mostrar que se muestra a los usuarios en las páginas de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-238">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="1a1ab-239">Si `HttpContext.Connection.ClientCertificate` y el encabezado de solicitud `true` está presente, se rellena `MS-ASPNETCORE-CLIENTCERT`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-239">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="1a1ab-240">Escenarios de servidor proxy y equilibrador de carga</span><span class="sxs-lookup"><span data-stu-id="1a1ab-240">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="1a1ab-241">El [middleware de integración con IIS](#enable-the-iisintegration-components), que configura el software intermedio de encabezados reenviados, y el módulo de ASP.NET Core están configurados para reenviar el esquema (HTTP/HTTPS) y la dirección IP remota donde se originó la solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-241">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="1a1ab-242">Podría ser necesario realizar una configuración adicional para las aplicaciones hospedadas detrás de servidores proxy y equilibradores de carga adicionales.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-242">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="1a1ab-243">Para más información, vea [Configurar ASP.NET Core para trabajar con servidores proxy y equilibradores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-243">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="1a1ab-244">Archivo web.config</span><span class="sxs-lookup"><span data-stu-id="1a1ab-244">web.config file</span></span>

<span data-ttu-id="1a1ab-245">El archivo *web.config* configura el [módulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-245">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="1a1ab-246">La creación, transformación y publicación del archivo *web.config* se controla por medio de un destino de MSBuild (`_TransformWebConfig`) cuando el proyecto se publica.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-246">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="1a1ab-247">Este destino está incluido entre los destinos del SDK web (`Microsoft.NET.Sdk.Web`).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-247">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="1a1ab-248">El SDK se establece al inicio del archivo del proyecto:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-248">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="1a1ab-249">Si el proyecto no incluye un archivo *web.config*, el archivo se crea con los elementos *processPath* y *arguments* correctos para configurar el módulo ASP.NET Core y se mueve a la [salida publicada](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-249">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="1a1ab-250">Si el proyecto incluye un archivo *web.config*, el archivo se transforma con los elementos *processPath* y *arguments* correctos para configurar el módulo ASP.NET Core y se mueve a la salida publicada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-250">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="1a1ab-251">La transformación no modifica los valores de configuración de IIS del archivo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-251">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="1a1ab-252">El archivo *web.config* puede proporcionar valores de configuración de IIS adicionales que controlan los módulos activos de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-252">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="1a1ab-253">Para información sobre los módulos de IIS que son capaces de procesar las solicitudes con aplicaciones ASP.NET Core, vea el tema [Módulos IIS](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-253">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="1a1ab-254">Para evitar que el SDK web transforme el archivo *web.config*, use la propiedad **\<IsTransformWebConfigDisabled>** en el archivo del proyecto:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-254">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="1a1ab-255">Al deshabilitar el SDK web para la transformación del archivo, el desarrollador debe establecer el elemento *processPath* y los *argumentos* manualmente.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-255">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="1a1ab-256">Para obtener más información, vea <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-256">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="1a1ab-257">Ubicación del archivo web.config</span><span class="sxs-lookup"><span data-stu-id="1a1ab-257">web.config file location</span></span>

<span data-ttu-id="1a1ab-258">Para configurar el [módulo ASP.NET](xref:host-and-deploy/aspnet-core-module) correctamente, el archivo *web.config* debe estar presente en la ruta [raíz de contenido](xref:fundamentals/index#content-root) (normalmente la ruta de acceso base de la aplicación) de la aplicación implementada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-258">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="1a1ab-259">Se trata de la misma ubicación que la ruta de acceso física del sitio web proporcionada a IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-259">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="1a1ab-260">El archivo *web.config* debe estar en la raíz de la aplicación para habilitar la publicación de varias aplicaciones mediante Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-260">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="1a1ab-261">Los archivos confidenciales están en la ruta de acceso física de la aplicación, como *\<ensamblado>.runtimeconfig.json*, *\<ensamblado>.xml* (comentarios de documentación XML) y *\<ensamblado>.deps.json*.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-261">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="1a1ab-262">Si el archivo *web.config* está presente y el sitio se inicia normalmente, IIS no facilita estos archivos confidenciales, en el caso de que se soliciten.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-262">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="1a1ab-263">Si el archivo *web.config* no está presente, se le asignó un nombre incorrecto o no se puede configurar el sitio para un inicio normal, IIS puede servir archivos confidenciales públicamente.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-263">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="1a1ab-264">**El archivo *web.config* debe estar presente en la implementación en todo momento, se le debe asignar un nombre correcto y debe ser capaz de configurar el sitio para el inicio normal. Nunca quite el archivo *web.config* de una implementación de producción.**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-264">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="1a1ab-265">Transformación de web.config</span><span class="sxs-lookup"><span data-stu-id="1a1ab-265">Transform web.config</span></span>

<span data-ttu-id="1a1ab-266">Si necesita transformar *web.config* al realizar la publicación (por ejemplo, establecer variables de entorno basadas en la configuración, el perfil o el entorno), consulte <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-266">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="1a1ab-267">Configuración de IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-267">IIS configuration</span></span>

<span data-ttu-id="1a1ab-268">**Sistemas operativos de servidor Windows**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-268">**Windows Server operating systems**</span></span>

<span data-ttu-id="1a1ab-269">Habilite el rol de servidor **Servidor web (IIS)** y establezca los servicios de rol.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-269">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="1a1ab-270">Use el asistente **Agregar roles y características** del menú **Administrar** o el vínculo de **Administrador del servidor**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-270">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="1a1ab-271">En el paso **Roles de servidor**, active la casilla de **Servidor web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="1a1ab-271">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![El rol Servidor web (IIS) se activa en el paso Seleccionar roles de servidor.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="1a1ab-273">Después del paso **Características**, el paso **Servicios de rol** se carga para el servidor Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-273">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="1a1ab-274">Seleccione los servicios de rol IIS que quiera o acepte los servicios de rol predeterminados proporcionados.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-274">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Los servicios de rol predeterminados se activan en el paso Seleccionar servicios de rol.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="1a1ab-276">**Autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-276">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="1a1ab-277">Para habilitar Autenticación de Windows, expanda los nodos siguientes: **Servidor web** > **Seguridad**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-277">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="1a1ab-278">Seleccione la característica **Autenticación de Windows**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-278">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="1a1ab-279">Para más información, consulte [Windows Authentication \<windowsAuthentication >](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) (Autenticación de Windows <windowsAuthentication>) y [Configure Windows authentication](xref:security/authentication/windowsauth) (Configurar la autenticación de Windows).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-279">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="1a1ab-280">**WebSockets (opcional)**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-280">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="1a1ab-281">WebSockets es compatible con ASP.NET Core 1.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-281">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="1a1ab-282">Para habilitar WebSockets, expanda los nodos siguientes: **Servidor web** > **Desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-282">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="1a1ab-283">Seleccione la característica **Protocolo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-283">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="1a1ab-284">Para más información, vea [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-284">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="1a1ab-285">Continúe con el paso **Confirmación** para instalar el rol y los servicios de servidor web.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-285">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="1a1ab-286">No es necesario reiniciar el servidor ni IIS después de instalar el rol **Servidor web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="1a1ab-286">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="1a1ab-287">**Sistemas operativos de escritorio Windows**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-287">**Windows desktop operating systems**</span></span>

<span data-ttu-id="1a1ab-288">Habilite **Consola de administración de IIS** y **Servicios World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-288">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="1a1ab-289">Vaya a **Panel de control** > **Programas** > **Programas y características** > **Activar o desactivar las características de Windows** (lado izquierdo de la pantalla).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-289">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="1a1ab-290">Abra el nodo **Internet Information Services**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-290">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="1a1ab-291">Abra el nodo **Herramientas de administración web**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-291">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="1a1ab-292">Active la casilla de **Consola de administración de IIS**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-292">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="1a1ab-293">Active la casilla de **Servicios World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-293">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="1a1ab-294">Acepte las características predeterminadas de **Servicios World Wide Web** o personalice las características de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-294">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="1a1ab-295">**Autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-295">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="1a1ab-296">Para habilitar Autenticación de Windows, expanda los nodos siguientes: **Servicios World Wide Web** > **Seguridad**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-296">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="1a1ab-297">Seleccione la característica **Autenticación de Windows**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-297">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="1a1ab-298">Para más información, consulte [Windows Authentication \<windowsAuthentication >](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) (Autenticación de Windows <windowsAuthentication>) y [Configure Windows authentication](xref:security/authentication/windowsauth) (Configurar la autenticación de Windows).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-298">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="1a1ab-299">**WebSockets (opcional)**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-299">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="1a1ab-300">WebSockets es compatible con ASP.NET Core 1.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-300">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="1a1ab-301">Para habilitar WebSockets, expanda los nodos siguientes: **Servicios World Wide Web** > **Características de desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-301">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="1a1ab-302">Seleccione la característica **Protocolo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-302">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="1a1ab-303">Para más información, vea [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-303">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="1a1ab-304">Si la instalación de IIS requiere un reinicio, reinicie el sistema.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-304">If the IIS installation requires a restart, restart the system.</span></span>

![Consola de administración de IIS y Servicios World Wide Web se activan en Características de Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="1a1ab-306">Instalación del conjunto de hospedaje de .NET Core</span><span class="sxs-lookup"><span data-stu-id="1a1ab-306">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="1a1ab-307">Instale el *conjunto de hospedaje de .NET Core* en el sistema de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-307">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="1a1ab-308">El lote instala .NET Core Runtime, .NET Core Library y el [módulo ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-308">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="1a1ab-309">El módulo permite que las aplicaciones ASP.NET Core se ejecuten detrás de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-309">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1a1ab-310">Si el conjunto de hospedaje se instala antes que IIS, se debe reparar la instalación de dicho conjunto.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-310">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="1a1ab-311">Vuelva a ejecutar el instalador del conjunto de hospedaje después de instalar IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-311">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="1a1ab-312">Si el conjunto de hospedaje se instala después de hacer lo propio con la versión de 64 bits (x64) de .NET Core, es posible que los SDK no estén disponibles ([No se ha detectado ningún SDK de .NET Core](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-312">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="1a1ab-313">Para resolver el problema, consulte <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-313">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="direct-download-current-version"></a><span data-ttu-id="1a1ab-314">Descarga directa (versión actual)</span><span class="sxs-lookup"><span data-stu-id="1a1ab-314">Direct download (current version)</span></span>

<span data-ttu-id="1a1ab-315">Descargue al instalador mediante el vínculo siguiente:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-315">Download the installer using the following link:</span></span>

[<span data-ttu-id="1a1ab-316">Instalador del conjunto de hospedaje de .NET Core actual (descarga directa)</span><span class="sxs-lookup"><span data-stu-id="1a1ab-316">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://www.microsoft.com/net/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### <a name="earlier-versions-of-the-installer"></a><span data-ttu-id="1a1ab-317">Versiones anteriores del instalador</span><span class="sxs-lookup"><span data-stu-id="1a1ab-317">Earlier versions of the installer</span></span>

<span data-ttu-id="1a1ab-318">Para obtener una versión anterior del instalador:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-318">To obtain an earlier version of the installer:</span></span>

1. <span data-ttu-id="1a1ab-319">Vaya a los [archivos de descarga de .NET](https://www.microsoft.com/net/download/archives).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-319">Navigate to the [.NET download archives](https://www.microsoft.com/net/download/archives).</span></span>
1. <span data-ttu-id="1a1ab-320">En **.NET Core**, seleccione la versión de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-320">Under **.NET Core**, select the .NET Core version.</span></span>
1. <span data-ttu-id="1a1ab-321">En la columna **Run apps - Runtime** (Ejecutar aplicaciones - Runtime), busque la fila de la versión del runtime de .NET Core que quiera instalar.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-321">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="1a1ab-322">Descargue el instalador mediante el vínculo **Runtime & Hosting Bundle** (Runtime y conjunto de hospedaje).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-322">Download the installer using the **Runtime & Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="1a1ab-323">Algunos instaladores contienen versiones que han alcanzado el final del ciclo de vida (EOL) y ya no son compatibles con Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-323">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="1a1ab-324">Para obtener más información, consulte la [política de soporte técnico](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-324">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="1a1ab-325">Instalación del conjunto de hospedaje</span><span class="sxs-lookup"><span data-stu-id="1a1ab-325">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="1a1ab-326">Ejecute el instalador en el servidor.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-326">Run the installer on the server.</span></span> <span data-ttu-id="1a1ab-327">Los parámetros siguientes están disponibles cuando se ejecuta el instalador desde un shell de comandos de administrador:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-327">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="1a1ab-328">`OPT_NO_ANCM=1`: omite la instalación del módulo de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-328">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="1a1ab-329">`OPT_NO_RUNTIME=1`: omite la instalación del entorno de ejecución de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-329">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="1a1ab-330">Se usa si el servidor solo hospeda [implementaciones autocontenidas (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-330">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="1a1ab-331">`OPT_NO_SHAREDFX=1`: omite la instalación del marco compartido de ASP.NET (entorno de ejecución de ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-331">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="1a1ab-332">Se usa si el servidor solo hospeda [implementaciones autocontenidas (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-332">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="1a1ab-333">`OPT_NO_X86=1` &ndash; omite la instalación de entornos de ejecución x86.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-333">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="1a1ab-334">Utilice este parámetro cuando sepa que no va a hospedar aplicaciones de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-334">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="1a1ab-335">Si hay alguna posibilidad de que vaya a hospedar aplicaciones de 32 bits y 64 bits en el futuro, no use este parámetro e instale ambos entornos de ejecución.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-335">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="1a1ab-336">`OPT_NO_SHARED_CONFIG_CHECK=1`: deshabilita la comprobación para usar una configuración compartida de IIS cuando la configuración compartida (*applicationHost.config*) esté en la misma máquina que la instalación de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-336">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="1a1ab-337">*Solo disponible para ASP.NET Core 2.2 o instaladores del conjunto de hospedaje posteriores.*</span><span class="sxs-lookup"><span data-stu-id="1a1ab-337">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="1a1ab-338">Para obtener más información, vea <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-338">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="1a1ab-339">Reinicie el sistema o ejecute los comandos siguientes en un shell de comandos:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-339">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="1a1ab-340">Al reiniciar IIS, se recoge un cambio en la variable PATH del sistema, que es una variable de entorno, realizado por el programa de instalación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-340">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="1a1ab-341">ASP.NET Core no adopta el comportamiento de puesta al día para las versiones de revisión de los paquetes de marco compartidos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-341">ASP.NET Core doesn't adopt roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="1a1ab-342">Después de actualizar el marco compartido mediante la instalación de un nuevo lote de hospedaje, reinicie el sistema o ejecute los comandos siguientes en un shell de comandos:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-342">After upgrading the shared framework by installing a new hosting bundle, restart the system or execute the following commands in a command shell:</span></span>

```console
net stop was /y
net start w3svc
```

::: moniker-end

::: moniker range="< aspnetcore-3.0"

<span data-ttu-id="1a1ab-343">No es necesario detener manualmente los sitios individuales en IIS al instalar el conjunto de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-343">It isn't necessary to manually stop individual sites in IIS when installing the Hosting Bundle.</span></span> <span data-ttu-id="1a1ab-344">Las aplicaciones hospedadas (sitios de IIS) se reinician cuando IIS se reinicia.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-344">Hosted apps (IIS sites) restart when IIS restarts.</span></span> <span data-ttu-id="1a1ab-345">Las aplicaciones se inician de nuevo cuando reciben su primera solicitud, incluso desde el [módulo de inicialización de la aplicación](#application-initialization-module-and-idle-timeout).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-345">Apps start up again when they receive their first request, including from the [Application Initialization Module](#application-initialization-module-and-idle-timeout).</span></span>

<span data-ttu-id="1a1ab-346">ASP.NET Core adopta el comportamiento de puesta al día para las versiones de revisión de los paquetes de marco compartidos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-346">ASP.NET Core adopts roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="1a1ab-347">Cuando las aplicaciones hospedadas por IIS se reinician con IIS, las aplicaciones se cargan con las versiones de revisión más recientes de los paquetes a los que se hace referencia cuando reciben su primera solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-347">When apps hosted by IIS restart with IIS, the apps load with the latest patch releases of their referenced packages when they receive their first request.</span></span> <span data-ttu-id="1a1ab-348">Si IIS no se reinicia, las aplicaciones se reinician y muestran el comportamiento de la puesta al día cuando se reciclan sus procesos de trabajo y reciben su primera solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-348">If IIS isn't restarted, apps restart and exhibit roll-forward behavior when their worker processes are recycled and they receive their first request.</span></span>

::: moniker-end

> [!NOTE]
> <span data-ttu-id="1a1ab-349">Para obtener información sobre la configuración compartida de IIS, vea [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration) (Módulo de ASP.NET Core con configuración compartida de IIS).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-349">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="1a1ab-350">Instalación de Web Deploy al publicar con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1a1ab-350">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="1a1ab-351">Al implementar aplicaciones en servidores con [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), instale la versión más reciente de Web Deploy en el servidor.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-351">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="1a1ab-352">Para instalar Web Deploy, use el [Instalador de plataforma web (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) u obtenga un instalador directamente desde el [Centro de descarga de Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-352">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="1a1ab-353">El método preferido es usar WebPI.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-353">The preferred method is to use WebPI.</span></span> <span data-ttu-id="1a1ab-354">WebPI ofrece una instalación independiente y una configuración para los proveedores de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-354">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="1a1ab-355">Creación del sitio de IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-355">Create the IIS site</span></span>

1. <span data-ttu-id="1a1ab-356">En el sistema de hospedaje, cree una carpeta para que contenga los archivos y las carpetas publicados de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-356">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="1a1ab-357">En un paso posterior, la ruta de acceso de la carpeta se proporciona a IIS como la ruta de acceso física a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-357">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="1a1ab-358">Para obtener más información sobre el diseño de carpetas y archivos de implementación de una aplicación, consulte <xref:host-and-deploy/directory-structure>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-358">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="1a1ab-359">En Administrador de IIS, abra el nodo del servidor en el panel **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-359">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="1a1ab-360">Haga clic con el botón derecho en la carpeta **Sitios**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-360">Right-click the **Sites** folder.</span></span> <span data-ttu-id="1a1ab-361">Haga clic en **Agregar sitio web** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-361">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="1a1ab-362">Proporcione el **Nombre del sitio** y establezca la **Ruta de acceso física** a la carpeta de implementación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-362">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="1a1ab-363">Proporcione la configuración de **Enlace** y cree el sitio web seleccionando **Aceptar**:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-363">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![Proporcione el nombre del sitio, la ruta de acceso física y el nombre de host en el paso Agregar sitio web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="1a1ab-365">Los enlaces de carácter comodín de nivel superior (`http://*:80/` y `http://+:80`) **no** se deben usar.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-365">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="1a1ab-366">Los enlaces de carácter comodín de nivel superior pueden exponer su aplicación a vulnerabilidades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-366">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="1a1ab-367">Esto se aplica tanto a los caracteres comodín fuertes como a los débiles.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-367">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="1a1ab-368">Use nombres de host explícitos en lugar de caracteres comodín.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-368">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="1a1ab-369">Los enlaces de carácter comodín de subdominio (por ejemplo, `*.mysub.com`) no suponen este riesgo de seguridad si se controla todo el dominio primario (a diferencia de `*.com`, que sí es vulnerable).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-369">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="1a1ab-370">Vea la [sección 5.4 de RFC 7230](https://tools.ietf.org/html/rfc7230#section-5.4) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-370">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="1a1ab-371">En el nodo del servidor, seleccione **Grupos de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-371">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="1a1ab-372">Haga clic con el botón derecho en el grupo de aplicaciones del sitio y seleccione **Configuración básica** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-372">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="1a1ab-373">En la ventana **Modificar grupo de aplicaciones**, establezca **Versión de .NET CLR** en **Sin código administrado**:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-373">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Establezca Sin código administrado para Versión de .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="1a1ab-375">ASP.NET Core se ejecuta en un proceso independiente y administra el runtime.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-375">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="1a1ab-376">ASP.NET Core no se basa en la carga de CLR de escritorio (.NET CLR); Core Common Language Runtime (CoreCLR) para .NET Core se arranca para hospedar la aplicación en el proceso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-376">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="1a1ab-377">El establecimiento de **Versión de .NET CLR** en **Sin código administrado** es opcional, pero no es lo recomendable.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-377">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="1a1ab-378">*ASP.NET Core 2.2 o posterior*: en el caso de las [implementaciones independientes](/dotnet/core/deploying/#self-contained-deployments-scd) de 64 bits (x64) en las que se use un [modelo de hospedaje en proceso](#in-process-hosting-model), deshabilite el grupo de aplicaciones de los procesos de 32 bits (x86).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-378">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="1a1ab-379">En la barra lateral **Acciones** de la sección **Grupos de aplicaciones** de Administrador de IIS, seleccione **Establecer valores predeterminados de grupos de aplicaciones** o **Configuración avanzada**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-379">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="1a1ab-380">Busque la opción **Habilitar aplicaciones de 32 bits** y establezca el valor en `False`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-380">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="1a1ab-381">Las aplicaciones implementadas para un [hospedaje fuera de proceso](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model) no se ven afectadas por este ajuste.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-381">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="1a1ab-382">Confirme que la identidad del modelo de proceso tiene los permisos adecuados.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-382">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="1a1ab-383">Si cambia la identidad predeterminada del grupo de aplicaciones (**Modelo de proceso** > **Identidad**) de **ApplicationPoolIdentity** a otra identidad, compruebe que la nueva identidad tenga los permisos necesarios para obtener acceso a la carpeta de la aplicación, la base de datos y otros recursos necesarios.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-383">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="1a1ab-384">Por ejemplo, el grupo de aplicaciones requiere acceso de lectura y escritura a las carpetas donde la aplicación lee y escribe archivos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-384">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="1a1ab-385">**Configuración de la autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-385">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="1a1ab-386">Para más información, consulte [Configurar la autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-386">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="1a1ab-387">Implementación de la aplicación</span><span class="sxs-lookup"><span data-stu-id="1a1ab-387">Deploy the app</span></span>

<span data-ttu-id="1a1ab-388">Implemente la aplicación en la carpeta **Ruta de acceso física** de IIS que se creó en la sección [Creación del sitio de IIS](#create-the-iis-site).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-388">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="1a1ab-389">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) es el mecanismo recomendado para la implementación, pero existen varias opciones para mover la aplicación desde la carpeta *publicar* del proyecto a la carpeta de implementación del sistema host.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-389">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="1a1ab-390">Web Deploy con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1a1ab-390">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="1a1ab-391">Vea el tema [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) (Perfiles de publicación de Visual Studio para la implementación de aplicaciones de ASP.NET Core) para obtener más información sobre cómo crear un perfil de publicación para su uso con Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-391">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="1a1ab-392">Si el proveedor de hospedaje proporciona un perfil de publicación o permite crear uno, descargue su perfil e impórtelo mediante el cuadro de diálogo **Publicar** de Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-392">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Cuadro de diálogo Publicar](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="1a1ab-394">Web Deploy fuera de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="1a1ab-394">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="1a1ab-395">También puede usar [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) fuera de Visual Studio desde la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-395">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="1a1ab-396">Para más información, vea [Web Deployment Tool (Herramienta de implementación web)](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-396">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="1a1ab-397">Alternativas a Web Deploy</span><span class="sxs-lookup"><span data-stu-id="1a1ab-397">Alternatives to Web Deploy</span></span>

<span data-ttu-id="1a1ab-398">Use cualquiera de los métodos disponibles para mover la aplicación al sistema de hospedaje, como copia manual, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy) o [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-398">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="1a1ab-399">Para obtener más información sobre ASP.NET Core en IIS, vea la sección [Recursos de implementación para administradores de IIS](#deployment-resources-for-iis-administrators).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-399">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="1a1ab-400">Examinar el sitio web</span><span class="sxs-lookup"><span data-stu-id="1a1ab-400">Browse the website</span></span>

<span data-ttu-id="1a1ab-401">Cuando la aplicación esté implementada en el sistema de hospedaje, realice una solicitud a uno de los puntos de conexión públicos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-401">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="1a1ab-402">En el ejemplo siguiente, el sitio se enlaza a un **Nombre de host** de IIS de `www.mysite.com` en el **Puerto** `80`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-402">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="1a1ab-403">Se realiza una solicitud a `http://www.mysite.com`:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-403">A request is made to `http://www.mysite.com`:</span></span>

![El explorador Microsoft Edge ha cargado la página de inicio de IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="1a1ab-405">Archivos de implementación bloqueados</span><span class="sxs-lookup"><span data-stu-id="1a1ab-405">Locked deployment files</span></span>

<span data-ttu-id="1a1ab-406">Los archivos de la carpeta de implementación se bloquean cuando se ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-406">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="1a1ab-407">Los archivos bloqueados no se pueden sobrescribir durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-407">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="1a1ab-408">Para liberar archivos bloqueados de una implementación, detenga el grupo de aplicaciones mediante **uno** de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-408">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="1a1ab-409">Use Web Deploy con una referencia a `Microsoft.NET.Sdk.Web` en el archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-409">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="1a1ab-410">Se coloca un archivo *app_offline.htm* en la raíz del directorio de aplicación web.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-410">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="1a1ab-411">Cuando el archivo está presente, el módulo de ASP.NET Core cierra correctamente la aplicación y proporciona el archivo *app_offline.htm* durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-411">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="1a1ab-412">Para más información, vea [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm) (Referencia de configuración del módulo de ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-412">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="1a1ab-413">Detenga manualmente el grupo de aplicaciones en el Administrador de IIS en el servidor.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-413">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="1a1ab-414">Utilice PowerShell para colocar *app_offline.htm* (es necesario PowerShell 5 o una versión posterior):</span><span class="sxs-lookup"><span data-stu-id="1a1ab-414">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```PowerShell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="1a1ab-415">Protección de datos</span><span class="sxs-lookup"><span data-stu-id="1a1ab-415">Data protection</span></span>

<span data-ttu-id="1a1ab-416">La [pila de protección de datos de ASP.NET Core](xref:security/data-protection/introduction) la usan varios [middlewares](xref:fundamentals/middleware/index) de ASP.NET Core, incluidos los que se emplean en la autenticación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-416">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="1a1ab-417">Aunque el código de usuario no llame a las API de protección de datos, la protección de datos se debe configurar con un script de implementación o en el código de usuario para crear un [almacén de claves](xref:security/data-protection/implementation/key-management) criptográficas persistente.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-417">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="1a1ab-418">Si no se configura la protección de datos, las claves se conservan en memoria y se descartan cuando se reinicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-418">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="1a1ab-419">Si el conjunto de claves se almacena en memoria cuando se reinicia la aplicación:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-419">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="1a1ab-420">Todos los tokens de autenticación basados en cookies se invalidan.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-420">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="1a1ab-421">Los usuarios tienen que iniciar sesión de nuevo en la siguiente solicitud.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-421">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="1a1ab-422">Ya no se pueden descifrar los datos protegidos con el conjunto de claves.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-422">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="1a1ab-423">Esto puede incluir [tokens CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) y [cookies de TempData de ASP.NET Core MVC](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-423">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="1a1ab-424">Para configurar la protección de datos en IIS para conservar el conjunto de claves, use **uno** de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-424">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="1a1ab-425">**Crear claves del Registro de protección de datos**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-425">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="1a1ab-426">Las claves de protección de datos que las aplicaciones de ASP.NET usan se almacenan en el Registro externo a las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-426">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="1a1ab-427">Para conservar las claves de una determinada aplicación, cree claves del Registro para el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-427">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="1a1ab-428">En las instalaciones independientes de IIS que no son de granja de servidores web, puede usar el [script de PowerShell Provision-AutoGenKeys.ps1 de protección de datos](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) para cada grupo de aplicaciones usado con una aplicación de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-428">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="1a1ab-429">Este script crea una clave del Registro en el registro HKLM que solo es accesible a la cuenta de proceso de trabajo del grupo de aplicaciones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-429">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="1a1ab-430">Las claves se cifran en reposo mediante DPAPI con una clave de equipo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-430">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="1a1ab-431">En escenarios de granja de servidores web, una aplicación puede configurarse para usar una ruta de acceso UNC para almacenar su conjunto de claves de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-431">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="1a1ab-432">De forma predeterminada, las claves de protección de datos no se cifran.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-432">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="1a1ab-433">Asegúrese de que los permisos de archivo de un recurso compartido de red se limitan a la cuenta de Windows bajo la que se ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-433">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="1a1ab-434">Puede usar un certificado X509 para proteger las claves en reposo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-434">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="1a1ab-435">Considere un mecanismo que permita a los usuarios cargar certificados: coloque los certificados en el almacén de certificados de confianza del usuario y asegúrese de que están disponibles en todos los equipos en los que se ejecuta la aplicación del usuario.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-435">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="1a1ab-436">Vea [Configurar la protección de datos en ASP.NET Core](xref:security/data-protection/configuration/overview) para más información.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-436">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="1a1ab-437">**Configurar el grupo de aplicaciones de IIS para cargar el perfil de usuario**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-437">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="1a1ab-438">Esta opción está en la sección **Modelo de proceso**, en la **Configuración avanzada** del grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-438">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="1a1ab-439">Establezca **Cargar perfil de usuario** en `True`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-439">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="1a1ab-440">Cuando se establece en `True`, las claves se almacenan en el directorio del perfil de usuario y se protegen mediante DPAPI con una clave específica de la cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-440">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="1a1ab-441">Las claves se conservan en la carpeta *%HOME%\ASP.NET\DataProtection-Keys*.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-441">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="1a1ab-442">También se debe habilitar el [atributo setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) del grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-442">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="1a1ab-443">El valor predeterminado de `setProfileEnvironment` es `true`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-443">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="1a1ab-444">En algunos escenarios (por ejemplo, SO Windows), `setProfileEnvironment` está establecido en `false`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-444">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="1a1ab-445">Si las claves no se almacenan en el directorio del perfil de usuario como se esperaba:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-445">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="1a1ab-446">Vaya a la carpeta *%windir%/system32/inetsrv/config*.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-446">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="1a1ab-447">Abra el archivo *applicationHost.config*.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-447">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="1a1ab-448">Busque el elemento `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` .</span><span class="sxs-lookup"><span data-stu-id="1a1ab-448">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="1a1ab-449">Confirme que el atributo `setProfileEnvironment` no está presente, que adopta de forma predeterminada el valor `true`, o establezca explícitamente el valor del atributo en `true`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-449">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="1a1ab-450">**Usar el sistema de archivos como un almacén de conjunto de claves**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-450">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="1a1ab-451">Ajuste el código de la aplicación para [usar el sistema de archivos como un almacén de conjunto de claves](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-451">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="1a1ab-452">Use un certificado X509 para proteger el conjunto de claves y asegúrese de que sea un certificado de confianza.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-452">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="1a1ab-453">Si es un certificado autofirmado, colóquelo en el almacén raíz de confianza.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-453">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="1a1ab-454">Cuando se usa IIS en una granja de servidores web:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-454">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="1a1ab-455">Use un recurso compartido de archivos al que puedan acceder todos los equipos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-455">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="1a1ab-456">Implemente un certificado X509 en cada equipo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-456">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="1a1ab-457">Configure la [protección de datos en el código](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-457">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="1a1ab-458">**Establecer una directiva para todo el equipo para la protección de datos**</span><span class="sxs-lookup"><span data-stu-id="1a1ab-458">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="1a1ab-459">El sistema de protección de datos tiene compatibilidad limitada con el establecimiento de una [directiva de equipo](xref:security/data-protection/configuration/machine-wide-policy) predeterminada para todas las aplicaciones que usan las API de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-459">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="1a1ab-460">Para obtener más información, vea <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-460">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="1a1ab-461">Directorios virtuales</span><span class="sxs-lookup"><span data-stu-id="1a1ab-461">Virtual Directories</span></span>

<span data-ttu-id="1a1ab-462">Los [directorios virtuales de IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) no son compatibles con aplicaciones ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-462">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="1a1ab-463">Una aplicación puede hospedarse como [subaplicación](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-463">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="1a1ab-464">Subaplicaciones</span><span class="sxs-lookup"><span data-stu-id="1a1ab-464">Sub-applications</span></span>

<span data-ttu-id="1a1ab-465">Se puede hospedar una aplicación ASP.NET Core como una [subaplicación IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-465">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="1a1ab-466">La ruta de acceso de la subaplicación se convierte en parte de la dirección URL de la aplicación raíz.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-466">The sub-app's path becomes part of the root app's URL.</span></span>

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="1a1ab-467">Una aplicación secundaria no debe incluir el módulo de ASP.NET Core como controlador.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-467">A sub-app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="1a1ab-468">Si se agrega el módulo como controlador al archivo *web.config* de una aplicación secundaria, aparece un *error 500.19 (Error interno del servidor)* que hace referencia al archivo de configuración erróneo al intentar examinar la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-468">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="1a1ab-469">En el ejemplo siguiente se muestra un archivo *web.config* publicado para una aplicación secundaria ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-469">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="1a1ab-470">Al hospedar una aplicación secundaria que no es de ASP.NET Core bajo una aplicación de ASP.NET Core, quite explícitamente el controlador heredado del archivo *web.config* de la aplicación secundaria:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-470">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app's *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

::: moniker-end

<span data-ttu-id="1a1ab-471">Los vínculos a los recursos estáticos dentro de la aplicación secundaria deben utilizar una notación de una tilde con una barra diagonal (`~/`).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-471">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="1a1ab-472">La notación de tilde barra diagonal desencadena un [asistente de etiquetas](xref:mvc/views/tag-helpers/intro) para anteponer la ruta de acceso de la aplicación secundaria al vínculo relativo representado.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-472">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="1a1ab-473">Para una aplicación secundaria en `/subapp_path`, una imagen vinculada con `src="~/image.png"` se representa como `src="/subapp_path/image.png"`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-473">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="1a1ab-474">El middleware de archivos estáticos de la aplicación raíz no procesa la solicitud de archivo estático.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-474">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="1a1ab-475">La solicitud se procesa mediante el middleware de archivos estáticos de la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-475">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="1a1ab-476">Si el atributo `src` de un recurso estático se establece en una ruta de acceso absoluta (por ejemplo, `src="/image.png"`), el vínculo se representa sin la base de la ruta de acceso de la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-476">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="1a1ab-477">El middleware de archivos estáticos de la aplicación raíz intenta atender al recurso desde el [web root](xref:fundamentals/index#web-root), lo que resulta en una respuesta *404 - No encontrado* a menos que el recurso estático esté disponible desde la aplicación raíz.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-477">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="1a1ab-478">Para hospedar una aplicación ASP.NET Core como aplicación secundaria en otra aplicación ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-478">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="1a1ab-479">Establezca un grupo de aplicaciones para la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-479">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="1a1ab-480">Establezca **Versión de .NET CLR**  en **Sin código administrado**  porque Core Common Language Runtime (CoreCLR) para .NET Core se arranca para hospedar la aplicación en el proceso de trabajo, no el CLR de escritorio (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-480">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="1a1ab-481">Agregue el sitio raíz en el Administrador de IIS con la aplicación secundaria en una carpeta en el sitio raíz.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-481">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="1a1ab-482">Haga clic con el botón derecho en la carpeta de la aplicación secundaria en el Administrador de IIS y seleccione **Convertir en aplicación**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-482">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="1a1ab-483">En el cuadro de diálogo **Agregar aplicación**, use el botón **Seleccionar** en **Grupo de aplicaciones** para asignar el grupo de aplicaciones que ha creado para la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-483">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="1a1ab-484">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-484">Select **OK**.</span></span>

<span data-ttu-id="1a1ab-485">La asignación de un grupo de aplicaciones independiente de la aplicación secundaria es un requisito cuando se utiliza el modelo de hospedaje en proceso.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-485">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="1a1ab-486">Para más información sobre el modelo de hospedaje en proceso y cómo configurar el módulo de ASP.NET Core, consulte <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-486">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="1a1ab-487">Configuración de IIS con web.config</span><span class="sxs-lookup"><span data-stu-id="1a1ab-487">Configuration of IIS with web.config</span></span>

<span data-ttu-id="1a1ab-488">En escenarios de IIS que son funcionales para aplicaciones ASP.NET Core con el módulo ASP.NET Core, la configuración de IIS está influenciada por la sección `<system.webServer>` de *web.config*.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-488">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="1a1ab-489">Por ejemplo, la configuración de IIS es funcional para la compresión dinámica.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-489">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="1a1ab-490">Si IIS está configurado en el nivel de servidor para usar compresión dinámica, el elemento `<urlCompression>` del archivo *web.config* de la aplicación puede deshabilitarlo para una aplicación ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-490">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="1a1ab-491">Para obtener más información, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-491">For more information, see the following topics:</span></span>

* [<span data-ttu-id="1a1ab-492">Referencia de configuración para \<system.webServer></span><span class="sxs-lookup"><span data-stu-id="1a1ab-492">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="1a1ab-493">Para establecer variables de entorno para aplicaciones individuales que se ejecutan en grupos de aplicaciones aislados (se admite para IIS 10.0 o posterior), vea la sección *AppCmd.exe command* (Comando AppCmd.exe) del tema [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) (Variables de entorno <environmentVariables>) de la documentación de referencia de IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-493">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="1a1ab-494">Secciones de configuración de web.config</span><span class="sxs-lookup"><span data-stu-id="1a1ab-494">Configuration sections of web.config</span></span>

<span data-ttu-id="1a1ab-495">Las aplicaciones ASP.NET Core no usan las secciones de configuración de aplicaciones ASP.NET 4.x en *web.config* para la configuración:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-495">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="1a1ab-496">Las aplicaciones de ASP.NET Core se configuran mediante otros proveedores de configuración.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-496">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="1a1ab-497">Para obtener más información, vea [Configuración](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-497">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="1a1ab-498">Grupos de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="1a1ab-498">Application Pools</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="1a1ab-499">El aislamiento de los grupos de aplicaciones se determinan mediante el modelo de hospedaje:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-499">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="1a1ab-500">Hospedaje dentro de proceso: es necesario que las aplicaciones se ejecuten en grupos de aplicaciones distintos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-500">In-process hosting &ndash; Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="1a1ab-501">Hospedaje fuera de proceso: nuestra recomendación es aislar las aplicaciones entre sí ejecutándolas en su propio grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-501">Out-of-process hosting &ndash; We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="1a1ab-502">El valor predeterminado del cuadro de diálogo **Agregar sitio web** de IIS es un único grupo de aplicaciones por aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-502">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="1a1ab-503">Cuando se proporciona el **Nombre del sitio**, el texto se transfiere automáticamente al cuadro de texto **Grupo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-503">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="1a1ab-504">Al agregar el sitio se crea un grupo de aplicaciones con el nombre del sitio.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-504">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="1a1ab-505">Al hospedar varios sitios web en un servidor, nuestra recomendación es aislar las aplicaciones entre sí ejecutándolas en su propio grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-505">When hosting multiple websites on a server, we recommend isolating the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="1a1ab-506">El valor predeterminado del cuadro de diálogo **Agregar sitio web** es esta configuración.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-506">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="1a1ab-507">Cuando se proporciona el **Nombre del sitio**, el texto se transfiere automáticamente al cuadro de texto **Grupo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-507">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="1a1ab-508">Al agregar el sitio se crea un grupo de aplicaciones con el nombre del sitio.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-508">A new app pool is created using the site name when the site is added.</span></span>

::: moniker-end

## <a name="application-pool-identity"></a><span data-ttu-id="1a1ab-509">Identidad del grupo de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="1a1ab-509">Application Pool Identity</span></span>

<span data-ttu-id="1a1ab-510">Una cuenta de identidad del grupo de aplicaciones permite ejecutar una aplicación en una cuenta única sin tener que crear ni administrar dominios o cuentas locales.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-510">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="1a1ab-511">En IIS 8.0 o versiones posteriores, el proceso de trabajo de administración de IIS (WAS) crea una cuenta virtual con el nombre del nuevo grupo de aplicaciones y ejecuta los procesos de trabajo del grupo de aplicaciones en esta cuenta de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-511">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="1a1ab-512">En la Consola de administración de IIS, en la opción **Configuración avanzada** del grupo de aplicaciones, asegúrese de que la **Identidad** está establecida para usar **ApplicationPoolIdentity**:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-512">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Cuadro de diálogo Configuración avanzada del grupo de aplicaciones](index/_static/apppool-identity.png)

<span data-ttu-id="1a1ab-514">El proceso de administración de IIS crea un identificador seguro con el nombre del grupo de aplicaciones en el sistema de seguridad de Windows.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-514">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="1a1ab-515">Los recursos se pueden proteger mediante esta identidad.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-515">Resources can be secured using this identity.</span></span> <span data-ttu-id="1a1ab-516">Sin embargo, no es una cuenta de usuario real ni se muestra en la consola de administración de usuario de Windows.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-516">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="1a1ab-517">Si el proceso de trabajo de IIS requiere acceso con privilegios elevados a la aplicación, modifique la lista de control de acceso (ACL) del directorio que contiene la aplicación:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-517">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="1a1ab-518">Abra el Explorador de Windows y vaya al directorio.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-518">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="1a1ab-519">Haga clic con el botón derecho en el directorio y seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-519">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="1a1ab-520">En la pestaña **Seguridad**, haga clic en el botón **Editar** y en el botón **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-520">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="1a1ab-521">Haga clic en el botón **Ubicaciones** y asegúrese de seleccionar el sistema.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-521">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="1a1ab-522">Escriba **IIS AppPool\\<nombre_del_grupo_de_aplicaciones>** en el área **Escribir los nombres de objeto para seleccionar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-522">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="1a1ab-523">Haga clic en el botón **Comprobar nombres**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-523">Select the **Check Names** button.</span></span> <span data-ttu-id="1a1ab-524">Para *DefaultAppPool* compruebe los nombres con **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-524">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="1a1ab-525">Cuando el botón **Comprobar nombres** está seleccionado, un valor de **DefaultAppPool** se indica en el área de los nombres de objeto.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-525">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="1a1ab-526">No es posible escribir el nombre del grupo de aplicaciones directamente en el área de los nombres de objeto.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-526">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="1a1ab-527">Use el formato **IIS AppPool\\<nombre_del_grupo_de_aplicaciones>** cuando compruebe el nombre del objeto.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-527">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Cuadro de diálogo Seleccionar usuarios o grupos para la carpeta de la aplicación: el nombre del grupo de aplicaciones de "DefaultAppPool" se anexa al "IIS AppPool\" en el área de los nombres de objeto antes de seleccionar "Comprobar nombres".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="1a1ab-529">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-529">Select **OK**.</span></span>

   ![Cuadro de diálogo Seleccionar usuarios o grupos para la carpeta de la aplicación: después de seleccionar "Comprobar nombres", el nombre del objeto "DefaultAppPool" se muestra en el área de los nombres de objeto.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="1a1ab-531">Los permisos de lectura y ejecución se deben conceder de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-531">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="1a1ab-532">Proporcione permisos adicionales según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-532">Provide additional permissions as needed.</span></span>

<span data-ttu-id="1a1ab-533">El acceso también se puede conceder mediante un símbolo del sistema con la herramienta **ICACLS**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-533">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="1a1ab-534">En el siguiente comando se usa *DefaultAppPool* como ejemplo:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-534">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="1a1ab-535">Para más información, consulte el tema [icacls](/windows-server/administration/windows-commands/icacls).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-535">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="1a1ab-536">Compatibilidad con HTTP/2</span><span class="sxs-lookup"><span data-stu-id="1a1ab-536">HTTP/2 support</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="1a1ab-537">[HTTP/2](https://httpwg.org/specs/rfc7540.html) es compatible con ASP.NET Core en los escenarios de implementación de IIS siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-537">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="1a1ab-538">En proceso</span><span class="sxs-lookup"><span data-stu-id="1a1ab-538">In-process</span></span>
  * <span data-ttu-id="1a1ab-539">Windows Server 2016/Windows 10 o posterior; IIS 10 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-539">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="1a1ab-540">Conexión con TLS 1.2 o una versión posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-540">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="1a1ab-541">Fuera de proceso</span><span class="sxs-lookup"><span data-stu-id="1a1ab-541">Out-of-process</span></span>
  * <span data-ttu-id="1a1ab-542">Windows Server 2016/Windows 10 o posterior; IIS 10 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-542">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="1a1ab-543">Las conexiones de servidor perimetral de acceso público usan HTTP/2, pero la conexión de proxy inverso al [servidor de Kestrel](xref:fundamentals/servers/kestrel) usa HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-543">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="1a1ab-544">Conexión con TLS 1.2 o una versión posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-544">TLS 1.2 or later connection</span></span>

<span data-ttu-id="1a1ab-545">Para una implementación en proceso cuando se establece una conexión HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) notifica `HTTP/2`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-545">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="1a1ab-546">Para una implementación fuera de proceso cuando se establece una conexión HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) notifica `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-546">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="1a1ab-547">Para obtener más información sobre los modelos de hospedaje en proceso y fuera de proceso, consulte <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-547">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="1a1ab-548">[HTTP/2](https://httpwg.org/specs/rfc7540.html) es compatible con las implementaciones fuera de proceso que cumplen los requisitos básicos siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-548">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported for out-of-process deployments that meet the following base requirements:</span></span>

* <span data-ttu-id="1a1ab-549">Windows Server 2016/Windows 10 o posterior; IIS 10 o posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-549">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
* <span data-ttu-id="1a1ab-550">Las conexiones de servidor perimetral de acceso público usan HTTP/2, pero la conexión de proxy inverso al [servidor de Kestrel](xref:fundamentals/servers/kestrel) usa HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-550">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
* <span data-ttu-id="1a1ab-551">Marco de destino: no es aplicable a las implementaciones fuera de proceso, ya que IIS controla completamente la conexión HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-551">Target framework: Not applicable to out-of-process deployments, since the HTTP/2 connection is handled entirely by IIS.</span></span>
* <span data-ttu-id="1a1ab-552">Conexión con TLS 1.2 o una versión posterior</span><span class="sxs-lookup"><span data-stu-id="1a1ab-552">TLS 1.2 or later connection</span></span>

<span data-ttu-id="1a1ab-553">Si se establece una conexión HTTP/2, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) notifica `HTTP/1.1`.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-553">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

::: moniker-end

<span data-ttu-id="1a1ab-554">HTTP/2 está habilitado de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-554">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="1a1ab-555">Las conexiones vuelven a HTTP/1.1 si no se establece una conexión HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-555">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="1a1ab-556">Para más información sobre la configuración HTTP/2 con implementaciones de IIS, vea [HTTP/2 en IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-556">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="1a1ab-557">Solicitudes CORS de preflight</span><span class="sxs-lookup"><span data-stu-id="1a1ab-557">CORS preflight requests</span></span>

<span data-ttu-id="1a1ab-558">*Esta sección solo se aplica a las aplicaciones de ASP.NET Core que tienen como destino .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="1a1ab-558">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="1a1ab-559">Para una aplicación de ASP.NET Core que tiene como destino .NET Framework, las solicitudes OPTIONS no se pasan a la aplicación de forma predeterminada en IIS.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-559">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="1a1ab-560">Para obtener información sobre cómo configurar los controladores de IIS de la aplicación en *web.config* para pasar las solicitudes OPTIONS, consulte [Habilitar solicitudes entre orígenes en ASP.NET Web API 2: Cómo funciona la CORS](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-560">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

::: moniker range=">= aspnetcore-2.2"

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="1a1ab-561">Módulo de inicialización de aplicaciones y tiempo de espera de inactividad</span><span class="sxs-lookup"><span data-stu-id="1a1ab-561">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="1a1ab-562">Cuando se hospeda en IIS mediante la versión 2 del módulo de ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-562">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="1a1ab-563">[Módulo de inicialización de aplicaciones](#application-initialization-module): las aplicaciones hospedadas [dentro de proceso](#in-process-hosting-model) o [fuera de proceso](#out-of-process-hosting-model) se pueden configurar para iniciarse de forma automática en un reinicio de proceso de trabajo o un reinicio de servidor.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-563">[Application Initialization Module](#application-initialization-module) &ndash; App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="1a1ab-564">[Tiempo de espera de inactividad](#idle-timeout): las aplicaciones hospedadas [dentro de proceso](#in-process-hosting-model) se pueden configurar para que no tengan tiempo de espera durante períodos de inactividad.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-564">[Idle Timeout](#idle-timeout) &ndash; App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="1a1ab-565">Módulo de inicialización de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="1a1ab-565">Application Initialization Module</span></span>

<span data-ttu-id="1a1ab-566">*Se aplica a las aplicaciones hospedadas dentro de proceso y fuera de proceso.*</span><span class="sxs-lookup"><span data-stu-id="1a1ab-566">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="1a1ab-567">[Inicialización de aplicaciones de IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) es una característica de IIS que envía una solicitud HTTP a la aplicación al iniciarse o reciclarse el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-567">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="1a1ab-568">La solicitud desencadena el inicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-568">The request triggers the app to start.</span></span> <span data-ttu-id="1a1ab-569">De forma predeterminada, IIS emite una solicitud a la dirección URL raíz de la aplicación (`/`) para inicializar esta (consulte los [recursos adicionales](#application-initialization-module-and-idle-timeout-additional-resources) para más detalles sobre la configuración).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-569">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="1a1ab-570">Confirme que la característica de rol Inicialización de aplicaciones de IIS está habilitada:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-570">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="1a1ab-571">En Windows 7 o sistemas de escritorio posteriores cuando se usa IIS localmente:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-571">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="1a1ab-572">Vaya a **Panel de control** > **Programas** > **Programas y características** > **Activar o desactivar las características de Windows** (lado izquierdo de la pantalla).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-572">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="1a1ab-573">Abra **Internet Information Services** > **Servicios World Wide Web** > **Características de desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-573">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features**.</span></span>
1. <span data-ttu-id="1a1ab-574">Active la casilla de **Inicialización de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-574">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="1a1ab-575">En Windows Server 2008 R2 o posterior:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-575">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="1a1ab-576">Abra el **Asistente para agregar roles y características**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-576">Open the **Add Roles and Features Wizard**.</span></span>
1. <span data-ttu-id="1a1ab-577">En el panel **Seleccionar servicios de rol**, abra el nodo **Desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-577">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="1a1ab-578">Active la casilla de **Inicialización de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-578">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="1a1ab-579">Use cualquiera de los enfoques siguientes para habilitar el módulo de inicialización de aplicaciones para el sitio:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-579">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="1a1ab-580">Mediante el Administrador de IIS:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-580">Using IIS Manager:</span></span>

  1. <span data-ttu-id="1a1ab-581">Seleccione **Grupos de aplicaciones** en el panel **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-581">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="1a1ab-582">Haga clic con el botón derecho en el grupo de aplicaciones de la aplicación en la lista y seleccione **Configuración avanzada**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-582">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
  1. <span data-ttu-id="1a1ab-583">El valor predeterminado de **Modo de inicio** es **OnDemand**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-583">The default **Start Mode** is **OnDemand**.</span></span> <span data-ttu-id="1a1ab-584">Establezca **Modo de inicio** en **AlwaysRunning**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-584">Set the **Start Mode** to **AlwaysRunning**.</span></span> <span data-ttu-id="1a1ab-585">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-585">Select **OK**.</span></span>
  1. <span data-ttu-id="1a1ab-586">Abra el nodo **Sitios** en el panel **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-586">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="1a1ab-587">Haga clic con el botón derecho en la aplicación y seleccione **Administrar sitio web** > **Configuración avanzada**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-587">Right-click the app and select **Manage Website** > **Advanced Settings**.</span></span>
  1. <span data-ttu-id="1a1ab-588">El valor predeterminado de **Carga previa activada** es **False**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-588">The default **Preload Enabled** setting is **False**.</span></span> <span data-ttu-id="1a1ab-589">Establezca **Carga previa activada** en **True**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-589">Set **Preload Enabled** to **True**.</span></span> <span data-ttu-id="1a1ab-590">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-590">Select **OK**.</span></span>

* <span data-ttu-id="1a1ab-591">Mediante *web.config*, agregue el elemento `<applicationInitialization>` con `doAppInitAfterRestart` establecido en `true` a los elementos `<system.webServer>` del archivo *web.config* de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-591">Using *web.config*, add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's *web.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="1a1ab-592">Tiempo de espera de inactividad</span><span class="sxs-lookup"><span data-stu-id="1a1ab-592">Idle Timeout</span></span>

<span data-ttu-id="1a1ab-593">*Solo se aplica a las aplicaciones hospedadas dentro de proceso.*</span><span class="sxs-lookup"><span data-stu-id="1a1ab-593">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="1a1ab-594">Para evitar la inactividad en la aplicación, establezca el tiempo de espera de inactividad del grupo de aplicaciones mediante el Administrador de IIS:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-594">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="1a1ab-595">Seleccione **Grupos de aplicaciones** en el panel **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-595">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="1a1ab-596">Haga clic con el botón derecho en el grupo de aplicaciones de la aplicación en la lista y seleccione **Configuración avanzada**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-596">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
1. <span data-ttu-id="1a1ab-597">El valor predeterminado de **Tiempo de inactividad (minutos)**  es **20** minutos.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-597">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="1a1ab-598">Establezca **Tiempo de inactividad (minutos)** en **0** (cero).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-598">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="1a1ab-599">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-599">Select **OK**.</span></span>
1. <span data-ttu-id="1a1ab-600">Desactive y vuelva a activar el proceso de trabajo.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-600">Recycle the worker process.</span></span>

<span data-ttu-id="1a1ab-601">Para evitar que las aplicaciones hospedadas [fuera de proceso](#out-of-process-hosting-model) agoten el tiempo de espera, use cualquiera de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="1a1ab-601">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="1a1ab-602">Haga ping a la aplicación desde un servicio externo con el fin de mantenerla funcionando.</span><span class="sxs-lookup"><span data-stu-id="1a1ab-602">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="1a1ab-603">Si la aplicación solo hospeda servicios en segundo plano, evite el hospedaje de IIS y use un [servicio de Windows para hospedar la aplicación de ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-603">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="1a1ab-604">Recursos adicionales del módulo de inicialización de aplicaciones y del tiempo de espera de inactividad</span><span class="sxs-lookup"><span data-stu-id="1a1ab-604">Application Initialization Module and Idle Timeout additional resources</span></span>

* [<span data-ttu-id="1a1ab-605">Inicialización de aplicaciones IIS 8.0</span><span class="sxs-lookup"><span data-stu-id="1a1ab-605">IIS 8.0 Application Initialization</span></span>](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)
* <span data-ttu-id="1a1ab-606">[Inicialización de la aplicación \<applicationInitialization >](/iis/configuration/system.webserver/applicationinitialization/).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-606">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="1a1ab-607">[Configuración del modelo de proceso para un grupo de aplicaciones \<processModel >](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span><span class="sxs-lookup"><span data-stu-id="1a1ab-607">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

::: moniker-end

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="1a1ab-608">Recursos de implementación para administradores de IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-608">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="1a1ab-609">Documentación de IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-609">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="1a1ab-610">Introducción al Administrador de IIS en IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-610">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="1a1ab-611">Implementación de aplicaciones .NET Core</span><span class="sxs-lookup"><span data-stu-id="1a1ab-611">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="1a1ab-612">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="1a1ab-612">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="1a1ab-613">Sitio oficial de Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-613">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="1a1ab-614">Biblioteca de contenido técnico de Windows Server</span><span class="sxs-lookup"><span data-stu-id="1a1ab-614">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="1a1ab-615">HTTP/2 en IIS</span><span class="sxs-lookup"><span data-stu-id="1a1ab-615">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>
