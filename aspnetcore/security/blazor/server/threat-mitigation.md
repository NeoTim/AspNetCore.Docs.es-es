---
<span data-ttu-id="627cd-101">Título: ' Guía de mitigación de amenazas para Blazor el servidor de ASP.net Core ' autor: Descripción: ' obtener información sobre cómo mitigar las amenazas de seguridad para las Blazor aplicaciones de servidor '.</span><span class="sxs-lookup"><span data-stu-id="627cd-101">title: 'Threat mitigation guidance for ASP.NET Core Blazor Server' author: description: 'Learn how to mitigate security threats to Blazor Server apps.'</span></span>
<span data-ttu-id="627cd-102">monikerRange: ms.author: ms.custom: ms.date: no-loc:</span><span class="sxs-lookup"><span data-stu-id="627cd-102">monikerRange: ms.author: ms.custom: ms.date: no-loc:</span></span>
- <span data-ttu-id="627cd-103">'Blazor'</span><span class="sxs-lookup"><span data-stu-id="627cd-103">'Blazor'</span></span>
- <span data-ttu-id="627cd-104">'Identity'</span><span class="sxs-lookup"><span data-stu-id="627cd-104">'Identity'</span></span>
- <span data-ttu-id="627cd-105">'Let's Encrypt'</span><span class="sxs-lookup"><span data-stu-id="627cd-105">'Let's Encrypt'</span></span>
- <span data-ttu-id="627cd-106">'Razor'</span><span class="sxs-lookup"><span data-stu-id="627cd-106">'Razor'</span></span>
- <span data-ttu-id="627cd-107">'SignalR' uid:</span><span class="sxs-lookup"><span data-stu-id="627cd-107">'SignalR' uid:</span></span> 

---
# <a name="threat-mitigation-guidance-for-aspnet-core-blazor-server"></a><span data-ttu-id="627cd-108">Guía de mitigación de amenazas para ASP.NET Core Blazor Server</span><span class="sxs-lookup"><span data-stu-id="627cd-108">Threat mitigation guidance for ASP.NET Core Blazor Server</span></span>

<span data-ttu-id="627cd-109">Por [Javier Calvarro Nelson](https://github.com/javiercn)</span><span class="sxs-lookup"><span data-stu-id="627cd-109">By [Javier Calvarro Nelson](https://github.com/javiercn)</span></span>

Blazor<span data-ttu-id="627cd-110">Las aplicaciones de servidor adoptan un modelo de procesamiento de datos con *Estado* , donde el servidor y el cliente mantienen una relación de larga duración.</span><span class="sxs-lookup"><span data-stu-id="627cd-110"> Server apps adopt a *stateful* data processing model, where the server and client maintain a long-lived relationship.</span></span> <span data-ttu-id="627cd-111">Un [circuito](xref:blazor/state-management)mantiene el estado persistente, que puede abarcar conexiones que también son potencialmente de larga duración.</span><span class="sxs-lookup"><span data-stu-id="627cd-111">The persistent state is maintained by a [circuit](xref:blazor/state-management), which can span connections that are also potentially long-lived.</span></span>

<span data-ttu-id="627cd-112">Cuando un usuario visita un Blazor sitio de servidor, el servidor crea un circuito en la memoria del servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-112">When a user visits a Blazor Server site, the server creates a circuit in the server's memory.</span></span> <span data-ttu-id="627cd-113">El circuito indica al explorador qué contenido se va a representar y responde a los eventos, como cuando el usuario selecciona un botón en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-113">The circuit indicates to the browser what content to render and responds to events, such as when the user selects a button in the UI.</span></span> <span data-ttu-id="627cd-114">Para realizar estas acciones, un circuito invoca las funciones de JavaScript en el explorador del usuario y los métodos de .NET en el servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-114">To perform these actions, a circuit invokes JavaScript functions in the user's browser and .NET methods on the server.</span></span> <span data-ttu-id="627cd-115">Esta interacción basada en JavaScript bidireccional se conoce como [interoperabilidad de JavaScript (interoperabilidad de JS)](xref:blazor/call-javascript-from-dotnet).</span><span class="sxs-lookup"><span data-stu-id="627cd-115">This two-way JavaScript-based interaction is referred to as [JavaScript interop (JS interop)](xref:blazor/call-javascript-from-dotnet).</span></span>

<span data-ttu-id="627cd-116">Dado que la interoperabilidad de JS se produce a través de Internet y el cliente usa un explorador remoto, las Blazor aplicaciones de servidor comparten la mayoría de los problemas de seguridad de las aplicaciones Web.</span><span class="sxs-lookup"><span data-stu-id="627cd-116">Because JS interop occurs over the Internet and the client uses a remote browser, Blazor Server apps share most web app security concerns.</span></span> <span data-ttu-id="627cd-117">En este tema se describen las amenazas comunes a las Blazor aplicaciones de servidor y se proporciona una guía de mitigación de amenazas centrada en las aplicaciones orientadas a Internet.</span><span class="sxs-lookup"><span data-stu-id="627cd-117">This topic describes common threats to Blazor Server apps and provides threat mitigation guidance focused on Internet-facing apps.</span></span>

<span data-ttu-id="627cd-118">En entornos restringidos, como dentro de redes corporativas o intranets, algunas de las instrucciones de mitigación:</span><span class="sxs-lookup"><span data-stu-id="627cd-118">In constrained environments, such as inside corporate networks or intranets, some of the mitigation guidance either:</span></span>

* <span data-ttu-id="627cd-119">No se aplica en el entorno restringido.</span><span class="sxs-lookup"><span data-stu-id="627cd-119">Doesn't apply in the constrained environment.</span></span>
* <span data-ttu-id="627cd-120">No merece la pena implementar porque el riesgo de seguridad es bajo en un entorno restringido.</span><span class="sxs-lookup"><span data-stu-id="627cd-120">Isn't worth the cost to implement because the security risk is low in a constrained environment.</span></span>

## <a name="blazor-and-shared-state"></a>Blazor<span data-ttu-id="627cd-121"> y estado compartido</span><span class="sxs-lookup"><span data-stu-id="627cd-121"> and shared state</span></span>

[!INCLUDE[](~/includes/blazor-security/blazor-shared-state.md)]

## <a name="resource-exhaustion"></a><span data-ttu-id="627cd-122">Agotamiento de recursos</span><span class="sxs-lookup"><span data-stu-id="627cd-122">Resource exhaustion</span></span>

<span data-ttu-id="627cd-123">El agotamiento de recursos puede producirse cuando un cliente interactúa con el servidor y hace que el servidor consuma demasiados recursos.</span><span class="sxs-lookup"><span data-stu-id="627cd-123">Resource exhaustion can occur when a client interacts with the server and causes the server to consume excessive resources.</span></span> <span data-ttu-id="627cd-124">El consumo excesivo de Recursos afecta principalmente a:</span><span class="sxs-lookup"><span data-stu-id="627cd-124">Excessive resource consumption primarily affects:</span></span>

* [<span data-ttu-id="627cd-125">CPU</span><span class="sxs-lookup"><span data-stu-id="627cd-125">CPU</span></span>](#cpu)
* [<span data-ttu-id="627cd-126">Memoria</span><span class="sxs-lookup"><span data-stu-id="627cd-126">Memory</span></span>](#memory)
* [<span data-ttu-id="627cd-127">Conexiones de cliente</span><span class="sxs-lookup"><span data-stu-id="627cd-127">Client connections</span></span>](#client-connections)

<span data-ttu-id="627cd-128">Los ataques por denegación de servicio (DoS) suelen intentar agotar los recursos de una aplicación o un servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-128">Denial of service (DoS) attacks usually seek to exhaust an app or server's resources.</span></span> <span data-ttu-id="627cd-129">Sin embargo, el agotamiento de recursos no es necesariamente el resultado de un ataque en el sistema.</span><span class="sxs-lookup"><span data-stu-id="627cd-129">However, resource exhaustion isn't necessarily the result of an attack on the system.</span></span> <span data-ttu-id="627cd-130">Por ejemplo, los recursos finitos se pueden agotar debido a una alta demanda del usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-130">For example, finite resources can be exhausted due to high user demand.</span></span> <span data-ttu-id="627cd-131">DoS se describe con más detalle en la sección [ataques por denegación de servicio (dos)](#denial-of-service-dos-attacks) .</span><span class="sxs-lookup"><span data-stu-id="627cd-131">DoS is covered further in the [Denial of service (DoS) attacks](#denial-of-service-dos-attacks) section.</span></span>

<span data-ttu-id="627cd-132">Los recursos externos al Blazor marco, como las bases de datos y los identificadores de archivo (que se usan para leer y escribir archivos), también pueden experimentar el agotamiento de los recursos.</span><span class="sxs-lookup"><span data-stu-id="627cd-132">Resources external to the Blazor framework, such as databases and file handles (used to read and write files), may also experience resource exhaustion.</span></span> <span data-ttu-id="627cd-133">Para obtener más información, vea <xref:performance/performance-best-practices>.</span><span class="sxs-lookup"><span data-stu-id="627cd-133">For more information, see <xref:performance/performance-best-practices>.</span></span>

### <a name="cpu"></a><span data-ttu-id="627cd-134">CPU</span><span class="sxs-lookup"><span data-stu-id="627cd-134">CPU</span></span>

<span data-ttu-id="627cd-135">El agotamiento de la CPU puede producirse cuando uno o varios clientes fuerzan al servidor a realizar un trabajo intensivo de la CPU.</span><span class="sxs-lookup"><span data-stu-id="627cd-135">CPU exhaustion can occur when one or more clients force the server to perform intensive CPU work.</span></span>

<span data-ttu-id="627cd-136">Por ejemplo, considere una Blazor aplicación de servidor que calcula un *número de Fibonnacci*.</span><span class="sxs-lookup"><span data-stu-id="627cd-136">For example, consider a Blazor Server app that calculates a *Fibonnacci number*.</span></span> <span data-ttu-id="627cd-137">Un número de Fibonnacci se genera a partir de una secuencia de Fibonnacci, donde cada número de la secuencia es la suma de los dos números anteriores.</span><span class="sxs-lookup"><span data-stu-id="627cd-137">A Fibonnacci number is produced from a Fibonnacci sequence, where each number in the sequence is the sum of the two preceding numbers.</span></span> <span data-ttu-id="627cd-138">La cantidad de trabajo necesaria para llegar a la respuesta depende de la longitud de la secuencia y el tamaño del valor inicial.</span><span class="sxs-lookup"><span data-stu-id="627cd-138">The amount of work required to reach the answer depends on the length of the sequence and the size of the initial value.</span></span> <span data-ttu-id="627cd-139">Si la aplicación no impone límites en la solicitud de un cliente, los cálculos de uso intensivo de la CPU pueden dominar el tiempo de la CPU y reducir el rendimiento de otras tareas.</span><span class="sxs-lookup"><span data-stu-id="627cd-139">If the app doesn't place limits on a client's request, the CPU-intensive calculations may dominate the CPU's time and diminish the performance of other tasks.</span></span> <span data-ttu-id="627cd-140">Un consumo excesivo de recursos es un problema de seguridad que afecta a la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="627cd-140">Excessive resource consumption is a security concern impacting availability.</span></span>

<span data-ttu-id="627cd-141">El agotamiento de la CPU es un problema para todas las aplicaciones orientadas al público.</span><span class="sxs-lookup"><span data-stu-id="627cd-141">CPU exhaustion is a concern for all public-facing apps.</span></span> <span data-ttu-id="627cd-142">En las aplicaciones web normales, las solicitudes y conexiones agotan el tiempo de espera como medida de seguridad, pero las Blazor aplicaciones de servidor no proporcionan las mismas medidas de seguridad.</span><span class="sxs-lookup"><span data-stu-id="627cd-142">In regular web apps, requests and connections time out as a safeguard, but Blazor Server apps don't provide the same safeguards.</span></span> Blazor<span data-ttu-id="627cd-143">Las aplicaciones de servidor deben incluir comprobaciones y límites adecuados antes de llevar a cabo un trabajo potencialmente intensivo de la CPU.</span><span class="sxs-lookup"><span data-stu-id="627cd-143"> Server apps must include appropriate checks and limits before performing potentially CPU-intensive work.</span></span>

### <a name="memory"></a><span data-ttu-id="627cd-144">Memoria</span><span class="sxs-lookup"><span data-stu-id="627cd-144">Memory</span></span>

<span data-ttu-id="627cd-145">El agotamiento de la memoria puede producirse cuando uno o varios clientes fuerzan al servidor a consumir una gran cantidad de memoria.</span><span class="sxs-lookup"><span data-stu-id="627cd-145">Memory exhaustion can occur when one or more clients force the server to consume a large amount of memory.</span></span>

<span data-ttu-id="627cd-146">Por ejemplo, considere una Blazor aplicación del lado servidor con un componente que acepta y muestra una lista de elementos.</span><span class="sxs-lookup"><span data-stu-id="627cd-146">For example, consider a Blazor-server side app with a component that accepts and displays a list of items.</span></span> <span data-ttu-id="627cd-147">Si la Blazor aplicación no impone límites en el número de elementos permitidos o el número de elementos representados en el cliente, el procesamiento y la representación de memoria intensiva pueden dominar la memoria del servidor hasta el punto en el que el rendimiento del servidor se vea afectado.</span><span class="sxs-lookup"><span data-stu-id="627cd-147">If the Blazor app doesn't place limits on the number of items allowed or the number of items rendered back to the client, the memory-intensive processing and rendering may dominate the server's memory to the point where performance of the server suffers.</span></span> <span data-ttu-id="627cd-148">El servidor puede bloquearse o ralentizarse hasta el punto en el que parece que se ha bloqueado.</span><span class="sxs-lookup"><span data-stu-id="627cd-148">The server may crash or slow to the point that it appears to have crashed.</span></span>

<span data-ttu-id="627cd-149">Considere el siguiente escenario para mantener y mostrar una lista de los elementos que pertenecen a un posible escenario de agotamiento de memoria en el servidor:</span><span class="sxs-lookup"><span data-stu-id="627cd-149">Consider the following scenario for maintaining and displaying a list of items that pertain to a potential memory exhaustion scenario on the server:</span></span>

* <span data-ttu-id="627cd-150">Los elementos de una `List<MyItem>` propiedad o un campo utilizan la memoria del servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-150">The items in a `List<MyItem>` property or field use the server's memory.</span></span> <span data-ttu-id="627cd-151">Si la aplicación permite que la lista de elementos crezca sin límite, existe el riesgo de que el servidor se quede sin memoria.</span><span class="sxs-lookup"><span data-stu-id="627cd-151">If the app allows the list of items to grow unbounded, there's a risk of the server running out of memory.</span></span> <span data-ttu-id="627cd-152">Quedarse sin memoria hace que la sesión actual finalice (bloqueo) y todas las sesiones simultáneas en esa instancia de servidor reciban una excepción de memoria insuficiente.</span><span class="sxs-lookup"><span data-stu-id="627cd-152">Running out of memory causes the current session to end (crash) and all of the concurrent sessions in that server instance receive an out-of-memory exception.</span></span> <span data-ttu-id="627cd-153">Para evitar que se produzca este escenario, la aplicación debe usar una estructura de datos que impone un límite de elementos a los usuarios simultáneos.</span><span class="sxs-lookup"><span data-stu-id="627cd-153">To prevent this scenario from occurring, the app must use a data structure that imposes an item limit on concurrent users.</span></span>
* <span data-ttu-id="627cd-154">Si no se usa un esquema de paginación para la representación, el servidor utiliza memoria adicional para los objetos que no están visibles en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-154">If a paging scheme isn't used for rendering, the server uses additional memory for objects that aren't visible in the UI.</span></span> <span data-ttu-id="627cd-155">Sin un límite en cuanto al número de elementos, las demandas de memoria pueden agotar la memoria del servidor disponible.</span><span class="sxs-lookup"><span data-stu-id="627cd-155">Without a limit on the number of items, memory demands may exhaust the available server memory.</span></span> <span data-ttu-id="627cd-156">Para evitar este escenario, use uno de los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="627cd-156">To prevent this scenario, use one of the following approaches:</span></span>
  * <span data-ttu-id="627cd-157">Usar listas paginadas al representar.</span><span class="sxs-lookup"><span data-stu-id="627cd-157">Use paginated lists when rendering.</span></span>
  * <span data-ttu-id="627cd-158">Solo se muestran los primeros 100 a 1.000 elementos y se requiere que el usuario escriba criterios de búsqueda para buscar elementos más allá de los elementos mostrados.</span><span class="sxs-lookup"><span data-stu-id="627cd-158">Only display the first 100 to 1,000 items and require the user to enter search criteria to find items beyond the items displayed.</span></span>
  * <span data-ttu-id="627cd-159">Para un escenario de representación más avanzado, implemente listas o cuadrículas que admitan la *Virtualización*.</span><span class="sxs-lookup"><span data-stu-id="627cd-159">For a more advanced rendering scenario, implement lists or grids that support *virtualization*.</span></span> <span data-ttu-id="627cd-160">Con la virtualización, las listas solo representan un subconjunto de elementos actualmente visibles para el usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-160">Using virtualization, lists only render a subset of items currently visible to the user.</span></span> <span data-ttu-id="627cd-161">Cuando el usuario interactúa con la barra de desplazamiento en la interfaz de usuario, el componente solo representa los elementos necesarios para la presentación.</span><span class="sxs-lookup"><span data-stu-id="627cd-161">When the user interacts with the scrollbar in the UI, the component renders only those items required for display.</span></span> <span data-ttu-id="627cd-162">Los elementos que no son necesarios actualmente para la presentación se pueden almacenar en el almacenamiento secundario, que es el enfoque ideal.</span><span class="sxs-lookup"><span data-stu-id="627cd-162">The items that aren't currently required for display can be held in secondary storage, which is the ideal approach.</span></span> <span data-ttu-id="627cd-163">Los elementos no mostrados también se pueden almacenar en memoria, lo que es menos idóneo.</span><span class="sxs-lookup"><span data-stu-id="627cd-163">Undisplayed items can also be held in memory, which is less ideal.</span></span>

Blazor<span data-ttu-id="627cd-164">Las aplicaciones de servidor ofrecen un modelo de programación similar a otros marcos de interfaz de usuario para aplicaciones con estado, como WPF, Windows Forms o Blazor Webassembly.</span><span class="sxs-lookup"><span data-stu-id="627cd-164"> Server apps offer a similar programming model to other UI frameworks for stateful apps, such as WPF, Windows Forms, or Blazor WebAssembly.</span></span> <span data-ttu-id="627cd-165">La principal diferencia es que en varios marcos de interfaz de usuario la memoria consumida por la aplicación pertenece al cliente y solo afecta a ese cliente individual.</span><span class="sxs-lookup"><span data-stu-id="627cd-165">The main difference is that in several of the UI frameworks the memory consumed by the app belongs to the client and only affects that individual client.</span></span> <span data-ttu-id="627cd-166">Por ejemplo, una Blazor aplicación Webassembly se ejecuta completamente en el cliente y solo utiliza recursos de memoria del cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-166">For example, a Blazor WebAssembly app runs entirely on the client and only uses client memory resources.</span></span> <span data-ttu-id="627cd-167">En el Blazor escenario de servidor, la memoria consumida por la aplicación pertenece al servidor y se comparte entre los clientes en la instancia del servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-167">In the Blazor Server scenario, the memory consumed by the app belongs to the server and is shared among clients on the server instance.</span></span>

<span data-ttu-id="627cd-168">Las peticiones de memoria del lado servidor son una consideración para todas las Blazor aplicaciones de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-168">Server-side memory demands are a consideration for all Blazor Server apps.</span></span> <span data-ttu-id="627cd-169">Sin embargo, la mayoría de las aplicaciones web no tienen estado y la memoria que se usa al procesar una solicitud se libera cuando se devuelve la respuesta.</span><span class="sxs-lookup"><span data-stu-id="627cd-169">However, most web apps are stateless, and the memory used while processing a request is released when the response is returned.</span></span> <span data-ttu-id="627cd-170">Como recomendación general, no permita que los clientes asignen una cantidad de memoria sin enlazar como en cualquier otra aplicación del lado servidor que conserve las conexiones de cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-170">As a general recommendation, don't permit clients to allocate an unbound amount of memory as in any other server-side app that persists client connections.</span></span> <span data-ttu-id="627cd-171">La memoria consumida por una Blazor aplicación de servidor persiste durante más tiempo que una única solicitud.</span><span class="sxs-lookup"><span data-stu-id="627cd-171">The memory consumed by a Blazor Server app persists for a longer time than a single request.</span></span>

> [!NOTE]
> <span data-ttu-id="627cd-172">Durante el desarrollo, se puede usar un generador de perfiles o un seguimiento capturado para evaluar las demandas de memoria de los clientes.</span><span class="sxs-lookup"><span data-stu-id="627cd-172">During development, a profiler can be used or a trace captured to assess memory demands of clients.</span></span> <span data-ttu-id="627cd-173">Un generador de perfiles o seguimiento no capturará la memoria asignada a un cliente específico.</span><span class="sxs-lookup"><span data-stu-id="627cd-173">A profiler or trace won't capture the memory allocated to a specific client.</span></span> <span data-ttu-id="627cd-174">Para capturar el uso de memoria de un cliente específico durante el desarrollo, Capture un volcado y examine la demanda de memoria de todos los objetos cuya raíz se encuentra en el circuito de un usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-174">To capture the memory use of a specific client during development, capture a dump and examine the memory demand of all the objects rooted at a user's circuit.</span></span>

### <a name="client-connections"></a><span data-ttu-id="627cd-175">Conexiones de cliente</span><span class="sxs-lookup"><span data-stu-id="627cd-175">Client connections</span></span>

<span data-ttu-id="627cd-176">El agotamiento de la conexión puede producirse cuando uno o varios clientes abren demasiadas conexiones simultáneas al servidor, lo que impide que otros clientes establezcan nuevas conexiones.</span><span class="sxs-lookup"><span data-stu-id="627cd-176">Connection exhaustion can occur when one or more clients open too many concurrent connections to the server, preventing other clients from establishing new connections.</span></span>

Blazor<span data-ttu-id="627cd-177">los clientes establecen una conexión única por sesión y mantienen la conexión abierta mientras la ventana del explorador esté abierta.</span><span class="sxs-lookup"><span data-stu-id="627cd-177"> clients establish a single connection per session and keep the connection open for as long as the browser window is open.</span></span> <span data-ttu-id="627cd-178">La demanda en el servidor de mantenimiento de todas las conexiones no es específica de las Blazor aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="627cd-178">The demands on the server of maintaining all of the connections isn't specific to Blazor apps.</span></span> <span data-ttu-id="627cd-179">Dada la naturaleza persistente de las conexiones y la naturaleza con estado de las Blazor aplicaciones de servidor, el agotamiento de la conexión es un riesgo mayor para la disponibilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-179">Given the persistent nature of the connections and the stateful nature of Blazor Server apps, connection exhaustion is a greater risk to availability of the app.</span></span>

<span data-ttu-id="627cd-180">De forma predeterminada, no hay ningún límite en el número de conexiones por usuario para una Blazor aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-180">By default, there's no limit on the number of connections per user for a Blazor Server app.</span></span> <span data-ttu-id="627cd-181">Si la aplicación requiere un límite de conexión, realice uno o varios de los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="627cd-181">If the app requires a connection limit, take one or more of the following approaches:</span></span>

* <span data-ttu-id="627cd-182">Requiere autenticación, que de forma natural limita la posibilidad de que usuarios no autorizados se conecten a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-182">Require authentication, which naturally limits the ability of unauthorized users to connect to the app.</span></span> <span data-ttu-id="627cd-183">Para que este escenario sea eficaz, los usuarios deben evitar el aprovisionamiento de nuevos usuarios en.</span><span class="sxs-lookup"><span data-stu-id="627cd-183">For this scenario to be effective, users must be prevented from provisioning new users at will.</span></span>
* <span data-ttu-id="627cd-184">Limite el número de conexiones por usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-184">Limit the number of connections per user.</span></span> <span data-ttu-id="627cd-185">La limitación de las conexiones se puede realizar mediante los siguientes enfoques.</span><span class="sxs-lookup"><span data-stu-id="627cd-185">Limiting connections can be accomplished via the following approaches.</span></span> <span data-ttu-id="627cd-186">Preste atención para permitir que los usuarios legítimos tengan acceso a la aplicación (por ejemplo, cuando se establece un límite de conexión en función de la dirección IP del cliente).</span><span class="sxs-lookup"><span data-stu-id="627cd-186">Exercise care to allow legitimate users to access the app (for example, when a connection limit is established based on the client's IP address).</span></span>
  * <span data-ttu-id="627cd-187">En el nivel de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="627cd-187">At the app level:</span></span>
    * <span data-ttu-id="627cd-188">Extensibilidad de enrutamiento de extremo.</span><span class="sxs-lookup"><span data-stu-id="627cd-188">Endpoint routing extensibility.</span></span>
    * <span data-ttu-id="627cd-189">Requerir autenticación para conectarse a la aplicación y realizar un seguimiento de las sesiones activas por usuario.</span><span class="sxs-lookup"><span data-stu-id="627cd-189">Require authentication to connect to the app and keep track of the active sessions per user.</span></span>
    * <span data-ttu-id="627cd-190">Rechazar nuevas sesiones al alcanzar un límite.</span><span class="sxs-lookup"><span data-stu-id="627cd-190">Reject new sessions upon reaching a limit.</span></span>
    * <span data-ttu-id="627cd-191">Conexiones de WebSocket de proxy a una aplicación mediante el uso de un proxy, como [el SignalR servicio de Azure](/azure/azure-signalr/signalr-overview) que multiplexa las conexiones de los clientes a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-191">Proxy WebSocket connections to an app through the use of a proxy, such as the [Azure SignalR Service](/azure/azure-signalr/signalr-overview) that multiplexes connections from clients to an app.</span></span> <span data-ttu-id="627cd-192">Esto proporciona una aplicación con mayor capacidad de conexión de la que puede establecer un solo cliente, lo que impide que un cliente agote las conexiones al servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-192">This provides an app with greater connection capacity than a single client can establish, preventing a client from exhausting the connections to the server.</span></span>
  * <span data-ttu-id="627cd-193">En el nivel de servidor: Use un proxy o puerta de enlace delante de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-193">At the server level: Use a proxy/gateway in front of the app.</span></span> <span data-ttu-id="627cd-194">Por ejemplo, la [puerta frontal de Azure](/azure/frontdoor/front-door-overview) permite definir, administrar y supervisar el enrutamiento global del tráfico web a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-194">For example, [Azure Front Door](/azure/frontdoor/front-door-overview) enables you to define, manage, and monitor the global routing of web traffic to an app.</span></span>

## <a name="denial-of-service-dos-attacks"></a><span data-ttu-id="627cd-195">Ataques por denegación de servicio (DoS)</span><span class="sxs-lookup"><span data-stu-id="627cd-195">Denial of service (DoS) attacks</span></span>

<span data-ttu-id="627cd-196">Los ataques por denegación de servicio (DoS) implican a un cliente que hace que el servidor agote uno o más de sus recursos, lo que hace que la aplicación no esté disponible.</span><span class="sxs-lookup"><span data-stu-id="627cd-196">Denial of service (DoS) attacks involve a client causing the server to exhaust one or more of its resources making the app unavailable.</span></span> Blazor<span data-ttu-id="627cd-197">Las aplicaciones de servidor incluyen algunos límites predeterminados y dependen de otros ASP.NET Core y SignalR límites para protegerse frente a los ataques de dos que están establecidos en <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions> .</span><span class="sxs-lookup"><span data-stu-id="627cd-197"> Server apps include some default limits and rely on other ASP.NET Core and SignalR limits to protect against DoS attacks that are set on <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions>.</span></span>

| Blazor<span data-ttu-id="627cd-198">Límite de aplicación de servidor</span><span class="sxs-lookup"><span data-stu-id="627cd-198"> Server app limit</span></span> | <span data-ttu-id="627cd-199">Descripción</span><span class="sxs-lookup"><span data-stu-id="627cd-199">Description</span></span> | <span data-ttu-id="627cd-200">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="627cd-200">Default</span></span> |
| --- | --- | --- |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitMaxRetained> | <span data-ttu-id="627cd-201">Número máximo de circuitos desconectados que un servidor determinado contiene en la memoria a la vez.</span><span class="sxs-lookup"><span data-stu-id="627cd-201">Maximum number of disconnected circuits that a given server holds in memory at a time.</span></span> | <span data-ttu-id="627cd-202">100</span><span class="sxs-lookup"><span data-stu-id="627cd-202">100</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitRetentionPeriod> | <span data-ttu-id="627cd-203">Cantidad máxima de tiempo que un circuito desconectado se mantiene en la memoria antes de que se detenga.</span><span class="sxs-lookup"><span data-stu-id="627cd-203">Maximum amount of time a disconnected circuit is held in memory before being torn down.</span></span> | <span data-ttu-id="627cd-204">3 minutos</span><span class="sxs-lookup"><span data-stu-id="627cd-204">3 minutes</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout> | <span data-ttu-id="627cd-205">Cantidad máxima de tiempo que el servidor espera antes de agotar el tiempo de espera de una invocación de función JavaScript asincrónica.</span><span class="sxs-lookup"><span data-stu-id="627cd-205">Maximum amount of time the server waits before timing out an asynchronous JavaScript function invocation.</span></span> | <span data-ttu-id="627cd-206">1 minuto</span><span class="sxs-lookup"><span data-stu-id="627cd-206">1 minute</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches> | <span data-ttu-id="627cd-207">Número máximo de lotes de representación no confirmados el servidor mantiene en memoria por circuito en un momento dado para admitir una reconexión sólida.</span><span class="sxs-lookup"><span data-stu-id="627cd-207">Maximum number of unacknowledged render batches the server keeps in memory per circuit at a given time to support robust reconnection.</span></span> <span data-ttu-id="627cd-208">Después de alcanzar el límite, el servidor deja de generar nuevos lotes de representación hasta que el cliente ha confirmado uno o varios lotes.</span><span class="sxs-lookup"><span data-stu-id="627cd-208">After reaching the limit, the server stops producing new render batches until one or more batches have been acknowledged by the client.</span></span> | <span data-ttu-id="627cd-209">10</span><span class="sxs-lookup"><span data-stu-id="627cd-209">10</span></span> |

<span data-ttu-id="627cd-210">Establezca el tamaño máximo de mensaje de un único mensaje de centro entrante con <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions> .</span><span class="sxs-lookup"><span data-stu-id="627cd-210">Set the maximum message size of a single incoming hub message with <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions>.</span></span>

| SignalR<span data-ttu-id="627cd-211">y ASP.NET Core límite</span><span class="sxs-lookup"><span data-stu-id="627cd-211"> and ASP.NET Core limit</span></span> | <span data-ttu-id="627cd-212">Descripción</span><span class="sxs-lookup"><span data-stu-id="627cd-212">Description</span></span> | <span data-ttu-id="627cd-213">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="627cd-213">Default</span></span> |
| --- | --- | --- |
| <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions.MaximumReceiveMessageSize?displayProperty=nameWithType> | <span data-ttu-id="627cd-214">Tamaño del mensaje para un mensaje individual.</span><span class="sxs-lookup"><span data-stu-id="627cd-214">Message size for an individual message.</span></span> | <span data-ttu-id="627cd-215">32 KB</span><span class="sxs-lookup"><span data-stu-id="627cd-215">32 KB</span></span> |

## <a name="interactions-with-the-browser-client"></a><span data-ttu-id="627cd-216">Interacciones con el explorador (cliente)</span><span class="sxs-lookup"><span data-stu-id="627cd-216">Interactions with the browser (client)</span></span>

<span data-ttu-id="627cd-217">Un cliente interactúa con el servidor a través de la distribución de eventos de interoperabilidad de JS y la finalización de la representación.</span><span class="sxs-lookup"><span data-stu-id="627cd-217">A client interacts with the server through JS interop event dispatching and render completion.</span></span> <span data-ttu-id="627cd-218">La comunicación de interoperabilidad de JS se dirige a ambos sentidos entre JavaScript y .NET:</span><span class="sxs-lookup"><span data-stu-id="627cd-218">JS interop communication goes both ways between JavaScript and .NET:</span></span>

* <span data-ttu-id="627cd-219">Los eventos del explorador se envían desde el cliente al servidor de manera asincrónica.</span><span class="sxs-lookup"><span data-stu-id="627cd-219">Browser events are dispatched from the client to the server in an asynchronous fashion.</span></span>
* <span data-ttu-id="627cd-220">El servidor responde de forma asincrónica representando la interfaz de usuario según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="627cd-220">The server responds asynchronously rerendering the UI as necessary.</span></span>

### <a name="javascript-functions-invoked-from-net"></a><span data-ttu-id="627cd-221">Funciones de JavaScript invocadas desde .NET</span><span class="sxs-lookup"><span data-stu-id="627cd-221">JavaScript functions invoked from .NET</span></span>

<span data-ttu-id="627cd-222">Para las llamadas de métodos de .NET a JavaScript:</span><span class="sxs-lookup"><span data-stu-id="627cd-222">For calls from .NET methods to JavaScript:</span></span>

* <span data-ttu-id="627cd-223">Todas las invocaciones tienen un tiempo de espera configurable después del cual se produce un error y devuelven un <xref:System.OperationCanceledException> al llamador.</span><span class="sxs-lookup"><span data-stu-id="627cd-223">All invocations have a configurable timeout after which they fail, returning a <xref:System.OperationCanceledException> to the caller.</span></span>
  * <span data-ttu-id="627cd-224">Hay un tiempo de espera predeterminado para las llamadas ( <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> ) de un minuto.</span><span class="sxs-lookup"><span data-stu-id="627cd-224">There's a default timeout for the calls (<xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>) of one minute.</span></span> <span data-ttu-id="627cd-225">Para configurar este límite, vea <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls> .</span><span class="sxs-lookup"><span data-stu-id="627cd-225">To configure this limit, see <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls>.</span></span>
  * <span data-ttu-id="627cd-226">Se puede proporcionar un token de cancelación para controlar la cancelación en cada llamada.</span><span class="sxs-lookup"><span data-stu-id="627cd-226">A cancellation token can be provided to control the cancellation on a per-call basis.</span></span> <span data-ttu-id="627cd-227">Confíe en el tiempo de espera de la llamada predeterminado, siempre que sea posible, y en cualquier llamada al cliente si se proporciona un token de cancelación.</span><span class="sxs-lookup"><span data-stu-id="627cd-227">Rely on the default call timeout where possible and time-bound any call to the client if a cancellation token is provided.</span></span>
* <span data-ttu-id="627cd-228">No se puede confiar en el resultado de una llamada de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-228">The result of a JavaScript call can't be trusted.</span></span> <span data-ttu-id="627cd-229">El Blazor cliente de la aplicación que se ejecuta en el explorador busca la función de JavaScript que se va a invocar.</span><span class="sxs-lookup"><span data-stu-id="627cd-229">The Blazor app client running in the browser searches for the JavaScript function to invoke.</span></span> <span data-ttu-id="627cd-230">Se invoca la función y se produce el resultado o un error.</span><span class="sxs-lookup"><span data-stu-id="627cd-230">The function is invoked, and either the result or an error is produced.</span></span> <span data-ttu-id="627cd-231">Un cliente malintencionado puede intentar:</span><span class="sxs-lookup"><span data-stu-id="627cd-231">A malicious client can attempt to:</span></span>
  * <span data-ttu-id="627cd-232">Producir un problema en la aplicación devolviendo un error de la función de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-232">Cause an issue in the app by returning an error from the JavaScript function.</span></span>
  * <span data-ttu-id="627cd-233">Inducir un comportamiento no deseado en el servidor devolviendo un resultado inesperado de la función de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-233">Induce an unintended behavior on the server by returning an unexpected result from the JavaScript function.</span></span>

<span data-ttu-id="627cd-234">Tome las siguientes precauciones para protegerse frente a los escenarios anteriores:</span><span class="sxs-lookup"><span data-stu-id="627cd-234">Take the following precautions to guard against the preceding scenarios:</span></span>

* <span data-ttu-id="627cd-235">Ajuste las llamadas de interoperabilidad de JS dentro de las instrucciones [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) para tener en cuenta los errores que pueden producirse durante las invocaciones.</span><span class="sxs-lookup"><span data-stu-id="627cd-235">Wrap JS interop calls within [try-catch](/dotnet/csharp/language-reference/keywords/try-catch) statements to account for errors that might occur during the invocations.</span></span> <span data-ttu-id="627cd-236">Para obtener más información, vea <xref:blazor/handle-errors#javascript-interop>.</span><span class="sxs-lookup"><span data-stu-id="627cd-236">For more information, see <xref:blazor/handle-errors#javascript-interop>.</span></span>
* <span data-ttu-id="627cd-237">Valide los datos devueltos por las invocaciones de interoperabilidad de JS, incluidos los mensajes de error, antes de realizar cualquier acción.</span><span class="sxs-lookup"><span data-stu-id="627cd-237">Validate data returned from JS interop invocations, including error messages, before taking any action.</span></span>

### <a name="net-methods-invoked-from-the-browser"></a><span data-ttu-id="627cd-238">Métodos de .NET que se invocan desde el explorador</span><span class="sxs-lookup"><span data-stu-id="627cd-238">.NET methods invoked from the browser</span></span>

<span data-ttu-id="627cd-239">No confíe en llamadas de JavaScript a métodos de .NET.</span><span class="sxs-lookup"><span data-stu-id="627cd-239">Don't trust calls from JavaScript to .NET methods.</span></span> <span data-ttu-id="627cd-240">Cuando un método .NET se exponga a JavaScript, tenga en cuenta cómo se invoca el método .NET:</span><span class="sxs-lookup"><span data-stu-id="627cd-240">When a .NET method is exposed to JavaScript, consider how the .NET method is invoked:</span></span>

* <span data-ttu-id="627cd-241">Trate cualquier método .NET expuesto a JavaScript como lo haría con un punto de conexión público a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-241">Treat any .NET method exposed to JavaScript as you would a public endpoint to the app.</span></span>
  * <span data-ttu-id="627cd-242">Valide la entrada.</span><span class="sxs-lookup"><span data-stu-id="627cd-242">Validate input.</span></span>
    * <span data-ttu-id="627cd-243">Asegúrese de que los valores están dentro de los intervalos esperados.</span><span class="sxs-lookup"><span data-stu-id="627cd-243">Ensure that values are within expected ranges.</span></span>
    * <span data-ttu-id="627cd-244">Asegúrese de que el usuario tiene permiso para realizar la acción solicitada.</span><span class="sxs-lookup"><span data-stu-id="627cd-244">Ensure that the user has permission to perform the action requested.</span></span>
  * <span data-ttu-id="627cd-245">No asigne una cantidad excesiva de recursos como parte de la invocación de método de .NET.</span><span class="sxs-lookup"><span data-stu-id="627cd-245">Don't allocate an excessive quantity of resources as part of the .NET method invocation.</span></span> <span data-ttu-id="627cd-246">Por ejemplo, realice comprobaciones y coloque límites en el uso de la CPU y la memoria.</span><span class="sxs-lookup"><span data-stu-id="627cd-246">For example, perform checks and place limits on CPU and memory use.</span></span>
  * <span data-ttu-id="627cd-247">Tenga en cuenta que los métodos estáticos y de instancia se pueden exponer a los clientes de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-247">Take into account that static and instance methods can be exposed to JavaScript clients.</span></span> <span data-ttu-id="627cd-248">Evite compartir el estado entre las sesiones a menos que el diseño llame al estado de uso compartido con las restricciones adecuadas.</span><span class="sxs-lookup"><span data-stu-id="627cd-248">Avoid sharing state across sessions unless the design calls for sharing state with appropriate constraints.</span></span>
    * <span data-ttu-id="627cd-249">Para los métodos de instancia expuestos a través de `DotNetReference` objetos que se crearon originalmente a través de la inserción de dependencias (di), los objetos se deben registrar como objetos con ámbito.</span><span class="sxs-lookup"><span data-stu-id="627cd-249">For instance methods exposed through `DotNetReference` objects that are originally created through dependency injection (DI), the objects should be registered as scoped objects.</span></span> <span data-ttu-id="627cd-250">Esto se aplica a cualquier servicio DI que Blazor use la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-250">This applies to any DI service that the Blazor Server app uses.</span></span>
    * <span data-ttu-id="627cd-251">En el caso de los métodos estáticos, evite establecer el estado que no se puede limitar al cliente a menos que la aplicación comparta explícitamente el estado por diseño entre todos los usuarios de una instancia de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-251">For static methods, avoid establishing state that can't be scoped to the client unless the app is explicitly sharing state by-design across all users on a server instance.</span></span>
  * <span data-ttu-id="627cd-252">Evite pasar datos proporcionados por el usuario en parámetros a llamadas de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-252">Avoid passing user-supplied data in parameters to JavaScript calls.</span></span> <span data-ttu-id="627cd-253">Si pasar datos en parámetros es absolutamente necesario, asegúrese de que el código de JavaScript controla el paso de los datos sin introducir vulnerabilidades de [scripting entre sitios (XSS)](#cross-site-scripting-xss) .</span><span class="sxs-lookup"><span data-stu-id="627cd-253">If passing data in parameters is absolutely required, ensure that the JavaScript code handles passing the data without introducing [Cross-site scripting (XSS)](#cross-site-scripting-xss) vulnerabilities.</span></span> <span data-ttu-id="627cd-254">Por ejemplo, no escriba los datos proporcionados por el usuario en el Document Object Model (DOM) estableciendo la `innerHTML` propiedad de un elemento.</span><span class="sxs-lookup"><span data-stu-id="627cd-254">For example, don't write user-supplied data to the Document Object Model (DOM) by setting the `innerHTML` property of an element.</span></span> <span data-ttu-id="627cd-255">Considere la posibilidad de usar la [Directiva de seguridad de contenido (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) para deshabilitar `eval` y otras primitivas de JavaScript no seguras.</span><span class="sxs-lookup"><span data-stu-id="627cd-255">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to disable `eval` and other unsafe JavaScript primitives.</span></span>
* <span data-ttu-id="627cd-256">Evite implementar la distribución personalizada de las invocaciones de .NET sobre la implementación de distribución del marco.</span><span class="sxs-lookup"><span data-stu-id="627cd-256">Avoid implementing custom dispatching of .NET invocations on top of the framework's dispatching implementation.</span></span> <span data-ttu-id="627cd-257">Exponer métodos .NET en el explorador es un escenario avanzado, no recomendado para el Blazor desarrollo general.</span><span class="sxs-lookup"><span data-stu-id="627cd-257">Exposing .NET methods to the browser is an advanced scenario, not recommended for general Blazor development.</span></span>

### <a name="events"></a><span data-ttu-id="627cd-258">Eventos</span><span class="sxs-lookup"><span data-stu-id="627cd-258">Events</span></span>

<span data-ttu-id="627cd-259">Los eventos proporcionan un punto de entrada a una Blazor aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-259">Events provide an entry point to a Blazor Server app.</span></span> <span data-ttu-id="627cd-260">Las mismas reglas para proteger los puntos de conexión de las aplicaciones web se aplican al control de eventos en las Blazor aplicaciones de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-260">The same rules for safeguarding endpoints in web apps apply to event handling in Blazor Server apps.</span></span> <span data-ttu-id="627cd-261">Un cliente malintencionado puede enviar cualquier dato que desee enviar como carga para un evento.</span><span class="sxs-lookup"><span data-stu-id="627cd-261">A malicious client can send any data it wishes to send as the payload for an event.</span></span>

<span data-ttu-id="627cd-262">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="627cd-262">For example:</span></span>

* <span data-ttu-id="627cd-263">Un evento de cambio de un `<select>` puede enviar un valor que no está dentro de las opciones que la aplicación presentó al cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-263">A change event for a `<select>` could send a value that isn't within the options that the app presented to the client.</span></span>
* <span data-ttu-id="627cd-264">`<input>`Podría enviar cualquier dato de texto al servidor, omitiendo la validación del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-264">An `<input>` could send any text data to the server, bypassing client-side validation.</span></span>

<span data-ttu-id="627cd-265">La aplicación debe validar los datos de los eventos que controla la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-265">The app must validate the data for any event that the app handles.</span></span> <span data-ttu-id="627cd-266">Los Blazor [componentes de formularios](xref:blazor/forms-validation) de marco realizan validaciones básicas.</span><span class="sxs-lookup"><span data-stu-id="627cd-266">The Blazor framework [forms components](xref:blazor/forms-validation) perform basic validations.</span></span> <span data-ttu-id="627cd-267">Si la aplicación usa componentes de formularios personalizados, se debe escribir código personalizado para validar los datos de evento según corresponda.</span><span class="sxs-lookup"><span data-stu-id="627cd-267">If the app uses custom forms components, custom code must be written to validate event data as appropriate.</span></span>

Blazor<span data-ttu-id="627cd-268">Los eventos de servidor son asincrónicos, por lo que se pueden enviar varios eventos al servidor antes de que la aplicación tenga tiempo de reaccionar mediante la generación de una nueva representación.</span><span class="sxs-lookup"><span data-stu-id="627cd-268"> Server events are asynchronous, so multiple events can be dispatched to the server before the app has time to react by producing a new render.</span></span> <span data-ttu-id="627cd-269">Esto tiene algunas implicaciones de seguridad que se deben tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="627cd-269">This has some security implications to consider.</span></span> <span data-ttu-id="627cd-270">La limitación de las acciones de cliente en la aplicación debe realizarse dentro de los controladores de eventos y no depender del estado de vista representado actual.</span><span class="sxs-lookup"><span data-stu-id="627cd-270">Limiting client actions in the app must be performed inside event handlers and not depend on the current rendered view state.</span></span>

<span data-ttu-id="627cd-271">Considere un componente de contador que debe permitir que un usuario incremente un contador un máximo de tres veces.</span><span class="sxs-lookup"><span data-stu-id="627cd-271">Consider a counter component that should allow a user to increment a counter a maximum of three times.</span></span> <span data-ttu-id="627cd-272">El botón para incrementar el contador se basa condicionalmente en el valor de `count` :</span><span class="sxs-lookup"><span data-stu-id="627cd-272">The button to increment the counter is conditionally based on the value of `count`:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        count++;
    }
}
```

<span data-ttu-id="627cd-273">Un cliente puede enviar uno o varios eventos de incremento antes de que el marco de trabajo genere una nueva representación de este componente.</span><span class="sxs-lookup"><span data-stu-id="627cd-273">A client can dispatch one or more increment events before the framework produces a new render of this component.</span></span> <span data-ttu-id="627cd-274">El resultado es que el `count` usuario puede incrementar *tres veces el número de veces* que la interfaz de usuario no haya quitado el botón con la suficiente rapidez.</span><span class="sxs-lookup"><span data-stu-id="627cd-274">The result is that the `count` can be incremented *over three times* by the user because the button isn't removed by the UI quickly enough.</span></span> <span data-ttu-id="627cd-275">En el ejemplo siguiente se muestra la manera correcta de lograr el límite de tres `count` incrementos:</span><span class="sxs-lookup"><span data-stu-id="627cd-275">The correct way to achieve the limit of three `count` increments is shown in the following example:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        if (count < 3)
        {
            count++;
        }
    }
}
```

<span data-ttu-id="627cd-276">Al agregar la `if (count < 3) { ... }` comprobación dentro del controlador, la decisión de incrementar `count` se basa en el estado actual de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-276">By adding the `if (count < 3) { ... }` check inside the handler, the decision to increment `count` is based on the current app state.</span></span> <span data-ttu-id="627cd-277">La decisión no se basa en el estado de la interfaz de usuario tal como se encontraba en el ejemplo anterior, lo que podría estar temporalmente obsoleto.</span><span class="sxs-lookup"><span data-stu-id="627cd-277">The decision isn't based on the state of the UI as it was in the previous example, which might be temporarily stale.</span></span>

### <a name="guard-against-multiple-dispatches"></a><span data-ttu-id="627cd-278">Protección contra varios envíos</span><span class="sxs-lookup"><span data-stu-id="627cd-278">Guard against multiple dispatches</span></span>

<span data-ttu-id="627cd-279">Si una devolución de llamada de evento invoca de forma asincrónica una operación de ejecución prolongada, como la recuperación de datos de una base de datos o un servicio externo, considere la posibilidad de usar una protección.</span><span class="sxs-lookup"><span data-stu-id="627cd-279">If an event callback invokes a long running operation asynchronously, such as fetching data from an external service or database, consider using a guard.</span></span> <span data-ttu-id="627cd-280">La protección puede impedir que el usuario pueda poner en cola varias operaciones mientras la operación está en curso con comentarios visuales.</span><span class="sxs-lookup"><span data-stu-id="627cd-280">The guard can prevent the user from queueing up multiple operations while the operation is in progress with visual feedback.</span></span> <span data-ttu-id="627cd-281">El código de componente siguiente establece `isLoading` en `true` mientras `GetForecastAsync` obtiene datos del servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-281">The following component code sets `isLoading` to `true` while `GetForecastAsync` obtains data from the server.</span></span> <span data-ttu-id="627cd-282">Aunque `isLoading` es `true` , el botón está deshabilitado en la interfaz de usuario:</span><span class="sxs-lookup"><span data-stu-id="627cd-282">While `isLoading` is `true`, the button is disabled in the UI:</span></span>

```razor
@page "/fetchdata"
@using BlazorServerSample.Data
@inject WeatherForecastService ForecastService

<button disabled="@isLoading" @onclick="UpdateForecasts">Update</button>

@code {
    private bool isLoading;
    private WeatherForecast[] forecasts;

    private async Task UpdateForecasts()
    {
        if (!isLoading)
        {
            isLoading = true;
            forecasts = await ForecastService.GetForecastAsync(DateTime.Now);
            isLoading = false;
        }
    }
}
```

<span data-ttu-id="627cd-283">El patrón de protección que se muestra en el ejemplo anterior funciona si la operación en segundo plano se ejecuta de forma asincrónica con el `async` - `await` patrón.</span><span class="sxs-lookup"><span data-stu-id="627cd-283">The guard pattern demonstrated in the preceding example works if the background operation is executed asynchronously with the `async`-`await` pattern.</span></span>

### <a name="cancel-early-and-avoid-use-after-dispose"></a><span data-ttu-id="627cd-284">CANCELAR pronto y evitar usar-After-Dispose</span><span class="sxs-lookup"><span data-stu-id="627cd-284">Cancel early and avoid use-after-dispose</span></span>

<span data-ttu-id="627cd-285">Además de usar una protección como se describe en la sección [protección contra varias distribuciones](#guard-against-multiple-dispatches) , considere la posibilidad de usar <xref:System.Threading.CancellationToken> para cancelar operaciones de ejecución prolongada cuando se desecha el componente.</span><span class="sxs-lookup"><span data-stu-id="627cd-285">In addition to using a guard as described in the [Guard against multiple dispatches](#guard-against-multiple-dispatches) section, consider using a <xref:System.Threading.CancellationToken> to cancel long-running operations when the component is disposed.</span></span> <span data-ttu-id="627cd-286">Este enfoque tiene la ventaja adicional de evitar *usar-After-Dispose* en los componentes:</span><span class="sxs-lookup"><span data-stu-id="627cd-286">This approach has the added benefit of avoiding *use-after-dispose* in components:</span></span>

```razor
@implements IDisposable

...

@code {
    private readonly CancellationTokenSource TokenSource = 
        new CancellationTokenSource();

    private async Task UpdateForecasts()
    {
        ...

        forecasts = await ForecastService.GetForecastAsync(DateTime.Now, 
            TokenSource.Token);

        if (TokenSource.Token.IsCancellationRequested)
        {
           return;
        }

        ...
    }

    public void Dispose()
    {
        TokenSource.Cancel();
    }
}
```

### <a name="avoid-events-that-produce-large-amounts-of-data"></a><span data-ttu-id="627cd-287">Evitar eventos que generan grandes cantidades de datos</span><span class="sxs-lookup"><span data-stu-id="627cd-287">Avoid events that produce large amounts of data</span></span>

<span data-ttu-id="627cd-288">Algunos eventos DOM, como `oninput` o `onscroll` , pueden generar una gran cantidad de datos.</span><span class="sxs-lookup"><span data-stu-id="627cd-288">Some DOM events, such as `oninput` or `onscroll`, can produce a large amount of data.</span></span> <span data-ttu-id="627cd-289">Evite el uso de estos eventos en las Blazor aplicaciones de servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-289">Avoid using these events in Blazor server apps.</span></span>

## <a name="additional-security-guidance"></a><span data-ttu-id="627cd-290">Instrucciones de seguridad adicionales</span><span class="sxs-lookup"><span data-stu-id="627cd-290">Additional security guidance</span></span>

<span data-ttu-id="627cd-291">Las instrucciones para proteger ASP.NET Core aplicaciones se aplican a Blazor las aplicaciones de servidor y se describen en las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="627cd-291">The guidance for securing ASP.NET Core apps apply to Blazor Server apps and are covered in the following sections:</span></span>

* [<span data-ttu-id="627cd-292">Registro y datos confidenciales</span><span class="sxs-lookup"><span data-stu-id="627cd-292">Logging and sensitive data</span></span>](#logging-and-sensitive-data)
* [<span data-ttu-id="627cd-293">Protección de la información en tránsito con HTTPS</span><span class="sxs-lookup"><span data-stu-id="627cd-293">Protect information in transit with HTTPS</span></span>](#protect-information-in-transit-with-https)
* [<span data-ttu-id="627cd-294">Scripting entre sitios (XSS)</span><span class="sxs-lookup"><span data-stu-id="627cd-294">Cross-site scripting (XSS)</span></span>](#cross-site-scripting-xss)
* [<span data-ttu-id="627cd-295">Protección entre orígenes</span><span class="sxs-lookup"><span data-stu-id="627cd-295">Cross-origin protection</span></span>](#cross-origin-protection)
* [<span data-ttu-id="627cd-296">Hacer clic en el conector</span><span class="sxs-lookup"><span data-stu-id="627cd-296">Click-jacking</span></span>](#click-jacking)
* [<span data-ttu-id="627cd-297">Redirecciones abiertas</span><span class="sxs-lookup"><span data-stu-id="627cd-297">Open redirects</span></span>](#open-redirects)

### <a name="logging-and-sensitive-data"></a><span data-ttu-id="627cd-298">Registro y datos confidenciales</span><span class="sxs-lookup"><span data-stu-id="627cd-298">Logging and sensitive data</span></span>

<span data-ttu-id="627cd-299">Las interacciones de interoperabilidad de JS entre el cliente y el servidor se registran en los registros del servidor con <xref:Microsoft.Extensions.Logging.ILogger> instancias.</span><span class="sxs-lookup"><span data-stu-id="627cd-299">JS interop interactions between the client and server are recorded in the server's logs with <xref:Microsoft.Extensions.Logging.ILogger> instances.</span></span> Blazor<span data-ttu-id="627cd-300">evita el registro de información confidencial, como eventos reales o entradas y salidas de interoperabilidad de JS.</span><span class="sxs-lookup"><span data-stu-id="627cd-300"> avoids logging sensitive information, such as actual events or JS interop inputs and outputs.</span></span>

<span data-ttu-id="627cd-301">Cuando se produce un error en el servidor, el marco de trabajo notifica al cliente y anula la sesión.</span><span class="sxs-lookup"><span data-stu-id="627cd-301">When an error occurs on the server, the framework notifies the client and tears down the session.</span></span> <span data-ttu-id="627cd-302">De forma predeterminada, el cliente recibe un mensaje de error genérico que puede verse en las herramientas de desarrollo del explorador.</span><span class="sxs-lookup"><span data-stu-id="627cd-302">By default, the client receives a generic error message that can be seen in the browser's developer tools.</span></span>

<span data-ttu-id="627cd-303">El error del lado cliente no incluye la pila de llamadas y no proporciona detalles sobre la causa del error, pero los registros del servidor contienen esa información.</span><span class="sxs-lookup"><span data-stu-id="627cd-303">The client-side error doesn't include the callstack and doesn't provide detail on the cause of the error, but server logs do contain such information.</span></span> <span data-ttu-id="627cd-304">Para fines de desarrollo, la información de errores confidenciales puede ponerse a disposición del cliente mediante la habilitación de errores detallados.</span><span class="sxs-lookup"><span data-stu-id="627cd-304">For development purposes, sensitive error information can be made available to the client by enabling detailed errors.</span></span>

<span data-ttu-id="627cd-305">Habilitar errores detallados en JavaScript con:</span><span class="sxs-lookup"><span data-stu-id="627cd-305">Enable detailed errors in JavaScript with:</span></span>

* <span data-ttu-id="627cd-306"><xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DetailedErrors?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="627cd-306"><xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DetailedErrors?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="627cd-307">La `DetailedErrors` clave de configuración establecida en `true` , que se puede establecer en el archivo de configuración de la aplicación (*appSettings. JSON*).</span><span class="sxs-lookup"><span data-stu-id="627cd-307">The `DetailedErrors` configuration key set to `true`, which can be set in the app settings file (*appsettings.json*).</span></span> <span data-ttu-id="627cd-308">La clave también se puede establecer mediante la `ASPNETCORE_DETAILEDERRORS` variable de entorno con un valor de `true` .</span><span class="sxs-lookup"><span data-stu-id="627cd-308">The key can also be set using the `ASPNETCORE_DETAILEDERRORS` environment variable with a value of `true`.</span></span>

> [!WARNING]
> <span data-ttu-id="627cd-309">Exponer información de errores a los clientes de Internet es un riesgo de seguridad que siempre debe evitarse.</span><span class="sxs-lookup"><span data-stu-id="627cd-309">Exposing error information to clients on the Internet is a security risk that should always be avoided.</span></span>

### <a name="protect-information-in-transit-with-https"></a><span data-ttu-id="627cd-310">Protección de la información en tránsito con HTTPS</span><span class="sxs-lookup"><span data-stu-id="627cd-310">Protect information in transit with HTTPS</span></span>

Blazor<span data-ttu-id="627cd-311">El servidor usa SignalR para la comunicación entre el cliente y el servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-311"> Server uses SignalR for communication between the client and the server.</span></span> Blazor<span data-ttu-id="627cd-312">Normalmente, el servidor usa el transporte que SignalR negocia, que suele ser WebSockets.</span><span class="sxs-lookup"><span data-stu-id="627cd-312"> Server normally uses the transport that SignalR negotiates, which is typically WebSockets.</span></span>

Blazor<span data-ttu-id="627cd-313">El servidor no garantiza la integridad y confidencialidad de los datos enviados entre el servidor y el cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-313"> Server doesn't ensure the integrity and confidentiality of the data sent between the server and the client.</span></span> <span data-ttu-id="627cd-314">Use siempre HTTPS.</span><span class="sxs-lookup"><span data-stu-id="627cd-314">Always use HTTPS.</span></span>

### <a name="cross-site-scripting-xss"></a><span data-ttu-id="627cd-315">Scripting entre sitios (XSS)</span><span class="sxs-lookup"><span data-stu-id="627cd-315">Cross-site scripting (XSS)</span></span>

<span data-ttu-id="627cd-316">El scripting entre sitios (XSS) permite que una entidad no autorizada ejecute una lógica arbitraria en el contexto del explorador.</span><span class="sxs-lookup"><span data-stu-id="627cd-316">Cross-site scripting (XSS) allows an unauthorized party to execute arbitrary logic in the context of the browser.</span></span> <span data-ttu-id="627cd-317">Una aplicación en peligro podría ejecutar código arbitrario en el cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-317">A compromised app could potentially run arbitrary code on the client.</span></span> <span data-ttu-id="627cd-318">La vulnerabilidad podría usarse para realizar una serie de acciones malintencionadas en el servidor:</span><span class="sxs-lookup"><span data-stu-id="627cd-318">The vulnerability could be used to potentially perform a number of malicious actions against the server:</span></span>

* <span data-ttu-id="627cd-319">Envíe eventos falsos o no válidos al servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-319">Dispatch fake/invalid events to the server.</span></span>
* <span data-ttu-id="627cd-320">Errores de envío o finalizaciones de representación no válidas.</span><span class="sxs-lookup"><span data-stu-id="627cd-320">Dispatch fail/invalid render completions.</span></span>
* <span data-ttu-id="627cd-321">Evite enviar las finalizaciones de representación.</span><span class="sxs-lookup"><span data-stu-id="627cd-321">Avoid dispatching render completions.</span></span>
* <span data-ttu-id="627cd-322">Envío de llamadas de interoperabilidad desde JavaScript a .NET.</span><span class="sxs-lookup"><span data-stu-id="627cd-322">Dispatch interop calls from JavaScript to .NET.</span></span>
* <span data-ttu-id="627cd-323">Modifique la respuesta de las llamadas de interoperabilidad de .NET a JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-323">Modify the response of interop calls from .NET to JavaScript.</span></span>
* <span data-ttu-id="627cd-324">Evite el envío de resultados de interoperabilidad de .NET a JS.</span><span class="sxs-lookup"><span data-stu-id="627cd-324">Avoid dispatching .NET to JS interop results.</span></span>

<span data-ttu-id="627cd-325">El Blazor marco de trabajo de servidor toma medidas para protegerse frente a algunas de las amenazas anteriores:</span><span class="sxs-lookup"><span data-stu-id="627cd-325">The Blazor Server framework takes steps to protect against some of the preceding threats:</span></span>

* <span data-ttu-id="627cd-326">Detiene la generación de nuevas actualizaciones de la interfaz de usuario si el cliente no reconoce los lotes de representación.</span><span class="sxs-lookup"><span data-stu-id="627cd-326">Stops producing new UI updates if the client isn't acknowledging render batches.</span></span> <span data-ttu-id="627cd-327">Configurado con <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="627cd-327">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="627cd-328">Agota el tiempo de espera cualquier llamada de .NET a JavaScript después de un minuto sin recibir una respuesta del cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-328">Times out any .NET to JavaScript call after one minute without receiving a response from the client.</span></span> <span data-ttu-id="627cd-329">Configurado con <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="627cd-329">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="627cd-330">Realiza la validación básica de todas las entradas procedentes del explorador durante la interoperabilidad de JS:</span><span class="sxs-lookup"><span data-stu-id="627cd-330">Performs basic validation on all input coming from the browser during JS interop:</span></span>
  * <span data-ttu-id="627cd-331">Las referencias de .NET son válidas y del tipo esperado por el método de .NET.</span><span class="sxs-lookup"><span data-stu-id="627cd-331">.NET references are valid and of the type expected by the .NET method.</span></span>
  * <span data-ttu-id="627cd-332">Los datos no tienen un formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="627cd-332">The data isn't malformed.</span></span>
  * <span data-ttu-id="627cd-333">El número correcto de argumentos para el método está presente en la carga.</span><span class="sxs-lookup"><span data-stu-id="627cd-333">The correct number of arguments for the method are present in the payload.</span></span>
  * <span data-ttu-id="627cd-334">Los argumentos o el resultado se pueden deserializar correctamente antes de invocar el método.</span><span class="sxs-lookup"><span data-stu-id="627cd-334">The arguments or result can be deserialized correctly before invoking the method.</span></span>
* <span data-ttu-id="627cd-335">Realiza la validación básica en todas las entradas procedentes del explorador de los eventos enviados:</span><span class="sxs-lookup"><span data-stu-id="627cd-335">Performs basic validation in all input coming from the browser from dispatched events:</span></span>
  * <span data-ttu-id="627cd-336">El evento tiene un tipo válido.</span><span class="sxs-lookup"><span data-stu-id="627cd-336">The event has a valid type.</span></span>
  * <span data-ttu-id="627cd-337">Los datos para el evento se pueden deserializar.</span><span class="sxs-lookup"><span data-stu-id="627cd-337">The data for the event can be deserialized.</span></span>
  * <span data-ttu-id="627cd-338">Hay un controlador de eventos asociado al evento.</span><span class="sxs-lookup"><span data-stu-id="627cd-338">There's an event handler associated with the event.</span></span>

<span data-ttu-id="627cd-339">Además de las medidas de seguridad que implementa el marco, el desarrollador debe codificar la aplicación para protegerse frente a las amenazas y tomar las medidas adecuadas:</span><span class="sxs-lookup"><span data-stu-id="627cd-339">In addition to the safeguards that the framework implements, the app must be coded by the developer to safeguard against threats and take appropriate actions:</span></span>

* <span data-ttu-id="627cd-340">Valide siempre los datos al controlar los eventos.</span><span class="sxs-lookup"><span data-stu-id="627cd-340">Always validate data when handling events.</span></span>
* <span data-ttu-id="627cd-341">Tomar las medidas adecuadas al recibir datos no válidos:</span><span class="sxs-lookup"><span data-stu-id="627cd-341">Take appropriate action upon receiving invalid data:</span></span>
  * <span data-ttu-id="627cd-342">Omitir los datos y devolverlos.</span><span class="sxs-lookup"><span data-stu-id="627cd-342">Ignore the data and return.</span></span> <span data-ttu-id="627cd-343">Esto permite que la aplicación siga procesando las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="627cd-343">This allows the app to continue processing requests.</span></span>
  * <span data-ttu-id="627cd-344">Si la aplicación determina que la entrada es ilegítimo y no se pudo producir por un cliente legítimo, inicie una excepción.</span><span class="sxs-lookup"><span data-stu-id="627cd-344">If the app determines that the input is illegitimate and couldn't be produced by legitimate client, throw an exception.</span></span> <span data-ttu-id="627cd-345">Producir una excepción anula el circuito y finaliza la sesión.</span><span class="sxs-lookup"><span data-stu-id="627cd-345">Throwing an exception tears down the circuit and ends the session.</span></span>
* <span data-ttu-id="627cd-346">No confíe en el mensaje de error proporcionado por las finalizaciones de procesamiento por lotes incluidas en los registros.</span><span class="sxs-lookup"><span data-stu-id="627cd-346">Don't trust the error message provided by render batch completions included in the logs.</span></span> <span data-ttu-id="627cd-347">El cliente proporciona el error y, por lo general, no se puede confiar en él, ya que es posible que el cliente esté en peligro.</span><span class="sxs-lookup"><span data-stu-id="627cd-347">The error is provided by the client and can't generally be trusted, as the client might be compromised.</span></span>
* <span data-ttu-id="627cd-348">No confíe en la entrada en las llamadas de interoperabilidad de JS en ambas direcciones entre los métodos de .NET y JavaScript.</span><span class="sxs-lookup"><span data-stu-id="627cd-348">Don't trust the input on JS interop calls in either direction between JavaScript and .NET methods.</span></span>
* <span data-ttu-id="627cd-349">La aplicación es responsable de validar que el contenido de los argumentos y los resultados son válidos, incluso si los argumentos o resultados se deserializan correctamente.</span><span class="sxs-lookup"><span data-stu-id="627cd-349">The app is responsible for validating that the content of arguments and results are valid, even if the arguments or results are correctly deserialized.</span></span>

<span data-ttu-id="627cd-350">Para que exista una vulnerabilidad de XSS, la aplicación debe incorporar los datos proporcionados por el usuario en la página representada.</span><span class="sxs-lookup"><span data-stu-id="627cd-350">For a XSS vulnerability to exist, the app must incorporate user input in the rendered page.</span></span> Blazor<span data-ttu-id="627cd-351">Los componentes de servidor ejecutan un paso en tiempo de compilación en el que el marcado de un archivo *. Razor* se transforma en una lógica de C# de procedimientos.</span><span class="sxs-lookup"><span data-stu-id="627cd-351"> Server components execute a compile-time step where the markup in a *.razor* file is transformed into procedural C# logic.</span></span> <span data-ttu-id="627cd-352">En tiempo de ejecución, la lógica de C# crea un *árbol de representación* que describe los elementos, el texto y los componentes secundarios.</span><span class="sxs-lookup"><span data-stu-id="627cd-352">At runtime, the C# logic builds a *render tree* describing the elements, text, and child components.</span></span> <span data-ttu-id="627cd-353">Esto se aplica al DOM del explorador a través de una secuencia de instrucciones de JavaScript (o se serializa a HTML en el caso de la representación previa):</span><span class="sxs-lookup"><span data-stu-id="627cd-353">This is applied to the browser's DOM via a sequence of JavaScript instructions (or is serialized to HTML in the case of prerendering):</span></span>

* <span data-ttu-id="627cd-354">Los datos proporcionados por el usuario mediante Razor la sintaxis normal (por ejemplo, `@someStringValue` ) no exponen una vulnerabilidad de XSS porque la Razor sintaxis se agrega al Dom a través de comandos que solo pueden escribir texto.</span><span class="sxs-lookup"><span data-stu-id="627cd-354">User input rendered via normal Razor syntax (for example, `@someStringValue`) doesn't expose a XSS vulnerability because the Razor syntax is added to the DOM via commands that can only write text.</span></span> <span data-ttu-id="627cd-355">Aunque el valor incluya el marcado HTML, el valor se muestra como texto estático.</span><span class="sxs-lookup"><span data-stu-id="627cd-355">Even if the value includes HTML markup, the value is displayed as static text.</span></span> <span data-ttu-id="627cd-356">Al prerepresentar, la salida está codificada en HTML, que también muestra el contenido como texto estático.</span><span class="sxs-lookup"><span data-stu-id="627cd-356">When prerendering, the output is HTML-encoded, which also displays the content as static text.</span></span>
* <span data-ttu-id="627cd-357">No se permiten etiquetas de script y no deben incluirse en el árbol de representación de componentes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-357">Script tags aren't allowed and shouldn't be included in the app's component render tree.</span></span> <span data-ttu-id="627cd-358">Si se incluye una etiqueta de script en el marcado de un componente, se genera un error en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="627cd-358">If a script tag is included in a component's markup, a compile-time error is generated.</span></span>
* <span data-ttu-id="627cd-359">Los autores de componentes pueden crear componentes en C# sin usar Razor .</span><span class="sxs-lookup"><span data-stu-id="627cd-359">Component authors can author components in C# without using Razor.</span></span> <span data-ttu-id="627cd-360">El autor del componente es responsable de usar las API correctas al emitir la salida.</span><span class="sxs-lookup"><span data-stu-id="627cd-360">The component author is responsible for using the correct APIs when emitting output.</span></span> <span data-ttu-id="627cd-361">Por ejemplo, use `builder.AddContent(0, someUserSuppliedString)` y *Not* `builder.AddMarkupContent(0, someUserSuppliedString)` , ya que el último podría crear una vulnerabilidad XSS.</span><span class="sxs-lookup"><span data-stu-id="627cd-361">For example, use `builder.AddContent(0, someUserSuppliedString)` and *not* `builder.AddMarkupContent(0, someUserSuppliedString)`, as the latter could create a XSS vulnerability.</span></span>

<span data-ttu-id="627cd-362">Como parte de la protección contra ataques XSS, considere la posibilidad de implementar mitigaciones XSS, como la [Directiva de seguridad de contenido (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span><span class="sxs-lookup"><span data-stu-id="627cd-362">As part of protecting against XSS attacks, consider implementing XSS mitigations, such as [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span></span>

<span data-ttu-id="627cd-363">Para obtener más información, vea <xref:security/cross-site-scripting>.</span><span class="sxs-lookup"><span data-stu-id="627cd-363">For more information, see <xref:security/cross-site-scripting>.</span></span>

### <a name="cross-origin-protection"></a><span data-ttu-id="627cd-364">Protección entre orígenes</span><span class="sxs-lookup"><span data-stu-id="627cd-364">Cross-origin protection</span></span>

<span data-ttu-id="627cd-365">Los ataques entre orígenes implican a un cliente de un origen diferente que realiza una acción en el servidor.</span><span class="sxs-lookup"><span data-stu-id="627cd-365">Cross-origin attacks involve a client from a different origin performing an action against the server.</span></span> <span data-ttu-id="627cd-366">La acción malintencionada es normalmente una solicitud GET o un POST de formulario (falsificación de solicitud entre sitios, CSRF), pero también es posible abrir un WebSocket malintencionado.</span><span class="sxs-lookup"><span data-stu-id="627cd-366">The malicious action is typically a GET request or a form POST (Cross-Site Request Forgery, CSRF), but opening a malicious WebSocket is also possible.</span></span> Blazor<span data-ttu-id="627cd-367">Las aplicaciones de servidor ofrecen [las mismas garantías de que cualquier otra SignalR aplicación que use el protocolo de concentrador ofrece](xref:signalr/security):</span><span class="sxs-lookup"><span data-stu-id="627cd-367"> Server apps offer [the same guarantees that any other SignalR app using the hub protocol offer](xref:signalr/security):</span></span>

* Blazor<span data-ttu-id="627cd-368">Se puede acceder a las aplicaciones de servidor entre orígenes, a menos que se tomen medidas adicionales para evitarlo.</span><span class="sxs-lookup"><span data-stu-id="627cd-368"> Server apps can be accessed cross-origin unless additional measures are taken to prevent it.</span></span> <span data-ttu-id="627cd-369">Para deshabilitar el acceso entre orígenes, deshabilite CORS en el punto de conexión agregando el middleware de CORS a la canalización y agregando <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> a los Blazor metadatos del punto de conexión o limite el conjunto de orígenes permitidos mediante la [configuración SignalR para el uso compartido de recursos entre orígenes](xref:signalr/security#cross-origin-resource-sharing).</span><span class="sxs-lookup"><span data-stu-id="627cd-369">To disable cross-origin access, either disable CORS in the endpoint by adding the CORS middleware to the pipeline and adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> to the Blazor endpoint metadata or limit the set of allowed origins by [configuring SignalR for cross-origin resource sharing](xref:signalr/security#cross-origin-resource-sharing).</span></span>
* <span data-ttu-id="627cd-370">Si CORS está habilitado, podrían ser necesarios pasos adicionales para proteger la aplicación en función de la configuración de CORS.</span><span class="sxs-lookup"><span data-stu-id="627cd-370">If CORS is enabled, extra steps might be required to protect the app depending on the CORS configuration.</span></span> <span data-ttu-id="627cd-371">Si CORS está habilitado globalmente, CORS se puede deshabilitar para el Blazor concentrador de servidor agregando los <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> metadatos a los metadatos del punto de conexión después de llamar a <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> en el generador de rutas de extremo.</span><span class="sxs-lookup"><span data-stu-id="627cd-371">If CORS is globally enabled, CORS can be disabled for the Blazor Server hub by adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> metadata to the endpoint metadata after calling <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> on the endpoint route builder.</span></span>

<span data-ttu-id="627cd-372">Para obtener más información, vea <xref:security/anti-request-forgery>.</span><span class="sxs-lookup"><span data-stu-id="627cd-372">For more information, see <xref:security/anti-request-forgery>.</span></span>

### <a name="click-jacking"></a><span data-ttu-id="627cd-373">Hacer clic en el conector</span><span class="sxs-lookup"><span data-stu-id="627cd-373">Click-jacking</span></span>

<span data-ttu-id="627cd-374">La toma de clics implica representar un sitio como dentro de un `<iframe>` sitio de un origen diferente para engañar al usuario en la realización de acciones en el sitio bajo ataque.</span><span class="sxs-lookup"><span data-stu-id="627cd-374">Click-jacking involves rendering a site as an `<iframe>` inside a site from a different origin in order to trick the user into performing actions on the site under attack.</span></span>

<span data-ttu-id="627cd-375">Para proteger una aplicación de la representación dentro de una `<iframe>` , usa la [Directiva de seguridad de contenido (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) y el `X-Frame-Options` encabezado.</span><span class="sxs-lookup"><span data-stu-id="627cd-375">To protect an app from rendering inside of an `<iframe>`, use [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) and the `X-Frame-Options` header.</span></span> <span data-ttu-id="627cd-376">Para obtener más información, vea [MDN web docs: X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span><span class="sxs-lookup"><span data-stu-id="627cd-376">For more information, see [MDN web docs: X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span></span>

### <a name="open-redirects"></a><span data-ttu-id="627cd-377">Redirecciones abiertas</span><span class="sxs-lookup"><span data-stu-id="627cd-377">Open redirects</span></span>

<span data-ttu-id="627cd-378">Cuando Blazor se inicia una sesión de aplicación de servidor, el servidor realiza la validación básica de las direcciones URL que se envían como parte del inicio de la sesión.</span><span class="sxs-lookup"><span data-stu-id="627cd-378">When a Blazor Server app session starts, the server performs basic validation of the URLs sent as part of starting the session.</span></span> <span data-ttu-id="627cd-379">El marco comprueba que la dirección URL base es un elemento primario de la dirección URL actual antes de establecer el circuito.</span><span class="sxs-lookup"><span data-stu-id="627cd-379">The framework checks that the base URL is a parent of the current URL before establishing the circuit.</span></span> <span data-ttu-id="627cd-380">El marco de trabajo no realiza ninguna comprobación adicional.</span><span class="sxs-lookup"><span data-stu-id="627cd-380">No additional checks are performed by the framework.</span></span>

<span data-ttu-id="627cd-381">Cuando un usuario selecciona un vínculo en el cliente, la dirección URL del vínculo se envía al servidor, lo que determina la acción que se debe realizar.</span><span class="sxs-lookup"><span data-stu-id="627cd-381">When a user selects a link on the client, the URL for the link is sent to the server, which determines what action to take.</span></span> <span data-ttu-id="627cd-382">Por ejemplo, la aplicación puede realizar una navegación en el lado cliente o indicar al explorador que vaya a la nueva ubicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-382">For example, the app may perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="627cd-383">Los componentes también pueden desencadenar solicitudes de navegación mediante programación a través del uso de <xref:Microsoft.AspNetCore.Components.NavigationManager> .</span><span class="sxs-lookup"><span data-stu-id="627cd-383">Components can also trigger navigation requests programatically through the use of <xref:Microsoft.AspNetCore.Components.NavigationManager>.</span></span> <span data-ttu-id="627cd-384">En estos casos, la aplicación puede realizar una navegación del lado cliente o indicar al explorador que vaya a la nueva ubicación.</span><span class="sxs-lookup"><span data-stu-id="627cd-384">In such scenarios, the app might perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="627cd-385">Los componentes deben:</span><span class="sxs-lookup"><span data-stu-id="627cd-385">Components must:</span></span>

* <span data-ttu-id="627cd-386">Evite el uso de datos proporcionados por el usuario como parte de los argumentos de la llamada de navegación.</span><span class="sxs-lookup"><span data-stu-id="627cd-386">Avoid using user input as part of the navigation call arguments.</span></span>
* <span data-ttu-id="627cd-387">Valide los argumentos para asegurarse de que la aplicación permite el destino.</span><span class="sxs-lookup"><span data-stu-id="627cd-387">Validate arguments to ensure that the target is allowed by the app.</span></span>

<span data-ttu-id="627cd-388">De lo contrario, un usuario malintencionado puede forzar al explorador para que vaya a un sitio controlado por un atacante.</span><span class="sxs-lookup"><span data-stu-id="627cd-388">Otherwise, a malicious user can force the browser to go to an attacker-controlled site.</span></span> <span data-ttu-id="627cd-389">En este escenario, el atacante engaña a la aplicación para que use algunos datos proporcionados por el usuario como parte de la invocación del <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="627cd-389">In this scenario, the attacker tricks the app into using some user input as part of the invocation of the <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="627cd-390">Este Consejo también se aplica cuando se representan vínculos como parte de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="627cd-390">This advice also applies when rendering links as part of the app:</span></span>

* <span data-ttu-id="627cd-391">Si es posible, use vínculos relativos.</span><span class="sxs-lookup"><span data-stu-id="627cd-391">If possible, use relative links.</span></span>
* <span data-ttu-id="627cd-392">Compruebe que los destinos absolutos de los vínculos son válidos antes de incluirlos en una página.</span><span class="sxs-lookup"><span data-stu-id="627cd-392">Validate that absolute link destinations are valid before including them in a page.</span></span>

<span data-ttu-id="627cd-393">Para obtener más información, vea <xref:security/preventing-open-redirects>.</span><span class="sxs-lookup"><span data-stu-id="627cd-393">For more information, see <xref:security/preventing-open-redirects>.</span></span>

## <a name="security-checklist"></a><span data-ttu-id="627cd-394">Lista de comprobación de seguridad</span><span class="sxs-lookup"><span data-stu-id="627cd-394">Security checklist</span></span>

<span data-ttu-id="627cd-395">La siguiente lista de consideraciones de seguridad no es completa:</span><span class="sxs-lookup"><span data-stu-id="627cd-395">The following list of security considerations isn't comprehensive:</span></span>

* <span data-ttu-id="627cd-396">Validar argumentos de eventos.</span><span class="sxs-lookup"><span data-stu-id="627cd-396">Validate arguments from events.</span></span>
* <span data-ttu-id="627cd-397">Valide las entradas y los resultados de las llamadas de interoperabilidad de JS.</span><span class="sxs-lookup"><span data-stu-id="627cd-397">Validate inputs and results from JS interop calls.</span></span>
* <span data-ttu-id="627cd-398">Evite usar (o validar previamente) la entrada del usuario para las llamadas de interoperabilidad de .NET a JS.</span><span class="sxs-lookup"><span data-stu-id="627cd-398">Avoid using (or validate beforehand) user input for .NET to JS interop calls.</span></span>
* <span data-ttu-id="627cd-399">Impedir que el cliente asigne una cantidad de memoria sin enlazar.</span><span class="sxs-lookup"><span data-stu-id="627cd-399">Prevent the client from allocating an unbound amount of memory.</span></span>
  * <span data-ttu-id="627cd-400">Datos dentro del componente.</span><span class="sxs-lookup"><span data-stu-id="627cd-400">Data within the component.</span></span>
  * <span data-ttu-id="627cd-401">`DotNetObject`referencias devueltas al cliente.</span><span class="sxs-lookup"><span data-stu-id="627cd-401">`DotNetObject` references returned to the client.</span></span>
* <span data-ttu-id="627cd-402">Protéjase contra varios envíos.</span><span class="sxs-lookup"><span data-stu-id="627cd-402">Guard against multiple dispatches.</span></span>
* <span data-ttu-id="627cd-403">Cancela las operaciones de ejecución prolongada cuando se desecha el componente.</span><span class="sxs-lookup"><span data-stu-id="627cd-403">Cancel long-running operations when the component is disposed.</span></span>
* <span data-ttu-id="627cd-404">Evite eventos que generen grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="627cd-404">Avoid events that produce large amounts of data.</span></span>
* <span data-ttu-id="627cd-405">Evite el uso de datos proporcionados por el usuario como parte de las llamadas a <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> y valide primero los datos proporcionados por el usuario para las direcciones URL en un conjunto de orígenes permitidos si no se puede evitar.</span><span class="sxs-lookup"><span data-stu-id="627cd-405">Avoid using user input as part of calls to <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> and validate user input for URLs against a set of allowed origins first if unavoidable.</span></span>
* <span data-ttu-id="627cd-406">No tome decisiones de autorización basadas en el estado de la interfaz de usuario, sino solo en el estado del componente.</span><span class="sxs-lookup"><span data-stu-id="627cd-406">Don't make authorization decisions based on the state of the UI but only from component state.</span></span>
* <span data-ttu-id="627cd-407">Considere la posibilidad de usar la [Directiva de seguridad de contenido (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) para protegerse frente a ataques XSS.</span><span class="sxs-lookup"><span data-stu-id="627cd-407">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to protect against XSS attacks.</span></span>
* <span data-ttu-id="627cd-408">Considere la posibilidad de usar CSP y [X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) para protegerse frente a clics.</span><span class="sxs-lookup"><span data-stu-id="627cd-408">Consider using CSP and [X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) to protect against click-jacking.</span></span>
* <span data-ttu-id="627cd-409">Asegúrese de que la configuración de CORS sea adecuada al habilitar CORS o deshabilitar de forma explícita CORS para las Blazor aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="627cd-409">Ensure CORS settings are appropriate when enabling CORS or explicitly disable CORS for Blazor apps.</span></span>
* <span data-ttu-id="627cd-410">Pruebe para asegurarse de que los límites del lado servidor de la Blazor aplicación proporcionan una experiencia de usuario aceptable sin niveles inaceptables de riesgo.</span><span class="sxs-lookup"><span data-stu-id="627cd-410">Test to ensure that the server-side limits for the Blazor app provide an acceptable user experience without unacceptable levels of risk.</span></span>
