---
title: Enrutamiento en ASP.NET Core
author: rick-anderson
description: Descubra cómo el enrutamiento de ASP.NET Core es responsable de hacer coincidir las solicitudes HTTP, así como del envío a puntos de conexión ejecutables.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 4/1/2020
no-loc:
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: fundamentals/routing
ms.openlocfilehash: fcf79966abf7a023773ef892636530278b668c44
ms.sourcegitcommit: 5a36758cca2861aeb10840093e46d273a6e6e91d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/28/2020
ms.locfileid: "87303617"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="69012-103">Enrutamiento en ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="69012-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="69012-104">Por [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5) y [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="69012-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="69012-105">El enrutamiento es responsable de hacer coincidir las solicitudes HTTP entrantes y de enviarlas a los puntos de conexión ejecutables de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="69012-106">Los [puntos de conexión](#endpoint) son las unidades de código de control de solicitudes ejecutable de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="69012-107">Se definen en la aplicación y se configuran al iniciarla.</span><span class="sxs-lookup"><span data-stu-id="69012-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="69012-108">El proceso de búsqueda de coincidencias de puntos de conexión puede extraer valores de la dirección URL de la solicitud y proporcionarlos para el procesamiento de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="69012-109">Con la información de los puntos de conexión de la aplicación, el enrutamiento también puede generar direcciones URL que se asignan a los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="69012-110">Las aplicaciones pueden configurar el enrutamiento mediante:</span><span class="sxs-lookup"><span data-stu-id="69012-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="69012-111">Controladores</span><span class="sxs-lookup"><span data-stu-id="69012-111">Controllers</span></span>
- <span data-ttu-id="69012-112">Razor Pages</span><span class="sxs-lookup"><span data-stu-id="69012-112">Razor Pages</span></span>
- SignalR
- <span data-ttu-id="69012-113">Servicios gRPC</span><span class="sxs-lookup"><span data-stu-id="69012-113">gRPC Services</span></span>
- <span data-ttu-id="69012-114">[Middleware](xref:fundamentals/middleware/index) habilitado para puntos de conexión, como las [comprobaciones de estado](xref:host-and-deploy/health-checks).</span><span class="sxs-lookup"><span data-stu-id="69012-114">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="69012-115">Delegados y expresiones lambda registrados con el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-115">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="69012-116">En este documento se describen los detalles de bajo nivel del enrutamiento de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="69012-116">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="69012-117">Para obtener información sobre la configuración del enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-117">For information on configuring routing:</span></span>

* <span data-ttu-id="69012-118">Para los controladores, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="69012-118">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="69012-119">Para las convenciones de Razor Pages, vea <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="69012-119">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="69012-120">El sistema de enrutamiento de puntos de conexión descrito en este documento se aplica a ASP.NET Core 3.0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="69012-120">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="69012-121">Para obtener información sobre el sistema de enrutamiento anterior basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, seleccione la versión ASP.NET Core 2.1 mediante uno de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-121">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="69012-122">El selector de versión de una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-122">The version selector for a previous version.</span></span>
* <span data-ttu-id="69012-123">Seleccione [Enrutamiento de ASP.NET Core 2.1](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="69012-123">Select [ASP.NET Core 2.1 routing](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="69012-124">[Vea o descargue el código de ejemplo](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="69012-124">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="69012-125">Los ejemplos de descarga para este documento están habilitados por una clase `Startup` específica.</span><span class="sxs-lookup"><span data-stu-id="69012-125">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="69012-126">Para ejecutar un ejemplo concreto, modifique *Program.cs* para llamar a la clase `Startup` deseada.</span><span class="sxs-lookup"><span data-stu-id="69012-126">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="69012-127">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-127">Routing basics</span></span>

<span data-ttu-id="69012-128">Todas las plantillas de ASP.NET Core incluyen el enrutamiento en el código generado.</span><span class="sxs-lookup"><span data-stu-id="69012-128">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="69012-129">El enrutamiento se registra en la canalización de [middleware](xref:fundamentals/middleware/index) en `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="69012-129">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="69012-130">En el código siguiente se muestra un ejemplo básico de enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-130">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="69012-131">El enrutamiento usa un par de middleware, registrado por <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> y <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span><span class="sxs-lookup"><span data-stu-id="69012-131">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="69012-132">`UseRouting` agrega coincidencia de rutas a la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="69012-132">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="69012-133">Este middleware examina el conjunto de puntos de conexión definidos en la aplicación y selecciona la [mejor coincidencia](#urlm) en función de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-133">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="69012-134">`UseEndpoints` agrega la ejecución del punto de conexión a la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="69012-134">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="69012-135">Ejecuta el delegado asociado al punto de conexión seleccionado.</span><span class="sxs-lookup"><span data-stu-id="69012-135">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="69012-136">En el ejemplo anterior se incluye un único punto de conexión de *ruta a código* a través del método [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*):</span><span class="sxs-lookup"><span data-stu-id="69012-136">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="69012-137">Al enviar una solicitud HTTP `GET` a la dirección URL raíz `/`:</span><span class="sxs-lookup"><span data-stu-id="69012-137">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="69012-138">Se ejecuta el delegado de solicitud mostrado.</span><span class="sxs-lookup"><span data-stu-id="69012-138">The request delegate shown executes.</span></span>
  * <span data-ttu-id="69012-139">Se escribe `Hello World!` en la respuesta HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-139">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="69012-140">De forma predeterminada, la dirección URL raíz `/` es `https://localhost:5001/`.</span><span class="sxs-lookup"><span data-stu-id="69012-140">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="69012-141">Si el método de solicitud no es `GET` o la dirección URL raíz no es `/`, no se detecta ninguna ruta y se devuelve HTTP 404.</span><span class="sxs-lookup"><span data-stu-id="69012-141">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="69012-142">punto de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-142">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="69012-143">El método `MapGet` se usa para definir un **punto de conexión**.</span><span class="sxs-lookup"><span data-stu-id="69012-143">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="69012-144">Un punto de conexión es algo que se puede:</span><span class="sxs-lookup"><span data-stu-id="69012-144">An endpoint is something that can be:</span></span>

* <span data-ttu-id="69012-145">Seleccionar, si se hacen coincidir la dirección URL y el método HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-145">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="69012-146">Ejecutar, mediante la ejecución del delegado.</span><span class="sxs-lookup"><span data-stu-id="69012-146">Executed, by running the delegate.</span></span>

<span data-ttu-id="69012-147">Los puntos de conexión que la aplicación puede ejecutar y hacer coincidir se configuran en `UseEndpoints`.</span><span class="sxs-lookup"><span data-stu-id="69012-147">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="69012-148">Por ejemplo, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*> y [métodos similares](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) conectan delegados de solicitud al sistema de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-148">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="69012-149">Se pueden usar métodos adicionales para conectar características del marco ASP.NET Core al sistema de enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-149">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- <span data-ttu-id="69012-150">[MapRazorPages para Razor Pages](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)</span><span class="sxs-lookup"><span data-stu-id="69012-150">[MapRazorPages for Razor Pages](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)</span></span>
- [<span data-ttu-id="69012-151">MapControllers para controladores</span><span class="sxs-lookup"><span data-stu-id="69012-151">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- <span data-ttu-id="69012-152">[MapHub\<THub> para SignalR](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*)</span><span class="sxs-lookup"><span data-stu-id="69012-152">[MapHub\<THub> for SignalR](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*)</span></span> 
- [<span data-ttu-id="69012-153">MapGrpcService\<TService> para gRPC</span><span class="sxs-lookup"><span data-stu-id="69012-153">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="69012-154">En el ejemplo siguiente se muestra el enrutamiento con una plantilla de ruta más sofisticada:</span><span class="sxs-lookup"><span data-stu-id="69012-154">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="69012-155">La cadena `/hello/{name:alpha}` es una **plantilla de ruta**.</span><span class="sxs-lookup"><span data-stu-id="69012-155">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="69012-156">Se usa para configurar cómo se hace coincidir el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-156">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="69012-157">En este caso, la plantilla coincide con:</span><span class="sxs-lookup"><span data-stu-id="69012-157">In this case, the template matches:</span></span>

* <span data-ttu-id="69012-158">Una dirección URL como `/hello/Ryan`.</span><span class="sxs-lookup"><span data-stu-id="69012-158">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="69012-159">Cualquier ruta de dirección URL que comience por `/hello/`, seguido de una secuencia de caracteres alfabéticos.</span><span class="sxs-lookup"><span data-stu-id="69012-159">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="69012-160">`:alpha` aplica una restricción de ruta que solo coincide con caracteres alfabéticos.</span><span class="sxs-lookup"><span data-stu-id="69012-160">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="69012-161">Las [restricciones de ruta](#route-constraint-reference) se explican más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="69012-161">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="69012-162">El segundo segmento de la ruta de dirección URL, `{name:alpha}`:</span><span class="sxs-lookup"><span data-stu-id="69012-162">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="69012-163">Está enlazado al parámetro `name`.</span><span class="sxs-lookup"><span data-stu-id="69012-163">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="69012-164">Se captura y se almacena en [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span><span class="sxs-lookup"><span data-stu-id="69012-164">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="69012-165">El sistema de enrutamiento de puntos de conexión descrito en este documento es nuevo desde ASP.NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="69012-165">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="69012-166">Sin embargo, todas las versiones de ASP.NET Core admiten el mismo conjunto de características de plantilla de ruta y restricciones de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-166">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="69012-167">En el ejemplo siguiente se muestra el enrutamiento con [comprobaciones de estado](xref:host-and-deploy/health-checks) y autorización:</span><span class="sxs-lookup"><span data-stu-id="69012-167">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[request localized comments](~/includes/code-comments-loc.md)]

<span data-ttu-id="69012-168">En el ejemplo anterior se muestra cómo:</span><span class="sxs-lookup"><span data-stu-id="69012-168">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="69012-169">El middleware de autorización se puede usar con el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-169">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="69012-170">Los puntos de conexión se pueden usar para configurar el comportamiento de la autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-170">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="69012-171">La llamada a <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> agrega un punto de conexión de comprobación de estado.</span><span class="sxs-lookup"><span data-stu-id="69012-171">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="69012-172">Al encadenar <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> a esta llamada, se adjunta una directiva de autorización al punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-172">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="69012-173">La llamada a <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> y <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> agrega el middleware de autenticación y autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-173">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="69012-174">Estos middleware se colocan entre <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> y `UseEndpoints` para que puedan:</span><span class="sxs-lookup"><span data-stu-id="69012-174">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="69012-175">Vea qué punto de conexión ha seleccionado `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="69012-175">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="69012-176">Aplique una directiva de autorización antes de que <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> envíe al punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-176">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="69012-177">Metadatos de punto de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-177">Endpoint metadata</span></span>

<span data-ttu-id="69012-178">En el ejemplo anterior, hay dos puntos de conexión, pero solo el de comprobación de estado tiene una directiva de autorización adjunta.</span><span class="sxs-lookup"><span data-stu-id="69012-178">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="69012-179">Si la solicitud coincide con el punto de conexión de comprobación de estado, `/healthz`, se realiza una comprobación de autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-179">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="69012-180">Esto demuestra que los puntos de conexión pueden tener datos adicionales adjuntos.</span><span class="sxs-lookup"><span data-stu-id="69012-180">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="69012-181">Estos datos adicionales se denominan **metadatos** de punto de conexión:</span><span class="sxs-lookup"><span data-stu-id="69012-181">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="69012-182">Los metadatos pueden ser procesados mediante middleware compatible con el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-182">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="69012-183">Los metadatos pueden ser de cualquier tipo de .NET.</span><span class="sxs-lookup"><span data-stu-id="69012-183">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="69012-184">Conceptos de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-184">Routing concepts</span></span>

<span data-ttu-id="69012-185">El sistema de enrutamiento se basa en la canalización de middleware mediante la adición del eficaz concepto de **punto de conexión**.</span><span class="sxs-lookup"><span data-stu-id="69012-185">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="69012-186">Los puntos de conexión representan unidades de la funcionalidad de la aplicación que son diferentes entre sí en cuanto al enrutamiento, la autorización y cualquier número de sistemas de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="69012-186">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="69012-187">Definición de punto de conexión de ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="69012-187">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="69012-188">Un punto de conexión de ASP.NET Core es:</span><span class="sxs-lookup"><span data-stu-id="69012-188">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="69012-189">Ejecutable: tiene un objeto <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="69012-189">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="69012-190">Extensible: tiene una colección [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*).</span><span class="sxs-lookup"><span data-stu-id="69012-190">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="69012-191">Selectable: opcionalmente, tiene [información de enrutamiento](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="69012-191">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="69012-192">Enumerable: la colección de puntos de conexión se puede enumerar mediante la recuperación del objeto <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> de la [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="69012-192">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="69012-193">En el código siguiente se muestra cómo recuperar e inspeccionar el punto de conexión que coincide con la solicitud actual:</span><span class="sxs-lookup"><span data-stu-id="69012-193">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="69012-194">El punto de conexión, si se selecciona, se puede recuperar de `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="69012-194">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="69012-195">Se pueden inspeccionar sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="69012-195">Its properties can be inspected.</span></span> <span data-ttu-id="69012-196">Los objetos de punto de conexión son inmutables y no se pueden modificar después de crearlos.</span><span class="sxs-lookup"><span data-stu-id="69012-196">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="69012-197">El tipo más común de punto de conexión es <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span><span class="sxs-lookup"><span data-stu-id="69012-197">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="69012-198">`RouteEndpoint` incluye información que permite que el sistema de enrutamiento lo seleccione.</span><span class="sxs-lookup"><span data-stu-id="69012-198">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="69012-199">En el código anterior, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configura un [middleware](xref:fundamentals/middleware/index) insertado.</span><span class="sxs-lookup"><span data-stu-id="69012-199">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="69012-200">En el código siguiente se muestra que, en función de dónde se llame a `app.Use` en la canalización, es posible que no haya un punto de conexión:</span><span class="sxs-lookup"><span data-stu-id="69012-200">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="69012-201">En este ejemplo se agregan instrucciones `Console.WriteLine` que muestran si se ha seleccionado un punto de conexión o no.</span><span class="sxs-lookup"><span data-stu-id="69012-201">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="69012-202">Para mayor claridad, en el ejemplo se asigna un nombre para mostrar al punto de conexión `/` proporcionado.</span><span class="sxs-lookup"><span data-stu-id="69012-202">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="69012-203">Al ejecutar este código con una dirección URL de `/` se muestra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-203">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="69012-204">Al ejecutar este código con otra dirección URL se muestra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-204">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="69012-205">Este resultado muestra que:</span><span class="sxs-lookup"><span data-stu-id="69012-205">This output demonstrates that:</span></span>

* <span data-ttu-id="69012-206">El punto de conexión siempre es NULL antes de que se llame a `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="69012-206">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="69012-207">Si se encuentra una coincidencia, el extremo no es NULL entre `UseRouting` y <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="69012-207">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="69012-208">El middleware `UseEndpoints` es **terminal** cuando se encuentra una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-208">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="69012-209">El [middleware de terminal](#tm) se define más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="69012-209">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="69012-210">El middleware después de `UseEndpoints` solo se ejecuta cuando no se encuentra ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-210">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="69012-211">El middleware `UseRouting` usa el método [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) para asociar el punto de conexión al contexto actual.</span><span class="sxs-lookup"><span data-stu-id="69012-211">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="69012-212">Se puede reemplazar el middleware `UseRouting` con lógica personalizada y seguir aprovechando las ventajas del uso de puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-212">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="69012-213">Los puntos de conexión son una primitiva de bajo nivel como middleware y no están unidos a la implementación de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-213">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="69012-214">La mayoría de las aplicaciones no necesitan reemplazar `UseRouting` por lógica personalizada.</span><span class="sxs-lookup"><span data-stu-id="69012-214">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="69012-215">El middleware `UseEndpoints` está diseñado para usarse junto con el middleware `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="69012-215">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="69012-216">La lógica básica para ejecutar un punto de conexión no es complicada.</span><span class="sxs-lookup"><span data-stu-id="69012-216">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="69012-217">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> para recuperar el punto de conexión y, después, invoque su propiedad <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="69012-217">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="69012-218">En el código siguiente se muestra cómo el middleware puede influir en el enrutamiento o reaccionar ante este:</span><span class="sxs-lookup"><span data-stu-id="69012-218">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="69012-219">En el ejemplo anterior se muestran dos conceptos importantes:</span><span class="sxs-lookup"><span data-stu-id="69012-219">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="69012-220">El middleware se puede ejecutar antes de `UseRouting` para modificar los datos sobre los que funciona el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-220">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="69012-221">Normalmente, el middleware que aparece antes del enrutamiento modifica alguna propiedad de la solicitud, como <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*> o <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span><span class="sxs-lookup"><span data-stu-id="69012-221">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="69012-222">El middleware se puede ejecutar entre `UseRouting` y <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> para procesar los resultados del enrutamiento antes de que se ejecute el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-222">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="69012-223">El middleware que se ejecuta entre `UseRouting` y `UseEndpoints`:</span><span class="sxs-lookup"><span data-stu-id="69012-223">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="69012-224">Normalmente inspecciona los metadatos para entender los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-224">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="69012-225">A menudo toma decisiones de seguridad, como `UseAuthorization` y `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="69012-225">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="69012-226">La combinación de middleware y metadatos permite configurar directivas por punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-226">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="69012-227">En el código anterior se muestra un ejemplo de middleware personalizado que admite directivas por punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-227">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="69012-228">El middleware escribe un *registro de auditoría* de acceso a datos confidenciales en la consola.</span><span class="sxs-lookup"><span data-stu-id="69012-228">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="69012-229">El middleware se puede configurar para *auditar* un punto de conexión con los metadatos de `AuditPolicyAttribute`.</span><span class="sxs-lookup"><span data-stu-id="69012-229">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="69012-230">En este ejemplo se muestra un patrón *opcional* en el que solo se auditan los puntos de conexión marcados como confidenciales.</span><span class="sxs-lookup"><span data-stu-id="69012-230">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="69012-231">Esta lógica se puede definir en orden inverso, para auditar todo lo que no esté marcado como seguro, por ejemplo.</span><span class="sxs-lookup"><span data-stu-id="69012-231">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="69012-232">El sistema de metadatos de punto de conexión es flexible.</span><span class="sxs-lookup"><span data-stu-id="69012-232">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="69012-233">Esta lógica se puede diseñar de la manera que mejor se adapte al caso de uso.</span><span class="sxs-lookup"><span data-stu-id="69012-233">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="69012-234">El código del ejemplo anterior está diseñado para mostrar los conceptos básicos de los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-234">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="69012-235">**No está pensado para su uso en producción**.</span><span class="sxs-lookup"><span data-stu-id="69012-235">**The sample is not intended for production use**.</span></span> <span data-ttu-id="69012-236">Una versión más completa de un middleware de *registro de auditoría*:</span><span class="sxs-lookup"><span data-stu-id="69012-236">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="69012-237">Realizaría el registro en un archivo o una base de datos.</span><span class="sxs-lookup"><span data-stu-id="69012-237">Log to a file or database.</span></span>
* <span data-ttu-id="69012-238">Incluiría detalles como el usuario, la dirección IP, el nombre del punto de conexión confidencial, etc.</span><span class="sxs-lookup"><span data-stu-id="69012-238">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="69012-239">El valor `AuditPolicyAttribute` de metadatos de directiva de auditoría se define como `Attribute` para facilitar su uso con marcos basados en clases como los controladores y SignalR.</span><span class="sxs-lookup"><span data-stu-id="69012-239">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="69012-240">Cuando se usa *de ruta a código*:</span><span class="sxs-lookup"><span data-stu-id="69012-240">When using *route to code*:</span></span>

* <span data-ttu-id="69012-241">Los metadatos se asocian con una API de generador.</span><span class="sxs-lookup"><span data-stu-id="69012-241">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="69012-242">Los marcos basados en clases incluyen todos los atributos en el método y la clase correspondientes al crear los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-242">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="69012-243">Los procedimientos recomendados para los tipos de metadatos son definirlos como interfaces o atributos.</span><span class="sxs-lookup"><span data-stu-id="69012-243">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="69012-244">Las interfaces y los atributos permiten la reutilización del código.</span><span class="sxs-lookup"><span data-stu-id="69012-244">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="69012-245">El sistema de metadatos es flexible y no impone ninguna limitación.</span><span class="sxs-lookup"><span data-stu-id="69012-245">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="69012-246">Comparación entre un middleware de terminal y el enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-246">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="69012-247">En el ejemplo de código siguiente se compara el uso de middleware con el del enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-247">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="69012-248">El estilo de middleware que se muestra con `Approach 1:` es **middleware de terminal**.</span><span class="sxs-lookup"><span data-stu-id="69012-248">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="69012-249">Se denomina middleware de terminal porque realiza una operación de búsqueda de coincidencias:</span><span class="sxs-lookup"><span data-stu-id="69012-249">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="69012-250">La operación de búsqueda de coincidencias en el ejemplo anterior es `Path == "/"` para el middleware y `Path == "/Movie"` para el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-250">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="69012-251">Cuando una coincidencia es correcta, ejecuta alguna funcionalidad y devuelve un valor, en lugar de invocar el middleware `next`.</span><span class="sxs-lookup"><span data-stu-id="69012-251">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="69012-252">Se denomina middleware de terminal porque finaliza la búsqueda, ejecuta alguna funcionalidad y, después, devuelve un valor.</span><span class="sxs-lookup"><span data-stu-id="69012-252">It's called terminal middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="69012-253">Comparación entre un middleware de terminal y el enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-253">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="69012-254">Los dos enfoques permiten terminar la canalización de procesamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-254">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="69012-255">El middleware finaliza la canalización mediante la devolución de un valor en lugar de invocar `next`.</span><span class="sxs-lookup"><span data-stu-id="69012-255">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="69012-256">Los puntos de conexión siempre son de terminal.</span><span class="sxs-lookup"><span data-stu-id="69012-256">Endpoints are always terminal.</span></span>
* <span data-ttu-id="69012-257">El middleware de terminal permite colocar el middleware en un lugar arbitrario de la canalización:</span><span class="sxs-lookup"><span data-stu-id="69012-257">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="69012-258">Los puntos de conexión se ejecutan en la posición de <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="69012-258">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="69012-259">El middleware de terminal permite que el código arbitrario determine cuándo coincide el middleware:</span><span class="sxs-lookup"><span data-stu-id="69012-259">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="69012-260">El código personalizado de búsqueda de coincidencia de rutas puede ser detallado y difícil de escribir correctamente.</span><span class="sxs-lookup"><span data-stu-id="69012-260">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="69012-261">El enrutamiento proporciona soluciones sencillas para las aplicaciones típicas.</span><span class="sxs-lookup"><span data-stu-id="69012-261">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="69012-262">La mayoría de las aplicaciones no requieren código personalizado de búsqueda de coincidencia de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-262">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="69012-263">Los puntos de conexión interactúan con middleware como `UseAuthorization` y `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="69012-263">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="69012-264">Para usar un middleware de terminal con `UseAuthorization` o `UseCors` se necesita interactuar de forma manual con el sistema de autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-264">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="69012-265">Un [punto de conexión](#endpoint) define:</span><span class="sxs-lookup"><span data-stu-id="69012-265">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="69012-266">Un delegado para procesar solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-266">A delegate to process requests.</span></span>
* <span data-ttu-id="69012-267">Una colección de metadatos arbitrarios.</span><span class="sxs-lookup"><span data-stu-id="69012-267">A collection of arbitrary metadata.</span></span> <span data-ttu-id="69012-268">Los metadatos se usan para implementar cuestiones transversales según las directivas y la configuración asociada a cada punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-268">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="69012-269">El middleware de terminal puede ser una herramienta eficaz, pero puede requerir:</span><span class="sxs-lookup"><span data-stu-id="69012-269">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="69012-270">Una cantidad significativa de código y pruebas.</span><span class="sxs-lookup"><span data-stu-id="69012-270">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="69012-271">La integración manual con otros sistemas para lograr el nivel deseado de flexibilidad.</span><span class="sxs-lookup"><span data-stu-id="69012-271">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="69012-272">Considere la posibilidad de realizar la integración con el enrutamiento antes de escribir middleware de terminal.</span><span class="sxs-lookup"><span data-stu-id="69012-272">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="69012-273">El middleware de terminal existente que se integra con [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) o <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> normalmente se puede convertir en un punto de conexión compatible con el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-273">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="69012-274">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) muestra el patrón para enrutadores:</span><span class="sxs-lookup"><span data-stu-id="69012-274">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="69012-275">Escriba un método de extensión en <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-275">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="69012-276">Cree una canalización de middleware anidada mediante <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span><span class="sxs-lookup"><span data-stu-id="69012-276">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="69012-277">Adjunte el middleware a la nueva canalización.</span><span class="sxs-lookup"><span data-stu-id="69012-277">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="69012-278">En este caso, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span><span class="sxs-lookup"><span data-stu-id="69012-278">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="69012-279">Aplique <xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> a la canalización de middleware en un objeto <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="69012-279"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="69012-280">Llame a `Map` y proporcione la nueva canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="69012-280">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="69012-281">Devuelva el objeto de generador proporcionado por `Map` desde el método de extensión.</span><span class="sxs-lookup"><span data-stu-id="69012-281">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="69012-282">En el código siguiente se muestra el uso de [MapHealthChecks](xref:host-and-deploy/health-checks):</span><span class="sxs-lookup"><span data-stu-id="69012-282">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="69012-283">En el ejemplo anterior se muestra la importancia de devolver el objeto de generador.</span><span class="sxs-lookup"><span data-stu-id="69012-283">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="69012-284">Al devolver el objeto de generador, el desarrollador de aplicaciones puede configurar directivas como la autorización para el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-284">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="69012-285">En este ejemplo, el middleware de comprobaciones de estado no tiene una integración directa con el sistema de autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-285">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="69012-286">El sistema de metadatos se ha creado como respuesta a los problemas detectados por los autores de extensibilidad mediante el middleware de terminal.</span><span class="sxs-lookup"><span data-stu-id="69012-286">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="69012-287">El problema de cada middleware es implementar su propia integración con el sistema de autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-287">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="69012-288">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-288">URL matching</span></span>

* <span data-ttu-id="69012-289">Es el proceso por el cual el enrutamiento hace coincidir una solicitud entrante a un [punto de conexión](#endpoint).</span><span class="sxs-lookup"><span data-stu-id="69012-289">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="69012-290">Se basa en los datos de la ruta de acceso y los encabezados de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-290">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="69012-291">Se puede extender para tener en cuenta los datos de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-291">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="69012-292">Cuando se ejecuta un middleware de enrutamiento, se establece un objeto `Endpoint` y se enrutan los valores a una [característica de solicitud](xref:fundamentals/request-features) en el objeto <xref:Microsoft.AspNetCore.Http.HttpContext> desde la solicitud actual:</span><span class="sxs-lookup"><span data-stu-id="69012-292">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="69012-293">La llamada a [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) obtiene el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-293">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="69012-294">`HttpRequest.RouteValues` obtiene la colección de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-294">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="69012-295">El [middleware](xref:fundamentals/middleware/index) que se ejecuta después del middleware de enrutamiento puede inspeccionar el punto de conexión y tomar medidas.</span><span class="sxs-lookup"><span data-stu-id="69012-295">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="69012-296">Por ejemplo, un middleware de autorización puede consultar la colección de metadatos del punto de conexión de una directiva de autorización.</span><span class="sxs-lookup"><span data-stu-id="69012-296">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="69012-297">Después de que se ejecuta todo el middleware en la canalización de procesamiento de solicitudes, se invoca al delegado del punto de conexión seleccionado.</span><span class="sxs-lookup"><span data-stu-id="69012-297">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="69012-298">El sistema de enrutamiento en el enrutamiento de punto de conexión es responsable de todas las decisiones relativas al envío.</span><span class="sxs-lookup"><span data-stu-id="69012-298">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="69012-299">Como el middleware aplica directivas en función del punto de conexión seleccionado, es importante que:</span><span class="sxs-lookup"><span data-stu-id="69012-299">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="69012-300">Cualquier decisión que pueda afectar al envío o a la aplicación de directivas de seguridad se realice dentro del sistema de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-300">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="69012-301">En cuanto a la compatibilidad con versiones anteriores, cuando se ejecuta un delegado del punto de conexión de controlador o Razor Pages, las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) se establecen en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="69012-301">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="69012-302">El tipo `RouteContext` se marcará como obsoleto en una versión futura:</span><span class="sxs-lookup"><span data-stu-id="69012-302">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="69012-303">Migre `RouteData.Values` a `HttpRequest.RouteValues`.</span><span class="sxs-lookup"><span data-stu-id="69012-303">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="69012-304">Migre `RouteData.DataTokens` para recuperar [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) de los metadatos del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-304">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="69012-305">La coincidencia de direcciones URL funciona en un conjunto configurable de fases.</span><span class="sxs-lookup"><span data-stu-id="69012-305">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="69012-306">En cada fase, la salida es un conjunto de coincidencias.</span><span class="sxs-lookup"><span data-stu-id="69012-306">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="69012-307">El conjunto de coincidencias se puede reducir más en la fase siguiente.</span><span class="sxs-lookup"><span data-stu-id="69012-307">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="69012-308">La implementación de enrutamiento no garantiza un orden de procesamiento para los puntos de conexión coincidentes.</span><span class="sxs-lookup"><span data-stu-id="69012-308">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="69012-309">**Todas** las coincidencias posibles se procesan a la vez.</span><span class="sxs-lookup"><span data-stu-id="69012-309">**All** possible matches are processed at once.</span></span> <span data-ttu-id="69012-310">Las fases de coincidencia de direcciones URL se producen en el orden siguiente.</span><span class="sxs-lookup"><span data-stu-id="69012-310">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="69012-311">ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="69012-311">ASP.NET Core:</span></span>

1. <span data-ttu-id="69012-312">Procesa la ruta de dirección URL con el conjunto de puntos de conexión y sus plantillas de ruta, y se recopilan **todas** las coincidencias.</span><span class="sxs-lookup"><span data-stu-id="69012-312">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="69012-313">Toma la lista anterior y quita las coincidencias en las que se produce un error con restricciones de ruta aplicadas.</span><span class="sxs-lookup"><span data-stu-id="69012-313">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="69012-314">Toma la lista anterior y quita las coincidencias en las que se produce un error en el conjunto de instancias de [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy).</span><span class="sxs-lookup"><span data-stu-id="69012-314">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="69012-315">Usa [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) para tomar una decisión final de la lista anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-315">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="69012-316">La lista de puntos de conexión se prioriza según:</span><span class="sxs-lookup"><span data-stu-id="69012-316">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="69012-317">El valor [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span><span class="sxs-lookup"><span data-stu-id="69012-317">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="69012-318">La [precedencia de la plantilla de ruta](#rtp)</span><span class="sxs-lookup"><span data-stu-id="69012-318">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="69012-319">Todos los puntos de conexión coincidentes se procesan en cada fase hasta que se alcanza <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector>.</span><span class="sxs-lookup"><span data-stu-id="69012-319">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="69012-320">`EndpointSelector` es la fase final.</span><span class="sxs-lookup"><span data-stu-id="69012-320">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="69012-321">Elige el punto de conexión de prioridad más alta entre las coincidencias como la mejor coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-321">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="69012-322">Si hay otras coincidencias con la misma prioridad que la mejor, se inicia una excepción de coincidencia ambigua.</span><span class="sxs-lookup"><span data-stu-id="69012-322">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="69012-323">La prioridad de ruta se calcula en función de una plantilla de ruta **más específica** a la que se le asigna una prioridad más alta.</span><span class="sxs-lookup"><span data-stu-id="69012-323">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="69012-324">Por ejemplo, considere las plantillas `/hello` y `/{message}`:</span><span class="sxs-lookup"><span data-stu-id="69012-324">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="69012-325">Las dos coinciden con la ruta de dirección URL `/hello`.</span><span class="sxs-lookup"><span data-stu-id="69012-325">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="69012-326">`/hello` es más específica y, por tanto, tiene mayor prioridad.</span><span class="sxs-lookup"><span data-stu-id="69012-326">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="69012-327">Por lo general, la precedencia de rutas realiza un buen trabajo de elegir la mejor coincidencia para los tipos de esquemas de dirección URL que se usan en la práctica.</span><span class="sxs-lookup"><span data-stu-id="69012-327">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="69012-328">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> solo cuando sea necesario para evitar una ambigüedad.</span><span class="sxs-lookup"><span data-stu-id="69012-328">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="69012-329">Debido a los tipos de extensibilidad que proporciona el enrutamiento, el sistema de enrutamiento no puede calcular las rutas ambiguas por adelantado.</span><span class="sxs-lookup"><span data-stu-id="69012-329">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="69012-330">Considere un ejemplo como las plantillas de ruta `/{message:alpha}` y `/{message:int}`:</span><span class="sxs-lookup"><span data-stu-id="69012-330">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="69012-331">La restricción `alpha` solo coincide con caracteres alfabéticos.</span><span class="sxs-lookup"><span data-stu-id="69012-331">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="69012-332">La restricción `int` solo coincide con números.</span><span class="sxs-lookup"><span data-stu-id="69012-332">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="69012-333">Estas plantillas tienen la misma prioridad de ruta, pero no hay ninguna dirección URL única con la que coincidan.</span><span class="sxs-lookup"><span data-stu-id="69012-333">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="69012-334">Si el sistema de enrutamiento ha notificado un error de ambigüedad al iniciarse, bloquearía este caso de uso válido.</span><span class="sxs-lookup"><span data-stu-id="69012-334">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="69012-335">El orden de las operaciones dentro de <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> no influye en el comportamiento del enrutamiento, con una excepción.</span><span class="sxs-lookup"><span data-stu-id="69012-335">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="69012-336"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> y <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> asignan de forma automática un valor de orden a sus puntos de conexión en función del orden en el que se hayan invocado.</span><span class="sxs-lookup"><span data-stu-id="69012-336"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="69012-337">Esto simula el comportamiento a largo plazo de los controladores sin que el sistema de enrutamiento proporcione las mismas garantías que las implementaciones de enrutamiento anteriores.</span><span class="sxs-lookup"><span data-stu-id="69012-337">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="69012-338">En la implementación heredada de enrutamiento, es posible implementar la extensibilidad de enrutamiento que tiene una dependencia en el orden de procesamiento de las rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-338">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="69012-339">Enrutamiento de puntos de conexión en ASP.NET Core 3.0 y versiones posteriores:</span><span class="sxs-lookup"><span data-stu-id="69012-339">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="69012-340">No tiene un concepto de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-340">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="69012-341">No proporciona garantías de ordenación.</span><span class="sxs-lookup"><span data-stu-id="69012-341">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="69012-342">Todos los puntos de conexión se procesan a la vez.</span><span class="sxs-lookup"><span data-stu-id="69012-342">All endpoints are processed at once.</span></span>
>
> <span data-ttu-id="69012-343">Si esto significa que está atascado con el sistema de enrutamiento heredado, [abra una incidencia de GitHub para obtener ayuda](https://github.com/dotnet/aspnetcore/issues).</span><span class="sxs-lookup"><span data-stu-id="69012-343">If this means you're stuck using the legacy routing system, [open a GitHub issue for assistance](https://github.com/dotnet/aspnetcore/issues).</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="69012-344">Prioridad de la plantilla de ruta y orden de selección de los puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-344">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="69012-345">La [prioridad de la plantilla de ruta](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) es un sistema que asigna a cada plantilla de ruta un valor en función de su especificidad.</span><span class="sxs-lookup"><span data-stu-id="69012-345">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="69012-346">Precedencia de la plantilla de ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-346">Route template precedence:</span></span>

* <span data-ttu-id="69012-347">Evita la necesidad de ajustar el orden de los puntos de conexión en casos comunes.</span><span class="sxs-lookup"><span data-stu-id="69012-347">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="69012-348">Intenta hacer coincidir las expectativas comunes del comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-348">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="69012-349">Por ejemplo, considere las plantillas `/Products/List` y `/Products/{id}`.</span><span class="sxs-lookup"><span data-stu-id="69012-349">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="69012-350">Sería razonable suponer que `/Products/List` es una mejor coincidencia que `/Products/{id}` para la ruta de dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="69012-350">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="69012-351">Funciona porque el segmento literal `/List` se considera que tiene una mayor prioridad que el segmento de parámetro `/{id}`.</span><span class="sxs-lookup"><span data-stu-id="69012-351">The works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="69012-352">Los detalles de cómo funciona la precedencia están vinculados a cómo se definen las plantillas de ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-352">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="69012-353">Las plantillas con más segmentos se consideran más específicas.</span><span class="sxs-lookup"><span data-stu-id="69012-353">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="69012-354">Un segmento con texto literal se considera más específico que un segmento de parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-354">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="69012-355">Un segmento de parámetro con una restricción se considera más específico que uno que no la tenga.</span><span class="sxs-lookup"><span data-stu-id="69012-355">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="69012-356">Un segmento complejo se considera igual de específico que un segmento de parámetro con una restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-356">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="69012-357">Los parámetros comodín son los menos específicos.</span><span class="sxs-lookup"><span data-stu-id="69012-357">Catch-all parameters are the least specific.</span></span> <span data-ttu-id="69012-358">Vea **comodín** en [Referencia de plantilla de ruta](#rtr) para obtener información importante sobre las rutas comodín.</span><span class="sxs-lookup"><span data-stu-id="69012-358">See **catch-all** in the [Route template reference](#rtr) for important information on catch-all routes.</span></span>

<span data-ttu-id="69012-359">Vea el [código fuente en GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) para obtener una referencia de los valores exactos.</span><span class="sxs-lookup"><span data-stu-id="69012-359">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="69012-360">Conceptos de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="69012-360">URL generation concepts</span></span>

<span data-ttu-id="69012-361">Generación de direcciones URL:</span><span class="sxs-lookup"><span data-stu-id="69012-361">URL generation:</span></span>

* <span data-ttu-id="69012-362">Es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL en función de un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-362">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="69012-363">Permite una separación lógica entre los puntos de conexión y las direcciones URL que acceden a ellos.</span><span class="sxs-lookup"><span data-stu-id="69012-363">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="69012-364">El enrutamiento de punto de conexión incluye la API <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span><span class="sxs-lookup"><span data-stu-id="69012-364">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="69012-365">`LinkGenerator` es un servicio singleton disponible desde la [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="69012-365">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="69012-366">La API `LinkGenerator` se puede usar fuera del contexto de una solicitud en ejecución.</span><span class="sxs-lookup"><span data-stu-id="69012-366">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="69012-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) y los escenarios que dependen de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como los [asistentes de etiquetas](xref:mvc/views/tag-helpers/intro), los de HTML y los [resultados de acción](xref:mvc/controllers/actions), usan de forma interna la API `LinkGenerator` para proporcionar funciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="69012-368">El generador de vínculos está respaldado por el concepto de una **dirección** y **esquemas de direcciones**.</span><span class="sxs-lookup"><span data-stu-id="69012-368">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="69012-369">Un esquema de direcciones es una manera de determinar los puntos de conexión que se deben tener en cuenta para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-369">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="69012-370">Por ejemplo, los escenarios de nombre y valores de ruta de controladores y Razor Pages con los que muchos usuarios están familiarizados se implementan como un esquema de direcciones.</span><span class="sxs-lookup"><span data-stu-id="69012-370">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="69012-371">El generador de vínculos puede vincular a controladores y Razor Pages a través de los métodos de extensión siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-371">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="69012-372">Las sobrecargas de estos métodos aceptan argumentos que incluyan `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="69012-372">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="69012-373">Estos métodos son funcionalmente equivalentes a [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) y [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), pero ofrecen flexibilidad y opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="69012-373">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="69012-374">Los métodos `GetPath*` son más similares a `Url.Action` y `Url.Page`, dado que generan un URI que contiene una ruta de acceso absoluta.</span><span class="sxs-lookup"><span data-stu-id="69012-374">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="69012-375">Los métodos `GetUri*` siempre generan un URI absoluto que contiene un esquema y un host.</span><span class="sxs-lookup"><span data-stu-id="69012-375">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="69012-376">Los métodos que aceptan `HttpContext` generan un URI en el contexto de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="69012-376">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="69012-377">A menos que se reemplacen, se usan los valores de ruta de [ambiente](#ambient), la ruta de acceso base de la dirección URL, el esquema y el host de la solicitud en ejecución.</span><span class="sxs-lookup"><span data-stu-id="69012-377">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="69012-378">Se llama a <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con una dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="69012-379">La generación de un URI se produce en dos pasos:</span><span class="sxs-lookup"><span data-stu-id="69012-379">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="69012-380">Se enlaza una dirección a una lista de puntos de conexión que coincidan con la dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-380">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="69012-381">Se evalúa el elemento <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> de cada punto de conexión hasta que se encuentra un patrón de ruta que coincida con los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-381">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="69012-382">La salida resultante se combina con otras partes del URI proporcionadas al generador de vínculos y devueltas.</span><span class="sxs-lookup"><span data-stu-id="69012-382">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="69012-383">Los métodos proporcionados por <xref:Microsoft.AspNetCore.Routing.LinkGenerator> admiten funciones estándar de generación de vínculos para cualquier tipo de dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-383">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="69012-384">La forma más práctica de usar el generador de vínculos es a través de métodos de extensión que realicen operaciones para un tipo de dirección específica:</span><span class="sxs-lookup"><span data-stu-id="69012-384">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="69012-385">Método de extensión</span><span class="sxs-lookup"><span data-stu-id="69012-385">Extension Method</span></span> | <span data-ttu-id="69012-386">Descripción</span><span class="sxs-lookup"><span data-stu-id="69012-386">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="69012-387">Genera un URI con una ruta de acceso absoluta en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-387">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="69012-388">Genera un URI absoluto en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-388">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="69012-389">Preste atención a las consecuencias siguientes de llamar a los métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="69012-389">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="69012-390">Use los métodos de extensión `GetUri*` con precaución en una configuración de aplicación en la que no se valide el encabezado `Host` de las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="69012-390">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="69012-391">Si no se valida el encabezado `Host` de las solicitudes entrantes, la entrada de la solicitud que no sea de confianza se puede devolver al cliente en los URI de una página o vista.</span><span class="sxs-lookup"><span data-stu-id="69012-391">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="69012-392">Se recomienda que todas las aplicaciones de producción configuren su servidor para validar el encabezado `Host` en función de valores válidos conocidos.</span><span class="sxs-lookup"><span data-stu-id="69012-392">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="69012-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con precaución en el middleware junto con `Map` o `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="69012-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="69012-394">`Map*` cambia la ruta de acceso base de la solicitud que se ejecuta, lo que afecta a la salida de la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-394">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="69012-395">Todas las API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permiten especificar una ruta de acceso base.</span><span class="sxs-lookup"><span data-stu-id="69012-395">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="69012-396">Especifique una ruta de acceso base vacía para deshacer el efecto de `Map*` en la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-396">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="69012-397">Ejemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="69012-397">Middleware example</span></span>

<span data-ttu-id="69012-398">En el ejemplo siguiente, un middleware usa la API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para crear un vínculo a un método de acción que enumera los productos de la tienda.</span><span class="sxs-lookup"><span data-stu-id="69012-398">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="69012-399">El uso del generador de vínculos mediante su inserción en una clase y la llamada a `GenerateLink` está disponible para cualquier clase de una aplicación:</span><span class="sxs-lookup"><span data-stu-id="69012-399">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="69012-400">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-400">Route template reference</span></span>

<span data-ttu-id="69012-401">Los tokens de `{}` definen parámetros de ruta que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-401">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="69012-402">Se puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="69012-402">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="69012-403">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="69012-403">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="69012-404">Los parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="69012-404">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="69012-405">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-405">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="69012-406">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-406">Text matching is case-insensitive and based on the decoded representation of the URL's path.</span></span> <span data-ttu-id="69012-407">Para que el delimitador de parámetro de ruta literal `{` o `}` coincida, repita el carácter para aplicar escape al carácter.</span><span class="sxs-lookup"><span data-stu-id="69012-407">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="69012-408">Por ejemplo, `{{` o `}}`.</span><span class="sxs-lookup"><span data-stu-id="69012-408">For example `{{` or `}}`.</span></span>

<span data-ttu-id="69012-409">Asterisco `*` o asterisco doble `**`:</span><span class="sxs-lookup"><span data-stu-id="69012-409">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="69012-410">Se puede usar como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="69012-410">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="69012-411">Se denominan parámetros **comodín**.</span><span class="sxs-lookup"><span data-stu-id="69012-411">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="69012-412">Por ejemplo, `blog/{**slug}`:</span><span class="sxs-lookup"><span data-stu-id="69012-412">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="69012-413">Coincide con cualquier URI que empiece por `/blog` y después tenga cualquier valor.</span><span class="sxs-lookup"><span data-stu-id="69012-413">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="69012-414">El valor que aparece detrás de `/blog` se asigna al valor de ruta [slug](https://developer.mozilla.org/docs/Glossary/Slug).</span><span class="sxs-lookup"><span data-stu-id="69012-414">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

[!INCLUDE[](~/includes/catchall.md)]

<span data-ttu-id="69012-415">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="69012-415">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="69012-416">El parámetro comodín inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos los caracteres `/` de separación de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="69012-416">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="69012-417">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="69012-417">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="69012-418">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-418">Note the escaped forward slash.</span></span> <span data-ttu-id="69012-419">Para los caracteres separadores de ruta de acceso de ida y vuelta, use el prefijo de parámetro de ruta `**`.</span><span class="sxs-lookup"><span data-stu-id="69012-419">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="69012-420">La ruta `foo/{**path}` con `{ path = "my/path" }` genera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="69012-420">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="69012-421">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="69012-421">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="69012-422">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-422">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="69012-423">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="69012-423">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="69012-424">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el carácter `.` final es opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-424">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="69012-425">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-425">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="69012-426">Los parámetros de ruta pueden tener **valores predeterminados** designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="69012-426">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="69012-427">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="69012-427">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="69012-428">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-428">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="69012-429">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-429">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="69012-430">Por ejemplo: `id?`.</span><span class="sxs-lookup"><span data-stu-id="69012-430">For example, `id?`.</span></span> <span data-ttu-id="69012-431">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es:</span><span class="sxs-lookup"><span data-stu-id="69012-431">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="69012-432">Un parámetro de ruta con un valor predeterminado siempre produce un valor.</span><span class="sxs-lookup"><span data-stu-id="69012-432">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="69012-433">Un parámetro opcional solo tiene un valor cuando la dirección URL de la solicitud proporciona un valor.</span><span class="sxs-lookup"><span data-stu-id="69012-433">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="69012-434">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-434">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="69012-435">Al agregar `:` y un nombre de restricción después del nombre del parámetro de ruta, se especifica una restricción insertada en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-435">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="69012-436">Si la restricción requiere argumentos, se incluyen entre paréntesis `(...)` después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-436">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="69012-437">Se pueden especificar varias *restricciones insertadas* si se anexa otro carácter `:` y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-437">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="69012-438">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-438">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="69012-439">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="69012-439">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="69012-440">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-440">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="69012-441">Los parámetros de ruta también pueden tener transformadores de parámetros.</span><span class="sxs-lookup"><span data-stu-id="69012-441">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="69012-442">Los transformadores de parámetros transforman el valor de un parámetro al generar vínculos y hacer coincidir acciones y páginas con direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-442">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="69012-443">Como sucede con las restricciones, los transformadores de parámetros se pueden agregar en línea a un parámetro de ruta mediante la incorporación un carácter `:` y un nombre de transformador después del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-443">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="69012-444">Por ejemplo, la plantilla de ruta `blog/{article:slugify}` especifica un transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="69012-444">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="69012-445">Para obtener más información sobre los transformadores de parámetros, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-445">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="69012-446">En la tabla siguiente se muestran plantillas de ruta de ejemplo y su comportamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-446">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="69012-447">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-447">Route Template</span></span>                           | <span data-ttu-id="69012-448">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-448">Example Matching URI</span></span>    | <span data-ttu-id="69012-449">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="69012-449">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="69012-450">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="69012-450">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="69012-451">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="69012-451">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="69012-452">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="69012-452">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="69012-453">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="69012-453">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="69012-454">Se asigna al controlador `Products` y la acción `Details` con `id` establecido en 123.</span><span class="sxs-lookup"><span data-stu-id="69012-454">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="69012-455">Se asigna al controlador `Home` y al método `Index`.</span><span class="sxs-lookup"><span data-stu-id="69012-455">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="69012-456">`id` se pasa por alto.</span><span class="sxs-lookup"><span data-stu-id="69012-456">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="69012-457">Se asigna al controlador `Products` y al método `Index`.</span><span class="sxs-lookup"><span data-stu-id="69012-457">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="69012-458">`id` se pasa por alto.</span><span class="sxs-lookup"><span data-stu-id="69012-458">`id` is ignored.</span></span>        |

<span data-ttu-id="69012-459">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="69012-459">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="69012-460">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-460">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="69012-461">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="69012-461">Complex segments</span></span>

<span data-ttu-id="69012-462">Los segmentos complejos se procesan mediante la búsqueda de coincidencias de delimitadores literales de derecha a izquierda de un modo [no expansivo](#greedy).</span><span class="sxs-lookup"><span data-stu-id="69012-462">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="69012-463">Por ejemplo, `[Route("/a{b}c{d}")]` es un segmento complejo.</span><span class="sxs-lookup"><span data-stu-id="69012-463">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="69012-464">Los segmentos complejos funcionan de una manera determinada que se debe entender para usarlos correctamente.</span><span class="sxs-lookup"><span data-stu-id="69012-464">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="69012-465">En el ejemplo de esta sección se muestra por qué los segmentos complejos solo funcionan bien cuando el texto del delimitador no aparece dentro de los valores de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="69012-465">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="69012-466">En casos más complejos es necesario usar una [expresión regular](/dotnet/standard/base-types/regular-expressions) y extraer los valores de forma manual.</span><span class="sxs-lookup"><span data-stu-id="69012-466">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="69012-467">Este es un resumen de los pasos que realiza el enrutamiento con la plantilla `/a{b}c{d}` y la ruta de dirección URL `/abcd`.</span><span class="sxs-lookup"><span data-stu-id="69012-467">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="69012-468">`|` se usa para ayudar a visualizar cómo funciona el algoritmo:</span><span class="sxs-lookup"><span data-stu-id="69012-468">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="69012-469">El primer literal, de derecha a izquierda, es `c`.</span><span class="sxs-lookup"><span data-stu-id="69012-469">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="69012-470">Por tanto, se busca en `/abcd` desde la derecha y se encuentra `/ab|c|d`.</span><span class="sxs-lookup"><span data-stu-id="69012-470">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="69012-471">Todo lo que se encuentra a la derecha (`d`) coincide ahora con el parámetro de ruta `{d}`.</span><span class="sxs-lookup"><span data-stu-id="69012-471">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="69012-472">El siguiente literal, de derecha a izquierda, es `a`.</span><span class="sxs-lookup"><span data-stu-id="69012-472">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="69012-473">Por tanto, se busca en `/ab|c|d` a partir de donde se ha parado antes, después `a` y se encuentra `/|a|b|c|d`.</span><span class="sxs-lookup"><span data-stu-id="69012-473">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="69012-474">El valor situado a la derecha (`b`) coincide ahora con el parámetro de ruta `{b}`.</span><span class="sxs-lookup"><span data-stu-id="69012-474">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="69012-475">No queda ningún texto ni ninguna plantilla de ruta, por lo que se trata de una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-475">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="69012-476">Este es un ejemplo de un caso negativo en el que se usa la misma plantilla `/a{b}c{d}` y la ruta de dirección URL `/aabcd`.</span><span class="sxs-lookup"><span data-stu-id="69012-476">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="69012-477">`|` se usa para ayudar a visualizar cómo funciona el algoritmo.</span><span class="sxs-lookup"><span data-stu-id="69012-477">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="69012-478">Este caso no es una coincidencia, que se explica mediante el mismo algoritmo:</span><span class="sxs-lookup"><span data-stu-id="69012-478">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="69012-479">El primer literal, de derecha a izquierda, es `c`.</span><span class="sxs-lookup"><span data-stu-id="69012-479">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="69012-480">Por tanto, se busca en `/aabcd` desde la derecha y se encuentra `/aab|c|d`.</span><span class="sxs-lookup"><span data-stu-id="69012-480">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="69012-481">Todo lo que se encuentra a la derecha (`d`) coincide ahora con el parámetro de ruta `{d}`.</span><span class="sxs-lookup"><span data-stu-id="69012-481">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="69012-482">El siguiente literal, de derecha a izquierda, es `a`.</span><span class="sxs-lookup"><span data-stu-id="69012-482">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="69012-483">Por tanto, se busca en `/aab|c|d` a partir de donde se ha parado antes, después `a` y se encuentra `/a|a|b|c|d`.</span><span class="sxs-lookup"><span data-stu-id="69012-483">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="69012-484">El valor situado a la derecha (`b`) coincide ahora con el parámetro de ruta `{b}`.</span><span class="sxs-lookup"><span data-stu-id="69012-484">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="69012-485">En este momento, todavía hay texto `a`, pero el algoritmo se ha quedado sin plantilla de ruta para analizar, por lo que no es una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-485">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="69012-486">Como el algoritmo de búsqueda de coincidencias es [no expansivo](#greedy):</span><span class="sxs-lookup"><span data-stu-id="69012-486">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="69012-487">Coincide con la menor cantidad de texto posible en cada paso.</span><span class="sxs-lookup"><span data-stu-id="69012-487">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="69012-488">Cualquier caso en el que el valor de delimitador aparezca dentro de los valores de parámetro provoca que no coincida.</span><span class="sxs-lookup"><span data-stu-id="69012-488">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="69012-489">Las expresiones regulares proporcionan un mayor control sobre el comportamiento de búsqueda de coincidencias.</span><span class="sxs-lookup"><span data-stu-id="69012-489">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="69012-490">La coincidencia expansiva, también conocida como [coincidencia diferida](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), coincide con la cadena más grande posible.</span><span class="sxs-lookup"><span data-stu-id="69012-490">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="69012-491">La búsqueda no expansiva coincide con la cadena más pequeña posible.</span><span class="sxs-lookup"><span data-stu-id="69012-491">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="69012-492">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-492">Route constraint reference</span></span>

<span data-ttu-id="69012-493">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-493">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="69012-494">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="69012-494">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="69012-495">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="69012-495">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="69012-496">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-496">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="69012-497">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-497">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="69012-498">No use las restricciones para la validación de entradas.</span><span class="sxs-lookup"><span data-stu-id="69012-498">Don't use constraints for input validation.</span></span> <span data-ttu-id="69012-499">Si se usan restricciones para la validación de entradas, las que no sean válidas generan una respuesta `404` No encontrado.</span><span class="sxs-lookup"><span data-stu-id="69012-499">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="69012-500">Una entrada no válida debería generar `400` Solicitud incorrecta con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="69012-500">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="69012-501">Las restricciones de ruta se usan para eliminar la ambigüedad entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="69012-501">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="69012-502">En la tabla siguiente se muestran restricciones de ruta de ejemplo y su comportamiento esperado:</span><span class="sxs-lookup"><span data-stu-id="69012-502">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="69012-503">restricción</span><span class="sxs-lookup"><span data-stu-id="69012-503">constraint</span></span> | <span data-ttu-id="69012-504">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-504">Example</span></span> | <span data-ttu-id="69012-505">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-505">Example Matches</span></span> | <span data-ttu-id="69012-506">Notas</span><span class="sxs-lookup"><span data-stu-id="69012-506">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="69012-507">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-507">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-508">Coincide con cualquier entero</span><span class="sxs-lookup"><span data-stu-id="69012-508">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="69012-509">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="69012-509">`true`, `FALSE`</span></span> | <span data-ttu-id="69012-510">Coincide con `true` o `false`.</span><span class="sxs-lookup"><span data-stu-id="69012-510">Matches `true` or `false`.</span></span> <span data-ttu-id="69012-511">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="69012-511">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="69012-512">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="69012-512">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="69012-513">Coincide con un valor `DateTime` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-513">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="69012-514">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-514">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="69012-515">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="69012-515">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="69012-516">Coincide con un valor `decimal` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-516">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="69012-517">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-517">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="69012-518">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-518">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-519">Coincide con un valor `double` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-519">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="69012-520">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-520">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="69012-521">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-521">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-522">Coincide con un valor `float` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-522">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="69012-523">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-523">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="69012-524">Coincide con un valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="69012-524">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="69012-525">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-525">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-526">Coincide con un valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="69012-526">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="69012-527">La cadena debe tener al menos cuatro caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-527">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="69012-528">La cadena no debe tener más de ocho caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-528">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="69012-529">La cadena debe tener una longitud de exactamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-529">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="69012-530">La cadena debe tener una longitud como mínimo de ocho caracteres y como máximo de 16</span><span class="sxs-lookup"><span data-stu-id="69012-530">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="69012-531">El valor entero debe ser como mínimo 18</span><span class="sxs-lookup"><span data-stu-id="69012-531">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="69012-532">El valor entero debe ser como máximo 120</span><span class="sxs-lookup"><span data-stu-id="69012-532">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="69012-533">El valor entero debe ser como mínimo 18 y máximo 120</span><span class="sxs-lookup"><span data-stu-id="69012-533">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="69012-534">La cadena debe constar de uno o más caracteres alfabéticos, `a`-`z` y no distinguir mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="69012-534">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="69012-535">La cadena debe coincidir con la expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-535">String must match the regular expression.</span></span> <span data-ttu-id="69012-536">Vea las sugerencias sobre cómo definir una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-536">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="69012-537">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-537">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="69012-538">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-538">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="69012-539">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="69012-539">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="69012-540">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR siempre usan la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-540">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="69012-541">Por ejemplo, la conversión al tipo `int` o `DateTime` de CLR.</span><span class="sxs-lookup"><span data-stu-id="69012-541">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="69012-542">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="69012-542">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="69012-543">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-543">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="69012-544">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="69012-544">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="69012-545">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="69012-545">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="69012-546">Expresiones regulares en restricciones</span><span class="sxs-lookup"><span data-stu-id="69012-546">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="69012-547">Las expresiones regulares se pueden especificar como restricciones insertadas mediante la restricción de ruta `regex(...)`.</span><span class="sxs-lookup"><span data-stu-id="69012-547">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="69012-548">Los métodos de la familia <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> también aceptan un literal de objeto de restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-548">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="69012-549">Si se usa ese formato, los valores de cadena se interpretan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-549">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="69012-550">En el código siguiente se usa una restricción de expresión regular insertada:</span><span class="sxs-lookup"><span data-stu-id="69012-550">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="69012-551">En el código siguiente se usa un literal de objeto para especificar una restricción de expresión regular:</span><span class="sxs-lookup"><span data-stu-id="69012-551">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="69012-552">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-552">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="69012-553">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="69012-553">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="69012-554">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="69012-554">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="69012-555">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-555">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="69012-556">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en una restricción insertada, utilice una de las opciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-556">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="69012-557">Reemplace los caracteres `\` proporcionados en la cadena como caracteres `\\` en el archivo de código fuente de C# para aplicar secuencias de escape al carácter de escape de cadena `\`.</span><span class="sxs-lookup"><span data-stu-id="69012-557">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="69012-558">[Literales de cadena textual](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="69012-558">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="69012-559">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento (`{`, `}`, `[` y `]`), duplique los caracteres en la expresión, por ejemplo `{{`, `}}`, `[[` y `]]`.</span><span class="sxs-lookup"><span data-stu-id="69012-559">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="69012-560">En la tabla siguiente se muestra una expresión regular y su versión con la secuencia de escape:</span><span class="sxs-lookup"><span data-stu-id="69012-560">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="69012-561">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="69012-561">Regular expression</span></span>    | <span data-ttu-id="69012-562">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="69012-562">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="69012-563">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter `^` y coincidir con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-563">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="69012-564">Las expresiones suelen terminar con el carácter `$` y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-564">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="69012-565">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-565">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="69012-566">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, lo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="69012-566">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="69012-567">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no:</span><span class="sxs-lookup"><span data-stu-id="69012-567">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="69012-568">Expresión</span><span class="sxs-lookup"><span data-stu-id="69012-568">Expression</span></span>   | <span data-ttu-id="69012-569">String</span><span class="sxs-lookup"><span data-stu-id="69012-569">String</span></span>    | <span data-ttu-id="69012-570">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="69012-570">Match</span></span> | <span data-ttu-id="69012-571">Comentario</span><span class="sxs-lookup"><span data-stu-id="69012-571">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="69012-572">hello</span><span class="sxs-lookup"><span data-stu-id="69012-572">hello</span></span>     | <span data-ttu-id="69012-573">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-573">Yes</span></span>   | <span data-ttu-id="69012-574">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-574">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-575">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-575">123abc456</span></span> | <span data-ttu-id="69012-576">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-576">Yes</span></span>   | <span data-ttu-id="69012-577">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-577">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-578">mz</span><span class="sxs-lookup"><span data-stu-id="69012-578">mz</span></span>        | <span data-ttu-id="69012-579">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-579">Yes</span></span>   | <span data-ttu-id="69012-580">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="69012-580">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="69012-581">MZ</span><span class="sxs-lookup"><span data-stu-id="69012-581">MZ</span></span>        | <span data-ttu-id="69012-582">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-582">Yes</span></span>   | <span data-ttu-id="69012-583">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="69012-583">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="69012-584">hello</span><span class="sxs-lookup"><span data-stu-id="69012-584">hello</span></span>     | <span data-ttu-id="69012-585">No</span><span class="sxs-lookup"><span data-stu-id="69012-585">No</span></span>    | <span data-ttu-id="69012-586">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-586">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="69012-587">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-587">123abc456</span></span> | <span data-ttu-id="69012-588">No</span><span class="sxs-lookup"><span data-stu-id="69012-588">No</span></span>    | <span data-ttu-id="69012-589">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-589">See `^` and `$` above</span></span> |

<span data-ttu-id="69012-590">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-590">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="69012-591">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-591">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="69012-592">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="69012-592">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="69012-593">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="69012-593">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="69012-594">Las restricciones que se pasan al diccionario de restricciones que no coinciden con una de las conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-594">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="69012-595">Las restricciones que se pasan en una plantilla y que no coinciden con una de las conocidas no se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-595">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="69012-596">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="69012-596">Custom route constraints</span></span>

<span data-ttu-id="69012-597">Se pueden crear restricciones de ruta personalizadas mediante la implementación de la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="69012-597">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="69012-598">La interfaz `IRouteConstraint` contiene <xref:System.Web.Routing.IRouteConstraint.Match*>, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="69012-598">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="69012-599">Las restricciones de ruta personalizadas rara vez son necesarias.</span><span class="sxs-lookup"><span data-stu-id="69012-599">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="69012-600">Antes de implementar una restricción de ruta personalizada, considere alternativas, como el enlace de modelos.</span><span class="sxs-lookup"><span data-stu-id="69012-600">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="69012-601">En la carpeta [Constraints](https://github.com/dotnet/aspnetcore/tree/master/src/Http/Routing/src/Constraints) de ASP.NET Core se proporcionan buenos ejemplos de creación de restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-601">The ASP.NET Core [Constraints](https://github.com/dotnet/aspnetcore/tree/master/src/Http/Routing/src/Constraints) folder provides good examples of creating a constraints.</span></span> <span data-ttu-id="69012-602">Por ejemplo, [GuidRouteConstraint](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Constraints/GuidRouteConstraint.cs#L18).</span><span class="sxs-lookup"><span data-stu-id="69012-602">For example, [GuidRouteConstraint](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Constraints/GuidRouteConstraint.cs#L18).</span></span>

<span data-ttu-id="69012-603">Para usar una restricción `IRouteConstraint` personalizada, el tipo de restricción de ruta se debe registrar con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="69012-603">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="69012-604">`ConstraintMap` es un diccionario que asigna claves de restricciones de ruta a implementaciones de `IRouteConstraint` que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-604">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="69012-605">El parámetro `ConstraintMap` de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="69012-605">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="69012-606">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="69012-606">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="69012-607">La restricción anterior se aplica en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-607">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

[!INCLUDE[](~/includes/MyDisplayRouteInfo.md)]

<span data-ttu-id="69012-608">La implementación de `MyCustomConstraint` impide que `0` se aplique a un parámetro de ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-608">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="69012-609">El código anterior:</span><span class="sxs-lookup"><span data-stu-id="69012-609">The preceding code:</span></span>

* <span data-ttu-id="69012-610">Impide `0` en el segmento `{id}` de la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-610">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="69012-611">Se muestra para proporcionar un ejemplo básico de implementación de una restricción personalizada.</span><span class="sxs-lookup"><span data-stu-id="69012-611">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="69012-612">No se debe usar en una aplicación de producción.</span><span class="sxs-lookup"><span data-stu-id="69012-612">It should not be used in a production app.</span></span>

<span data-ttu-id="69012-613">El código siguiente es un enfoque mejor para impedir que se procese un valor `id` que contenga `0`:</span><span class="sxs-lookup"><span data-stu-id="69012-613">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="69012-614">El código anterior tiene las ventajas siguientes con respecto al enfoque de `MyCustomConstraint`:</span><span class="sxs-lookup"><span data-stu-id="69012-614">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="69012-615">No requiere una restricción personalizada.</span><span class="sxs-lookup"><span data-stu-id="69012-615">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="69012-616">Devuelve un error más descriptivo cuando el parámetro de ruta incluye `0`.</span><span class="sxs-lookup"><span data-stu-id="69012-616">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="69012-617">Referencia de transformadores de parámetros</span><span class="sxs-lookup"><span data-stu-id="69012-617">Parameter transformer reference</span></span>

<span data-ttu-id="69012-618">Transformadores de parámetros:</span><span class="sxs-lookup"><span data-stu-id="69012-618">Parameter transformers:</span></span>

* <span data-ttu-id="69012-619">Se ejecutan al generar un vínculo mediante <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span><span class="sxs-lookup"><span data-stu-id="69012-619">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="69012-620">Implemente <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="69012-620">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="69012-621">Se configuran con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="69012-621">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="69012-622">Toman el valor de ruta del parámetro y lo transforman en un nuevo valor de cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-622">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="69012-623">Como resultado, el valor transformado se usa en el vínculo generado.</span><span class="sxs-lookup"><span data-stu-id="69012-623">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="69012-624">Por ejemplo, un transformador de parámetros personalizado `slugify` en el patrón de ruta `blog\{article:slugify}` con `Url.Action(new { article = "MyTestArticle" })` genera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="69012-624">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="69012-625">Considere la siguiente implementación de `IOutboundParameterTransformer`:</span><span class="sxs-lookup"><span data-stu-id="69012-625">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="69012-626">Para usar un transformador de parámetros en un patrón de ruta, configúrelo con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-626">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="69012-627">El marco ASP.NET Core usa los transformadores de parámetros para transformar el URI en el que se resuelve un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-627">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="69012-628">Por ejemplo, los transformadores de parámetros transforman los valores de ruta que se usan para hacer coincidir objetos `area`, `controller`, `action` y `page`.</span><span class="sxs-lookup"><span data-stu-id="69012-628">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="69012-629">Con la plantilla de ruta anterior, la acción `SubscriptionManagementController.GetAll` coincide con el URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="69012-629">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="69012-630">Un transformador de parámetros no cambia los valores de ruta usados para generar un vínculo.</span><span class="sxs-lookup"><span data-stu-id="69012-630">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="69012-631">Por ejemplo, `Url.Action("GetAll", "SubscriptionManagement")` genera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="69012-631">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="69012-632">ASP.NET Core proporciona convenciones de API para usar transformadores de parámetros con rutas generadas:</span><span class="sxs-lookup"><span data-stu-id="69012-632">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="69012-633">La convención <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> de MVC aplica un transformador de parámetro especificado a todas las rutas de atributo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-633">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="69012-634">El transformador de parámetro transforma los tokens de rutas de atributo a medida que se reemplazan.</span><span class="sxs-lookup"><span data-stu-id="69012-634">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="69012-635">Para más información, consulte [Usar un transformador de parámetro para personalizar el reemplazo de tokens](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="69012-635">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="69012-636"><xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> Pages usa la convención de API Razor.</span><span class="sxs-lookup"><span data-stu-id="69012-636">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="69012-637">Esta convención aplica un transformador de parámetros especificado a todas las instancias de Razor Pages detectadas de forma automática.</span><span class="sxs-lookup"><span data-stu-id="69012-637">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="69012-638">El transformador de parámetros transforma los segmentos de nombre de archivo y carpeta de las rutas de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-638">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="69012-639">Para más información, consulte el artículo sobre cómo [usar un transformador de parámetro para personalizar rutas de Razor Pages](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="69012-639">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="69012-640">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="69012-640">URL generation reference</span></span>

<span data-ttu-id="69012-641">Esta sección contiene una referencia para el algoritmo implementado por la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-641">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="69012-642">En la práctica, los ejemplos más complejos de generación de direcciones URL usan controladores o Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-642">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="69012-643">Vea [Enrutamiento en controladores](xref:mvc/controllers/routing) para obtener información adicional.</span><span class="sxs-lookup"><span data-stu-id="69012-643">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="69012-644">El proceso de generación de direcciones URL comienza con una llamada a [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) o un método similar.</span><span class="sxs-lookup"><span data-stu-id="69012-644">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="69012-645">Al método se le proporciona una dirección, un conjunto de valores de ruta y, opcionalmente, información sobre la solicitud actual de `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="69012-645">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="69012-646">El primer paso consiste en usar la dirección para resolver un conjunto de puntos de conexión candidatos con una instancia de [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) que coincide con el tipo de la dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-646">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="69012-647">Una vez que el esquema de direcciones encuentra un conjunto de candidatos, los puntos de conexión se ordenan y procesan de forma iterativa hasta que una operación de generación de direcciones URL se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="69012-647">Once of set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="69012-648">La generación de direcciones URL **no** comprueba si hay ambigüedades; el primer resultado devuelto es el resultado final.</span><span class="sxs-lookup"><span data-stu-id="69012-648">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="69012-649">Solución de problemas de generación de direcciones URL con registro</span><span class="sxs-lookup"><span data-stu-id="69012-649">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="69012-650">El primer paso para solucionar problemas de generación de direcciones URL consiste en establecer el nivel de registro de `Microsoft.AspNetCore.Routing` en `TRACE`.</span><span class="sxs-lookup"><span data-stu-id="69012-650">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="69012-651">`LinkGenerator` registra muchos detalles sobre su procesamiento que pueden ser útiles para solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="69012-651">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="69012-652">Vea [Referencia de generación de direcciones URL](#ugr) para obtener más información sobre la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-652">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="69012-653">Direcciones</span><span class="sxs-lookup"><span data-stu-id="69012-653">Addresses</span></span>

<span data-ttu-id="69012-654">Las direcciones son el concepto de la generación de direcciones URL que se usa para enlazar una llamada al generador de vínculos a un conjunto de puntos de conexión candidatos.</span><span class="sxs-lookup"><span data-stu-id="69012-654">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="69012-655">Las direcciones son un concepto extensible que incluyen dos implementaciones de forma predeterminada:</span><span class="sxs-lookup"><span data-stu-id="69012-655">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="69012-656">Con el *nombre del punto de conexión* (`string`) como dirección:</span><span class="sxs-lookup"><span data-stu-id="69012-656">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="69012-657">Proporciona una funcionalidad similar al nombre de ruta de MVC.</span><span class="sxs-lookup"><span data-stu-id="69012-657">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="69012-658">Usa el tipo de metadatos de <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata>.</span><span class="sxs-lookup"><span data-stu-id="69012-658">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="69012-659">Resuelve la cadena proporcionada con los metadatos de todos los puntos de conexión registrados.</span><span class="sxs-lookup"><span data-stu-id="69012-659">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="69012-660">Inicia una excepción durante el inicio si varios puntos de conexión usan el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="69012-660">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="69012-661">Se recomienda para uso general fuera de los controladores y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-661">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="69012-662">Con los *valores de ruta* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) como dirección:</span><span class="sxs-lookup"><span data-stu-id="69012-662">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="69012-663">Proporciona una funcionalidad similar a los controladores y la generación de direcciones URL heredada de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-663">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="69012-664">La ampliación y depuración son complejas.</span><span class="sxs-lookup"><span data-stu-id="69012-664">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="69012-665">Proporciona la implementación que usa `IUrlHelper`, aplicaciones auxiliares de etiquetas, aplicaciones auxiliares HTML, resultados de acciones, etc.</span><span class="sxs-lookup"><span data-stu-id="69012-665">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="69012-666">El papel del esquema de direcciones consiste en establecer la asociación entre la dirección y los puntos de conexión coincidentes mediante criterios arbitrarios:</span><span class="sxs-lookup"><span data-stu-id="69012-666">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="69012-667">El esquema de nombres de punto de conexión realiza una búsqueda de diccionario básica.</span><span class="sxs-lookup"><span data-stu-id="69012-667">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="69012-668">El esquema de valores de ruta tiene un subconjunto óptimo de algoritmos definidos complejo.</span><span class="sxs-lookup"><span data-stu-id="69012-668">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="69012-669">Valores de ambiente y valores explícitos</span><span class="sxs-lookup"><span data-stu-id="69012-669">Ambient values and explicit values</span></span>

<span data-ttu-id="69012-670">A partir de la solicitud actual, el enrutamiento accede a los valores de ruta del objeto `HttpContext.Request.RouteValues` de la solicitud actual.</span><span class="sxs-lookup"><span data-stu-id="69012-670">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="69012-671">Los valores asociados a la solicitud actual se conocen como **valores de ambiente**.</span><span class="sxs-lookup"><span data-stu-id="69012-671">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="69012-672">Para mayor claridad, en la documentación se hace referencia a los valores de ruta que se pasan a los métodos como **valores explícitos**.</span><span class="sxs-lookup"><span data-stu-id="69012-672">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="69012-673">En el ejemplo siguiente se muestran valores de ambiente y valores explícitos.</span><span class="sxs-lookup"><span data-stu-id="69012-673">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="69012-674">Proporciona valores de ambiente de la solicitud actual y valores explícitos, `{ id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="69012-674">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="69012-675">El código anterior:</span><span class="sxs-lookup"><span data-stu-id="69012-675">The preceding code:</span></span>

* <span data-ttu-id="69012-676">Devuelve `/Widget/Index/17`</span><span class="sxs-lookup"><span data-stu-id="69012-676">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="69012-677">Obtiene <xref:Microsoft.AspNetCore.Routing.LinkGenerator> a través de la [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="69012-677">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="69012-678">En el código siguiente no se proporcionan valores de ambiente y valores explícitos, `{ controller = "Home", action = "Subscribe", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="69012-678">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="69012-679">El método anterior devuelve `/Home/Subscribe/17`</span><span class="sxs-lookup"><span data-stu-id="69012-679">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="69012-680">El código siguiente en `WidgetController` devuelve `/Widget/Subscribe/17`:</span><span class="sxs-lookup"><span data-stu-id="69012-680">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="69012-681">En el código siguiente se proporciona el controlador a partir de los valores de ambiente de la solicitud actual y los valores explícitos, `{ action = "Edit", id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="69012-681">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="69012-682">En el código anterior:</span><span class="sxs-lookup"><span data-stu-id="69012-682">In the preceding code:</span></span>

* <span data-ttu-id="69012-683">Se devuelve `/Gadget/Edit/17`.</span><span class="sxs-lookup"><span data-stu-id="69012-683">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="69012-684"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> obtiene el objeto <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span><span class="sxs-lookup"><span data-stu-id="69012-684"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="69012-685">genera una dirección URL con una ruta de acceso absoluta para un método de acción.</span><span class="sxs-lookup"><span data-stu-id="69012-685">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="69012-686">La dirección URL contiene el nombre de `action` especificado y los valores `route`.</span><span class="sxs-lookup"><span data-stu-id="69012-686">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="69012-687">En el código siguiente se proporcionan valores de ambiente de la solicitud actual y valores explícitos: `{ page = "./Edit, id = 17, }`:</span><span class="sxs-lookup"><span data-stu-id="69012-687">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="69012-688">En el código anterior se establece `url` en `/Edit/17` cuando la página de Razor de edición contiene la siguiente directiva de página:</span><span class="sxs-lookup"><span data-stu-id="69012-688">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="69012-689">Si la página de edición no contiene la plantilla de ruta `"{id:int}"`, `url` es `/Edit?id=17`.</span><span class="sxs-lookup"><span data-stu-id="69012-689">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="69012-690">El comportamiento de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC agrega una capa de complejidad además de las reglas descritas aquí:</span><span class="sxs-lookup"><span data-stu-id="69012-690">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="69012-691">`IUrlHelper` siempre proporciona los valores de ruta de la solicitud actual como valores de ambiente.</span><span class="sxs-lookup"><span data-stu-id="69012-691">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="69012-692">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) siempre copia los valores de ruta `action` y `controller` actuales como valores explícitos a menos que el desarrollador los invalide.</span><span class="sxs-lookup"><span data-stu-id="69012-692">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="69012-693">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) siempre copia el valor de ruta `page` actual como un valor explícito a menos que se invalide.</span><span class="sxs-lookup"><span data-stu-id="69012-693">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="69012-694">`IUrlHelper.Page` siempre invalida el valor de ruta `handler` actual con `null` como un valor explícito a menos que se invalide.</span><span class="sxs-lookup"><span data-stu-id="69012-694">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="69012-695">A los usuarios a menudo les sorprenden los detalles del comportamiento de los valores de ambiente, ya que MVC no parece seguir sus propias reglas.</span><span class="sxs-lookup"><span data-stu-id="69012-695">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="69012-696">Por motivos históricos y de compatibilidad, algunos valores de ruta como `action`, `controller`, `page` y `handler` tienen su propio comportamiento de caso especial.</span><span class="sxs-lookup"><span data-stu-id="69012-696">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="69012-697">La funcionalidad equivalente proporcionada por `LinkGenerator.GetPathByAction` y `LinkGenerator.GetPathByPage` duplica estas anomalías de `IUrlHelper` por motivos de compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="69012-697">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="69012-698">Proceso de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="69012-698">URL generation process</span></span>

<span data-ttu-id="69012-699">Una vez que se encuentra el conjunto de puntos de conexión candidatos, el algoritmo de generación de direcciones URL:</span><span class="sxs-lookup"><span data-stu-id="69012-699">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="69012-700">Procesa los puntos de conexión de forma iterativa.</span><span class="sxs-lookup"><span data-stu-id="69012-700">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="69012-701">Devuelve el primer resultado correcto.</span><span class="sxs-lookup"><span data-stu-id="69012-701">Returns the first successful result.</span></span>

<span data-ttu-id="69012-702">El primer paso de este proceso se denomina **invalidación del valor de ruta**.</span><span class="sxs-lookup"><span data-stu-id="69012-702">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="69012-703">La invalidación del valor de ruta es el proceso por el que el enrutamiento decide qué valores de ruta de los valores de ambiente se deben usar y cuáles se deben omitir.</span><span class="sxs-lookup"><span data-stu-id="69012-703">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="69012-704">Cada valor de ambiente se tiene en cuenta y se combina con los valores explícitos, o bien se pasa por alto.</span><span class="sxs-lookup"><span data-stu-id="69012-704">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="69012-705">La mejor manera de pensar en el rol de los valores de ambiente es que intentan ahorrar trabajo a los desarrolladores de aplicaciones, en algunos casos comunes.</span><span class="sxs-lookup"><span data-stu-id="69012-705">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="69012-706">Tradicionalmente, los escenarios en los que los valores de ambiente son útiles están relacionados con MVC:</span><span class="sxs-lookup"><span data-stu-id="69012-706">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="69012-707">Al vincular a otra acción en el mismo controlador, no es necesario especificar el nombre del controlador.</span><span class="sxs-lookup"><span data-stu-id="69012-707">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="69012-708">Al vincular a otro controlador en la misma área, no es necesario especificar el nombre del área.</span><span class="sxs-lookup"><span data-stu-id="69012-708">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="69012-709">Al vincular al mismo método de acción, no es necesario especificar los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-709">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="69012-710">Al vincular a otro elemento de la aplicación, no le interesa transferir valores de ruta que no tengan ningún significado en ese elemento del control de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-710">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="69012-711">Las llamadas a `LinkGenerator` o `IUrlHelper` que devuelven `null` se suelen deber a que no se comprende la invalidación del valor de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-711">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="69012-712">Para solucionar problemas de invalidación del valor de ruta, especifique de forma explícita más valores de ruta para ver si eso resuelve el problema.</span><span class="sxs-lookup"><span data-stu-id="69012-712">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="69012-713">La invalidación del valor de ruta se basa en la suposición de que el esquema de direcciones URL de la aplicación es jerárquico, con una jerarquía formada de izquierda a derecha.</span><span class="sxs-lookup"><span data-stu-id="69012-713">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="69012-714">Considere la posibilidad de usar la plantilla de ruta de controlador básica `{controller}/{action}/{id?}` para hacerse una idea intuitiva de cómo funciona esto en la práctica.</span><span class="sxs-lookup"><span data-stu-id="69012-714">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="69012-715">Un **cambio** en un valor **invalida** todos los valores de ruta que aparecen a la derecha.</span><span class="sxs-lookup"><span data-stu-id="69012-715">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="69012-716">Esto refleja la suposición sobre la jerarquía.</span><span class="sxs-lookup"><span data-stu-id="69012-716">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="69012-717">Si la aplicación tiene un valor de ambiente para `id` y la operación especifica otro valor para `controller`:</span><span class="sxs-lookup"><span data-stu-id="69012-717">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="69012-718">`id` no se reutilizará porque `{controller}` está a la izquierda de `{id?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-718">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="69012-719">Algunos ejemplos demuestran este principio:</span><span class="sxs-lookup"><span data-stu-id="69012-719">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="69012-720">Si los valores explícitos contienen un valor para `id`, se omite el valor de ambiente de `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-720">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="69012-721">Se pueden usar los valores de ambiente para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="69012-721">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="69012-722">Si los valores explícitos contienen un valor para `action`, se omite cualquier valor de ambiente para `action`.</span><span class="sxs-lookup"><span data-stu-id="69012-722">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="69012-723">Se pueden usar los valores de ambiente para `controller`.</span><span class="sxs-lookup"><span data-stu-id="69012-723">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="69012-724">Si el valor explícito para `action` es diferente del valor de ambiente para `action`, no se usará el valor de `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-724">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="69012-725">Si el valor explícito para `action` es diferente del valor de ambiente para `action`, se puede usar el valor de `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-725">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="69012-726">Si los valores explícitos contienen un valor para `controller`, se omite cualquier valor de ambiente para `controller`.</span><span class="sxs-lookup"><span data-stu-id="69012-726">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="69012-727">Si el valor explícito para `controller` es diferente del valor de ambiente para `controller`, no se usarán los valores de `action` y `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-727">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="69012-728">Si el valor explícito para `controller` es igual que el valor de ambiente para `controller`, se pueden usar los valores de `action` y `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-728">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="69012-729">Este proceso sea complica todavía más por la existencia de rutas de atributo y rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="69012-729">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="69012-730">Las rutas convencionales de controlador, como `{controller}/{action}/{id?}`, especifican una jerarquía mediante parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-730">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="69012-731">Para las [rutas convencionales dedicadas](xref:mvc/controllers/routing#dcr) y las [rutas de atributo](xref:mvc/controllers/routing#ar) a controladores y Razor Pages:</span><span class="sxs-lookup"><span data-stu-id="69012-731">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="69012-732">Existe una jerarquía de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-732">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="69012-733">No aparecen en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="69012-733">They don't appear in the template.</span></span>

<span data-ttu-id="69012-734">En estos casos, la generación de direcciones URL define el concepto de **valores necesarios**.</span><span class="sxs-lookup"><span data-stu-id="69012-734">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="69012-735">Los puntos de conexión creados por controladores y Razor Pages tienen valores necesarios especificados que permiten que la invalidación del valor de ruta funcione.</span><span class="sxs-lookup"><span data-stu-id="69012-735">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="69012-736">El algoritmo de invalidación del valor de ruta en detalle:</span><span class="sxs-lookup"><span data-stu-id="69012-736">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="69012-737">Los nombres de valor necesarios se combinan con los parámetros de ruta y, después, se procesan de izquierda a derecha.</span><span class="sxs-lookup"><span data-stu-id="69012-737">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="69012-738">Para cada parámetro, se comparan el valor de ambiente y el valor explícito:</span><span class="sxs-lookup"><span data-stu-id="69012-738">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="69012-739">Si el valor de ambiente y el valor explícito son iguales, el proceso continúa.</span><span class="sxs-lookup"><span data-stu-id="69012-739">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="69012-740">Si el valor de ambiente está presente y el valor explícito no, se usa el valor de ambiente al generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-740">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="69012-741">Si el valor de ambiente no está presente y el valor explícito sí, rechace el valor de ambiente y todos los posteriores.</span><span class="sxs-lookup"><span data-stu-id="69012-741">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="69012-742">Si el valor de ambiente y el valor explícito están presentes, y los dos son diferentes, rechace el valor de ambiente y todos los posteriores.</span><span class="sxs-lookup"><span data-stu-id="69012-742">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="69012-743">En este punto, la operación de generación de direcciones URL está lista para evaluar las restricciones de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-743">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="69012-744">El conjunto de valores aceptados se combina con los valores predeterminados de parámetro, que se proporcionan a las restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-744">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="69012-745">Si todas las restricciones son correctas, la operación continúa.</span><span class="sxs-lookup"><span data-stu-id="69012-745">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="69012-746">A continuación, se pueden usar los **valores aceptados** para expandir la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-746">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="69012-747">La plantilla de ruta se procesa:</span><span class="sxs-lookup"><span data-stu-id="69012-747">The route template is processed:</span></span>

* <span data-ttu-id="69012-748">De izquierda a derecha.</span><span class="sxs-lookup"><span data-stu-id="69012-748">From left-to-right.</span></span>
* <span data-ttu-id="69012-749">En cada parámetro se sustituye su valor aceptado.</span><span class="sxs-lookup"><span data-stu-id="69012-749">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="69012-750">Con los siguientes casos especiales:</span><span class="sxs-lookup"><span data-stu-id="69012-750">With the following special cases:</span></span>
  * <span data-ttu-id="69012-751">Si falta un valor en los valores aceptados y el parámetro tiene un valor predeterminado, se usa el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="69012-751">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="69012-752">Si falta un valor en los valores aceptados y el parámetro es opcional, el procesamiento continúa.</span><span class="sxs-lookup"><span data-stu-id="69012-752">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="69012-753">Si un parámetro de ruta a la derecha de un parámetro opcional que falta tiene un valor, se produce un error en la operación.</span><span class="sxs-lookup"><span data-stu-id="69012-753">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="69012-754">Los parámetros con valores predeterminados contiguos y los parámetros opcionales se contraen siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="69012-754">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="69012-755">Los valores que se proporcionan de forma explícita que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="69012-755">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="69012-756">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-756">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="69012-757">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="69012-757">Ambient Values</span></span>                     | <span data-ttu-id="69012-758">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="69012-758">Explicit Values</span></span>                        | <span data-ttu-id="69012-759">Resultado</span><span class="sxs-lookup"><span data-stu-id="69012-759">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="69012-760">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-760">controller = "Home"</span></span>                | <span data-ttu-id="69012-761">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-761">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-762">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-762">controller = "Home"</span></span>                | <span data-ttu-id="69012-763">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-763">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="69012-764">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-764">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="69012-765">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-765">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-766">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-766">controller = "Home"</span></span>                | <span data-ttu-id="69012-767">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-767">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="69012-768">Problemas con la invalidación del valor de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-768">Problems with route value invalidation</span></span>

<span data-ttu-id="69012-769">A partir de ASP.NET Core 3.0, algunos esquemas de generación de direcciones URL que se usaban en versiones anteriores de ASP.NET Core no funcionan bien con la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-769">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="69012-770">El equipo de ASP.NET Core planea agregar características para abordar estas necesidades en una versión futura.</span><span class="sxs-lookup"><span data-stu-id="69012-770">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="69012-771">Por ahora, la mejor solución consiste en usar el enrutamiento heredado.</span><span class="sxs-lookup"><span data-stu-id="69012-771">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="69012-772">En el código siguiente se muestra un ejemplo de un esquema de generación de direcciones URL que no es compatible con el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-772">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="69012-773">En el código anterior, se usa el parámetro de ruta `culture` para la localización.</span><span class="sxs-lookup"><span data-stu-id="69012-773">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="69012-774">El objetivo es que el parámetro `culture` siempre se acepte como valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="69012-774">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="69012-775">Pero el parámetro `culture` no se acepta como valor de ambiente debido al funcionamiento de los valores necesarios:</span><span class="sxs-lookup"><span data-stu-id="69012-775">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="69012-776">En la plantilla de ruta `"default"`, el parámetro de ruta `culture` está a la izquierda de `controller`, por lo que los cambios en `controller` no invalidarán `culture`.</span><span class="sxs-lookup"><span data-stu-id="69012-776">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="69012-777">En la plantilla de ruta `"blog"`, se considera que el parámetro de ruta `culture` está a la derecha de `controller`, que aparece en los valores necesarios.</span><span class="sxs-lookup"><span data-stu-id="69012-777">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="69012-778">Configuración de metadatos de punto de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-778">Configuring endpoint metadata</span></span>

<span data-ttu-id="69012-779">Los vínculos siguientes proporcionan información sobre la configuración de metadatos de punto de conexión:</span><span class="sxs-lookup"><span data-stu-id="69012-779">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="69012-780">Habilitación de CORS con enrutamiento de punto de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-780">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="69012-781">[Ejemplo de IAuthorizationPolicyProvider](https://github.com/dotnet/AspNetCore/tree/release/3.1/src/Security/samples/CustomPolicyProvider) con un atributo `[MinimumAgeAuthorize]` personalizado</span><span class="sxs-lookup"><span data-stu-id="69012-781">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.1/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="69012-782">[Autenticación de pruebas con el atributo [Authorize]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="69012-782">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="69012-783">[Selección del esquema con el atributo [Authorize]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="69012-783">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="69012-784">[Aplicación de directivas con el atributo [Authorize]](xref:security/authorization/policies#apply-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="69012-784">[Apply policies using the [Authorize] attribute](xref:security/authorization/policies#apply-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="69012-785">Comparación de host en rutas con RequireHost</span><span class="sxs-lookup"><span data-stu-id="69012-785">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="69012-786"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> aplica una restricción a la ruta que requiere el host especificado.</span><span class="sxs-lookup"><span data-stu-id="69012-786"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="69012-787">El parámetro `RequireHost` o [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) puede ser:</span><span class="sxs-lookup"><span data-stu-id="69012-787">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="69012-788">Host: `www.domain.com`, compara `www.domain.com` con cualquier puerto.</span><span class="sxs-lookup"><span data-stu-id="69012-788">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="69012-789">Host con carácter comodín: `*.domain.com`, coincide con `www.domain.com`, `subdomain.domain.com` o `www.subdomain.domain.com` en cualquier puerto.</span><span class="sxs-lookup"><span data-stu-id="69012-789">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="69012-790">Puerto: `*:5000`, coincide con el puerto 5000 con cualquier host.</span><span class="sxs-lookup"><span data-stu-id="69012-790">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="69012-791">Host y puerto: `www.domain.com:5000` o `*.domain.com:5000`, coincide con el host y el puerto.</span><span class="sxs-lookup"><span data-stu-id="69012-791">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="69012-792">Se pueden especificar varios parámetros mediante `RequireHost` o `[Host]`.</span><span class="sxs-lookup"><span data-stu-id="69012-792">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="69012-793">La restricción coincide con los hosts válidos para cualquiera de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="69012-793">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="69012-794">Por ejemplo, `[Host("domain.com", "*.domain.com")]` coincide con `domain.com`, `www.domain.com` y `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="69012-794">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="69012-795">En el código siguiente se usa `RequireHost` para requerir el host especificado en la ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-795">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="69012-796">En el código siguiente se usa el atributo `[Host]` en el controlador para requerir cualquiera de los hosts especificados:</span><span class="sxs-lookup"><span data-stu-id="69012-796">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="69012-797">Cuando el atributo `[Host]` se aplica al método de acción y al controlador:</span><span class="sxs-lookup"><span data-stu-id="69012-797">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="69012-798">Se usa el atributo en la acción.</span><span class="sxs-lookup"><span data-stu-id="69012-798">The attribute on the action is used.</span></span>
* <span data-ttu-id="69012-799">Se omite el atributo del controlador.</span><span class="sxs-lookup"><span data-stu-id="69012-799">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="69012-800">Instrucciones de rendimiento para el enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-800">Performance guidance for routing</span></span>

<span data-ttu-id="69012-801">La mayor parte del enrutamiento se ha actualizado en ASP.NET Core 3.0 para aumentar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="69012-801">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="69012-802">Cuando una aplicación tiene problemas de rendimiento, a menudo se sospecha que el enrutamiento es el problema.</span><span class="sxs-lookup"><span data-stu-id="69012-802">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="69012-803">El motivo es que marcos como los controladores y Razor Pages notifican la cantidad de tiempo empleado en el marco de trabajo en sus mensajes de registro.</span><span class="sxs-lookup"><span data-stu-id="69012-803">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="69012-804">Cuando hay una diferencia significativa entre el tiempo notificado por los controladores y el tiempo total de la solicitud:</span><span class="sxs-lookup"><span data-stu-id="69012-804">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="69012-805">Los desarrolladores eliminan el código de la aplicación como origen del problema.</span><span class="sxs-lookup"><span data-stu-id="69012-805">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="69012-806">Es habitual asumir que el enrutamiento es la causa.</span><span class="sxs-lookup"><span data-stu-id="69012-806">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="69012-807">El rendimiento del enrutamiento se prueba mediante miles de puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-807">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="69012-808">No es probable que una aplicación típica detecte un problema de rendimiento simplemente por ser demasiado grande.</span><span class="sxs-lookup"><span data-stu-id="69012-808">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="69012-809">La causa raíz más común del rendimiento lento del enrutamiento suele ser middleware personalizado con un comportamiento incorrecto.</span><span class="sxs-lookup"><span data-stu-id="69012-809">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="69012-810">En el ejemplo de código siguiente se muestra una técnica básica para limitar el origen del retraso:</span><span class="sxs-lookup"><span data-stu-id="69012-810">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="69012-811">Para controlar el tiempo del enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-811">To time routing:</span></span>

* <span data-ttu-id="69012-812">Intercale cada middleware con una copia del middleware de tiempo que se muestra en el código anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-812">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="69012-813">Agregue un identificador único para poner en correlación los datos de control de tiempo con el código.</span><span class="sxs-lookup"><span data-stu-id="69012-813">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="69012-814">Se trata de una forma básica de reducir el retraso cuando es significativo, por ejemplo, de más de `10ms`.</span><span class="sxs-lookup"><span data-stu-id="69012-814">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="69012-815">Al restar `Time 2` de `Time 1` se notifica el tiempo invertido dentro del middleware `UseRouting`.</span><span class="sxs-lookup"><span data-stu-id="69012-815">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="69012-816">En el código siguiente se usa un enfoque más compacto del código de control de tiempo anterior:</span><span class="sxs-lookup"><span data-stu-id="69012-816">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="69012-817">Características de enrutamiento potencialmente costosas</span><span class="sxs-lookup"><span data-stu-id="69012-817">Potentially expensive routing features</span></span>

<span data-ttu-id="69012-818">En la lista siguiente se proporciona información sobre las características de enrutamiento que son relativamente costosas en comparación con las plantillas de ruta básicas:</span><span class="sxs-lookup"><span data-stu-id="69012-818">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="69012-819">Expresiones regulares: Se pueden escribir expresiones regulares que sean complejas o que tengan un tiempo de ejecución de larga duración con una pequeña cantidad de entradas.</span><span class="sxs-lookup"><span data-stu-id="69012-819">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="69012-820">Segmentos complejos (`{x}-{y}-{z}`):</span><span class="sxs-lookup"><span data-stu-id="69012-820">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="69012-821">Son mucho más costosos que analizar un segmento de ruta de dirección URL convencional.</span><span class="sxs-lookup"><span data-stu-id="69012-821">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="69012-822">El resultado es que se asignan muchas más subcadenas.</span><span class="sxs-lookup"><span data-stu-id="69012-822">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="69012-823">La lógica de segmentos complejos no se ha actualizado en la actualización de rendimiento de enrutamiento de ASP.NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="69012-823">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="69012-824">Acceso a datos sincrónicos: muchas aplicaciones complejas tienen acceso a bases de datos como parte de su enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-824">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="69012-825">Es posible que en ASP.NET Core 2.2 y versiones anteriores el enrutamiento no proporcionara los puntos de extensibilidad correctos para admitir el enrutamiento de acceso a bases de datos.</span><span class="sxs-lookup"><span data-stu-id="69012-825">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="69012-826">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> y <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> son sincrónicos.</span><span class="sxs-lookup"><span data-stu-id="69012-826">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="69012-827">Los puntos de extensibilidad como <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> y <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> son asincrónicos.</span><span class="sxs-lookup"><span data-stu-id="69012-827">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="69012-828">Instrucciones para los autores de bibliotecas</span><span class="sxs-lookup"><span data-stu-id="69012-828">Guidance for library authors</span></span>

<span data-ttu-id="69012-829">Esta sección contiene instrucciones para los autores de bibliotecas que realizan la compilación sobre el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-829">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="69012-830">Estos detalles están diseñados para garantizar que los desarrolladores de aplicaciones tengan una buena experiencia en el uso de bibliotecas y marcos que amplían el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-830">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="69012-831">Definición de puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="69012-831">Define endpoints</span></span>

<span data-ttu-id="69012-832">Para crear un marco que use el enrutamiento para la coincidencia de direcciones URL, empiece por definir una experiencia de usuario que se base en <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="69012-832">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="69012-833">**REALICE** la compilación sobre <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-833">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="69012-834">Esto permite a los usuarios crear el marco de trabajo con otras características de ASP.NET Core sin confusión.</span><span class="sxs-lookup"><span data-stu-id="69012-834">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="69012-835">Todas las plantillas de ASP.NET Core incluyen el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-835">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="69012-836">Asuma que el enrutamiento está presente y es familiar para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="69012-836">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="69012-837">**DEVUELVA** un tipo concreto sellado a partir de una llamada a `MapMyFramework(...)` que implemente <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-837">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="69012-838">La mayoría de los métodos `Map...` del marco siguen este patrón.</span><span class="sxs-lookup"><span data-stu-id="69012-838">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="69012-839">La interfaz `IEndpointConventionBuilder`:</span><span class="sxs-lookup"><span data-stu-id="69012-839">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="69012-840">Permite la composición de metadatos.</span><span class="sxs-lookup"><span data-stu-id="69012-840">Allows composability of metadata.</span></span>
* <span data-ttu-id="69012-841">Es el destino de diversos métodos de extensión.</span><span class="sxs-lookup"><span data-stu-id="69012-841">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="69012-842">La declaración de un tipo propio permite agregar funcionalidad específica del marco propia al generador.</span><span class="sxs-lookup"><span data-stu-id="69012-842">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="69012-843">Es correcto encapsular un generador declarado por el marco y reenviarle llamadas.</span><span class="sxs-lookup"><span data-stu-id="69012-843">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="69012-844">**CONSIDERE LA POSIBILIDAD** de escribir un objeto <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> propio.</span><span class="sxs-lookup"><span data-stu-id="69012-844">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="69012-845">`EndpointDataSource` es la primitiva de bajo nivel para declarar y actualizar una colección de puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-845">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="69012-846">`EndpointDataSource` es una API eficaz que usan los controladores y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-846">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="69012-847">Las pruebas de enrutamiento tienen un [ejemplo básico](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) de un origen de datos que no es de actualización.</span><span class="sxs-lookup"><span data-stu-id="69012-847">The routing tests have a [basic example](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="69012-848">**NO** intente registrar un objeto `EndpointDataSource` de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="69012-848">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="69012-849">Exija a los usuarios que registren el marco en <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span><span class="sxs-lookup"><span data-stu-id="69012-849">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="69012-850">La filosofía del enrutamiento es que nada se incluye de forma predeterminada y que `UseEndpoints` es el lugar donde se registran los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-850">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="69012-851">Creación de middleware con enrutamiento integrada</span><span class="sxs-lookup"><span data-stu-id="69012-851">Creating routing-integrated middleware</span></span>

<span data-ttu-id="69012-852">**CONSIDERE LA POSIBILIDAD** de definir tipos de metadatos como una interfaz.</span><span class="sxs-lookup"><span data-stu-id="69012-852">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="69012-853">**PERMITA** el uso de los tipos de metadatos como atributo en clases y métodos.</span><span class="sxs-lookup"><span data-stu-id="69012-853">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="69012-854">Los marcos como los controladores y Razor Pages admiten la aplicación de atributos de metadatos a tipos y métodos.</span><span class="sxs-lookup"><span data-stu-id="69012-854">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="69012-855">Si declara tipos de metadatos:</span><span class="sxs-lookup"><span data-stu-id="69012-855">If you declare metadata types:</span></span>

* <span data-ttu-id="69012-856">Haga que sean accesibles como [atributos](/dotnet/csharp/programming-guide/concepts/attributes/).</span><span class="sxs-lookup"><span data-stu-id="69012-856">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="69012-857">La mayoría de los usuarios están familiarizados con la aplicación de atributos.</span><span class="sxs-lookup"><span data-stu-id="69012-857">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="69012-858">La declaración de un tipo de metadatos como una interfaz agrega otro nivel de flexibilidad:</span><span class="sxs-lookup"><span data-stu-id="69012-858">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="69012-859">Las interfaces admiten composición.</span><span class="sxs-lookup"><span data-stu-id="69012-859">Interfaces are composable.</span></span>
* <span data-ttu-id="69012-860">Los desarrolladores pueden declarar tipos propios que combinen varias directivas.</span><span class="sxs-lookup"><span data-stu-id="69012-860">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="69012-861">**PERMITA** que los metadatos se puedan invalidar, como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-861">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="69012-862">La mejor manera de seguir estas instrucciones es evitar la definición de **metadatos de marcador**:</span><span class="sxs-lookup"><span data-stu-id="69012-862">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="69012-863">No busque solo la presencia de un tipo de metadatos.</span><span class="sxs-lookup"><span data-stu-id="69012-863">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="69012-864">Defina una propiedad en los metadatos y compruébela.</span><span class="sxs-lookup"><span data-stu-id="69012-864">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="69012-865">La colección de metadatos está ordenada y admite la invalidación por prioridad.</span><span class="sxs-lookup"><span data-stu-id="69012-865">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="69012-866">En el caso de los controladores, los metadatos del método de acción son más específicos.</span><span class="sxs-lookup"><span data-stu-id="69012-866">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="69012-867">**PERMITA** que el middleware sea útil con y sin el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-867">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequireAuthorization();
});
```

<span data-ttu-id="69012-868">Como ejemplo de esta instrucción, considere la posibilidad de usar el middleware `UseAuthorization`.</span><span class="sxs-lookup"><span data-stu-id="69012-868">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="69012-869">El middleware de autorización permite pasar una directiva de reserva.</span><span class="sxs-lookup"><span data-stu-id="69012-869">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="69012-870">La directiva de reserva, si se especifica, se aplica a:</span><span class="sxs-lookup"><span data-stu-id="69012-870">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="69012-871">Puntos de conexión sin una directiva especificada.</span><span class="sxs-lookup"><span data-stu-id="69012-871">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="69012-872">Solicitudes que no coinciden con un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-872">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="69012-873">Esto hace que el middleware de autorización sea útil fuera del contexto del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-873">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="69012-874">El middleware de autorización se puede usar para la programación de middleware tradicional.</span><span class="sxs-lookup"><span data-stu-id="69012-874">The authorization middleware can be used for traditional middleware programming.</span></span>

[!INCLUDE[](~/includes/dbg-route.md)]

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="69012-875">El enrutamiento es responsable de asignar URI de solicitud a los puntos de conexión y de distribuir las solicitudes entrantes a esos puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-875">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="69012-876">Las rutas se definen en la aplicación y se configuran cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-876">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="69012-877">Una ruta puede extraer opcionalmente valores de la dirección URL contenida en la solicitud, que se pueden usar para procesar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-877">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="69012-878">Con la información de ruta de la aplicación, el enrutamiento también puede generar direcciones URL que se asignan a puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-878">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="69012-879">Para usar los escenarios de enrutamiento más recientes de ASP.NET Core 2.2, especifique la [versión de compatibilidad](xref:mvc/compatibility-version) en el registro de servicios de MVC en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-879">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="69012-880">La opción <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> determina si el enrutamiento debe usar de forma interna la lógica basada en el punto de conexión o la lógica basada en <xref:Microsoft.AspNetCore.Routing.IRouter> de ASP.NET Core 2.1 o una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-880">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="69012-881">Cuando la versión de compatibilidad se establece en 2.2 o una versión posterior, el valor predeterminado es `true`.</span><span class="sxs-lookup"><span data-stu-id="69012-881">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="69012-882">Establezca el valor en `false` para usar la lógica de enrutamiento anterior:</span><span class="sxs-lookup"><span data-stu-id="69012-882">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="69012-883">Para obtener más información sobre el enrutamiento basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, vea la [versión para ASP.NET Core 2.1 de este tema](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="69012-883">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="69012-884">En este documento se describe el enrutamiento de ASP.NET Core de bajo nivel.</span><span class="sxs-lookup"><span data-stu-id="69012-884">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="69012-885">Para obtener información sobre el enrutamiento de ASP.NET Core MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="69012-885">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="69012-886">Para obtener más información sobre las convenciones de enrutamiento en Razor Pages, consulte <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="69012-886">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="69012-887">[Vea o descargue el código de ejemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="69012-887">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="69012-888">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-888">Routing basics</span></span>

<span data-ttu-id="69012-889">La mayoría de las aplicaciones deben elegir un esquema de enrutamiento básico y descriptivo para que las direcciones URL sean legibles y significativas.</span><span class="sxs-lookup"><span data-stu-id="69012-889">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="69012-890">La ruta convencional predeterminada `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="69012-890">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="69012-891">Admite un esquema de enrutamiento básico y descriptivo.</span><span class="sxs-lookup"><span data-stu-id="69012-891">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="69012-892">Se trata de un punto de partida útil para las aplicaciones basadas en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="69012-892">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="69012-893">Los desarrolladores suelen agregar rutas breves adicionales a áreas de mucho tráfico de una aplicación en situaciones especializadas mediante el [enrutamiento de atributos](xref:mvc/controllers/routing#attribute-routing) o rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="69012-893">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="69012-894">Entre los ejemplos de situaciones especializadas se incluyen los puntos de conexión de blog y de comercio electrónico.</span><span class="sxs-lookup"><span data-stu-id="69012-894">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="69012-895">Las API web deben usar el enrutamiento mediante atributos para modelar la funcionalidad de la aplicación como un conjunto de recursos donde las operaciones se representan mediante verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-895">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="69012-896">Esto significa que muchas operaciones (por ejemplo, GET y POST) del mismo recurso lógico usan la misma dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-896">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="69012-897">El enrutamiento mediante atributos proporciona un nivel de control que es necesario para diseñar cuidadosamente un diseño de puntos de conexión públicos de la API.</span><span class="sxs-lookup"><span data-stu-id="69012-897">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="69012-898">En las aplicaciones de Razor Pages se usa el enrutamiento convencional predeterminado para proporcionar recursos con nombre en la carpeta *Páginas* de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-898">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="69012-899">Existen convenciones adicionales que permiten personalizar el comportamiento de enrutamiento de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-899">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="69012-900">Para obtener más información, vea <xref:razor-pages/index> y <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="69012-900">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="69012-901">La compatibilidad de la generación de direcciones URL permite desarrollar la aplicación sin codificar de forma rígida las direcciones URL para vincular la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-901">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="69012-902">Esta compatibilidad permite empezar con una configuración de enrutamiento básica y modificar las rutas una vez determinado el diseño de los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-902">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="69012-903">El enrutamiento usa *puntos de conexión* (`Endpoint`) para representar los puntos de conexión lógicos en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-903">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="69012-904">Un punto de conexión define un delegado para procesar las solicitudes y una colección de metadatos arbitrarios.</span><span class="sxs-lookup"><span data-stu-id="69012-904">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="69012-905">Los metadatos se usan para implementar cuestiones transversales según las directivas y la configuración asociada a cada punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-905">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="69012-906">El sistema de enrutamiento tiene las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-906">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="69012-907">La sintaxis de plantilla de ruta se usa para definir las rutas con parámetros de ruta con tokens.</span><span class="sxs-lookup"><span data-stu-id="69012-907">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="69012-908">Se permite la configuración de puntos de conexión de estilo convencional y de estilo de atributo.</span><span class="sxs-lookup"><span data-stu-id="69012-908">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="69012-909">Se usa <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para determinar si un parámetro de dirección URL contiene un valor válido para una restricción de punto de conexión determinada.</span><span class="sxs-lookup"><span data-stu-id="69012-909"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="69012-910">Los modelos de aplicación, como MVC y Razor Pages, registran todos sus puntos de conexión, que presentan una implementación predecible de los escenarios de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-910">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="69012-911">La implementación de enrutamiento toma decisiones relativas al enrutamiento siempre que sea lo deseado en la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="69012-911">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="69012-912">El middleware que aparece después de un middleware de enrutamiento puede inspeccionar el resultado de la decisión del punto de conexión del middleware de enrutamiento para un URI de solicitud determinado.</span><span class="sxs-lookup"><span data-stu-id="69012-912">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="69012-913">Se pueden enumerar todos los puntos de conexión de la aplicación en cualquier parte de la canalización de middleware.</span><span class="sxs-lookup"><span data-stu-id="69012-913">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="69012-914">Una aplicación puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información del punto de conexión. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="69012-914">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="69012-915">La generación de direcciones URL se basa en direcciones, que admiten la extensibilidad arbitraria:</span><span class="sxs-lookup"><span data-stu-id="69012-915">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="69012-916">La API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) se puede resolver en cualquier lugar mediante la [inserción de dependencias (DI)](xref:fundamentals/dependency-injection) para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-916">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="69012-917">Cuando la API del generador de vínculos no está disponible a través de DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> ofrece métodos para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-917">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="69012-918">Con el lanzamiento del enrutamiento de punto de conexión en ASP.NET Core 2.2, la vinculación de punto de conexión se limita a acciones y páginas de Razor Pages y MVC.</span><span class="sxs-lookup"><span data-stu-id="69012-918">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="69012-919">Las expansiones de las funciones de vinculación de punto de conexión están previstas para próximas versiones.</span><span class="sxs-lookup"><span data-stu-id="69012-919">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="69012-920">La clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> conecta el enrutamiento a la canalización de [software intermedio](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="69012-920">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="69012-921">[ASP.NET Core MVC](xref:mvc/overview) agrega enrutamiento a la canalización de middleware como parte de su configuración y controla el enrutamiento en las aplicaciones de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-921">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="69012-922">Para obtener información sobre cómo usar el enrutamiento como componente independiente, vea la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="69012-922">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="69012-923">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-923">URL matching</span></span>

<span data-ttu-id="69012-924">La coincidencia de dirección URL es el proceso por el cual el enrutamiento envía una solicitud entrante a un *punto de conexión*.</span><span class="sxs-lookup"><span data-stu-id="69012-924">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="69012-925">Este proceso se basa en datos de la ruta de dirección URL, pero se puede ampliar para tener en cuenta cualquier dato de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-925">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="69012-926">La capacidad de enviar solicitudes a controladores independientes es clave para escalar el tamaño y la complejidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-926">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="69012-927">El sistema de enrutamiento en el enrutamiento de punto de conexión es responsable de todas las decisiones relativas al envío.</span><span class="sxs-lookup"><span data-stu-id="69012-927">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="69012-928">Como el middleware aplica las directivas en función del punto de conexión seleccionado, es importante que cualquier decisión que pueda afectar a la distribución o la aplicación de directivas de seguridad se realice dentro del sistema de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-928">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="69012-929">Cuando se ejecuta el delegado del punto de conexión, las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) se establecen en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="69012-929">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="69012-930">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) es un diccionario de los *valores de ruta* generados desde la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-930">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="69012-931">Estos valores se suelen determinar mediante la conversión en tokens de la dirección URL, y se pueden usar para aceptar la entrada del usuario o para tomar otras decisiones sobre el envío dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-931">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="69012-932">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) es un contenedor de propiedades de datos adicionales relacionados con la ruta coincidente.</span><span class="sxs-lookup"><span data-stu-id="69012-932">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="69012-933">Se proporcionan <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> para permitir la asociación de datos de estado con cada ruta, de modo que la aplicación pueda tomar decisiones en función de las rutas que han coincidido.</span><span class="sxs-lookup"><span data-stu-id="69012-933"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="69012-934">Estos valores los define el desarrollador y **no** afectan de ninguna manera al comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-934">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="69012-935">Además, los valores que se guardan provisionalmente en [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) pueden ser de cualquier tipo, a diferencia de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que deben poder convertirse fácilmente en cadenas y a partir de estas.</span><span class="sxs-lookup"><span data-stu-id="69012-935">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="69012-936">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) es una lista de las rutas que han participado en encontrar una coincidencia correcta con la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-936">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="69012-937">Las rutas se pueden anidar unas dentro de otras.</span><span class="sxs-lookup"><span data-stu-id="69012-937">Routes can be nested inside of one another.</span></span> <span data-ttu-id="69012-938">La propiedad <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> refleja la ruta de acceso del árbol lógico de rutas que han tenido como resultado una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-938">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="69012-939">Por lo general, el primer elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es la colección de rutas y se debe usar para la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-939">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="69012-940">El último elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es el controlador de ruta que ha coincidido.</span><span class="sxs-lookup"><span data-stu-id="69012-940">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="69012-941">Generación de direcciones URL con LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="69012-941">URL generation with LinkGenerator</span></span>

<span data-ttu-id="69012-942">La generación de dirección URL es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL basada en un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-942">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="69012-943">Esto permite una separación lógica entre los puntos de conexión y las direcciones URL que tienen acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="69012-943">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="69012-944">El enrutamiento de punto de conexión incluye la API del generador de vínculos (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="69012-944">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="69012-945"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> es un servicio singleton que se puede recuperar a partir de la [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="69012-945"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="69012-946">La API se puede usar fuera del contexto de una solicitud en ejecución.</span><span class="sxs-lookup"><span data-stu-id="69012-946">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="69012-947"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> de MVC y los escenarios que dependen de <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, como los [asistentes de etiquetas](xref:mvc/views/tag-helpers/intro), los de HTML y [los resultados de acción](xref:mvc/controllers/actions), usan el generador de vínculos para proporcionar funciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-947">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="69012-948">El generador de vínculos está respaldado por el concepto de una *dirección* y *esquemas de direcciones*.</span><span class="sxs-lookup"><span data-stu-id="69012-948">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="69012-949">Un esquema de direcciones es una manera de determinar los puntos de conexión que se deben tener en cuenta para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-949">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="69012-950">Por ejemplo, los escenarios de nombre y valores de ruta de Razor Pages y MVC con los que muchos usuarios están familiarizados se implementan como un esquema de direcciones.</span><span class="sxs-lookup"><span data-stu-id="69012-950">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="69012-951">El generador de vínculos puede vincular a acciones y páginas de Razor Pages y MVC a través de los métodos de extensión siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-951">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="69012-952">Una sobrecarga de estos métodos acepta argumentos que incluyan `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="69012-952">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="69012-953">Estos métodos son equivalentes funcionalmente a `Url.Action` y `Url.Page`, pero ofrecen flexibilidad y opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="69012-953">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="69012-954">Los métodos `GetPath*` son más similares a `Url.Action` y `Url.Page`, dado que generan un URI que contiene una ruta de acceso absoluta.</span><span class="sxs-lookup"><span data-stu-id="69012-954">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="69012-955">Los métodos `GetUri*` siempre generan un URI absoluto que contiene un esquema y un host.</span><span class="sxs-lookup"><span data-stu-id="69012-955">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="69012-956">Los métodos que aceptan `HttpContext` generan un URI en el contexto de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="69012-956">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="69012-957">A menos que se reemplacen, se usan los valores de ruta de ambiente, la ruta de acceso base de la dirección URL, el esquema y el host de la solicitud que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="69012-957">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="69012-958">Se llama a <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con una dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-958"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="69012-959">La generación de un URI se produce en dos pasos:</span><span class="sxs-lookup"><span data-stu-id="69012-959">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="69012-960">Se enlaza una dirección a una lista de puntos de conexión que coincidan con la dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-960">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="69012-961">Se evalúa el elemento `RoutePattern` de cada punto de conexión hasta que se encuentra un patrón de ruta que coincida con los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-961">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="69012-962">La salida resultante se combina con otras partes del URI proporcionadas al generador de vínculos y devueltas.</span><span class="sxs-lookup"><span data-stu-id="69012-962">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="69012-963">Los métodos proporcionados por <xref:Microsoft.AspNetCore.Routing.LinkGenerator> admiten funciones estándar de generación de vínculos para cualquier tipo de dirección.</span><span class="sxs-lookup"><span data-stu-id="69012-963">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="69012-964">La forma más útil de usar el generador de vínculos es a través de métodos de extensión que realicen operaciones para un tipo de dirección específica.</span><span class="sxs-lookup"><span data-stu-id="69012-964">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="69012-965">Método de extensión</span><span class="sxs-lookup"><span data-stu-id="69012-965">Extension Method</span></span>   | <span data-ttu-id="69012-966">Descripción</span><span class="sxs-lookup"><span data-stu-id="69012-966">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="69012-967">Genera un URI con una ruta de acceso absoluta en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-967">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="69012-968">Genera un URI absoluto en función de los valores proporcionados.</span><span class="sxs-lookup"><span data-stu-id="69012-968">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="69012-969">Preste atención a las consecuencias siguientes de llamar a los métodos <xref:Microsoft.AspNetCore.Routing.LinkGenerator>:</span><span class="sxs-lookup"><span data-stu-id="69012-969">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="69012-970">Use los métodos de extensión `GetUri*` con precaución en una configuración de aplicación en la que no se valide el encabezado `Host` de las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="69012-970">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="69012-971">Si no se valida el encabezado `Host` de las solicitudes entrantes, la entrada de la solicitud que no sea de confianza se puede devolver al cliente en los URI de una página o vista.</span><span class="sxs-lookup"><span data-stu-id="69012-971">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="69012-972">Se recomienda que todas las aplicaciones de producción configuren su servidor para validar el encabezado `Host` en función de valores válidos conocidos.</span><span class="sxs-lookup"><span data-stu-id="69012-972">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="69012-973">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> con precaución en el middleware junto con `Map` o `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="69012-973">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="69012-974">`Map*` cambia la ruta de acceso base de la solicitud que se ejecuta, lo que afecta a la salida de la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-974">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="69012-975">Todas las API de <xref:Microsoft.AspNetCore.Routing.LinkGenerator> permiten especificar una ruta de acceso base.</span><span class="sxs-lookup"><span data-stu-id="69012-975">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="69012-976">Especifique siempre una ruta de acceso base vacía para deshacer el efecto de `Map*` en la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-976">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="69012-977">Diferencias con respecto a versiones anteriores del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-977">Differences from earlier versions of routing</span></span>

<span data-ttu-id="69012-978">Existen algunas diferencias entre el enrutamiento de punto de conexión de ASP.NET Core 2.2 o posterior, y las versiones anteriores del enrutamiento en ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="69012-978">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="69012-979">El sistema de enrutamiento de punto de conexión no es compatible con la extensibilidad basada en <xref:Microsoft.AspNetCore.Routing.IRouter>, incluida la herencia de <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="69012-979">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="69012-980">El enrutamiento de punto de conexión no es compatible con [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="69012-980">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="69012-981">Utilice la [versión compatibilidad](xref:mvc/compatibility-version) 2.1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) para seguir usando la corrección de compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="69012-981">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="69012-982">El enrutamiento de punto de conexión tiene un comportamiento diferente para el uso de mayúsculas y minúsculas en los URI generados al usar rutas convencionales.</span><span class="sxs-lookup"><span data-stu-id="69012-982">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="69012-983">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-983">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="69012-984">Supongamos que genera un vínculo a una acción mediante la ruta siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-984">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="69012-985">Con el enrutamiento basado en <xref:Microsoft.AspNetCore.Routing.IRouter>, este código genera un URI de `/blog/ReadPost/17`, que respeta las mayúsculas y minúsculas del valor de ruta proporcionado.</span><span class="sxs-lookup"><span data-stu-id="69012-985">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="69012-986">El enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17` ("Blog" se pone mayúscula).</span><span class="sxs-lookup"><span data-stu-id="69012-986">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="69012-987">El enrutamiento de punto de conexión proporciona la interfaz `IOutboundParameterTransformer`, que se puede usar para personalizar este comportamiento de forma global, o bien para aplicar otras convenciones para la asignación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-987">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="69012-988">Para obtener más información, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-988">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="69012-989">La generación de vínculos que se usa en Razor Pages y MVC con las rutas convencionales tiene un comportamiento diferente al intentar vincularlo a un controlador o una acción, o a una página que no existe.</span><span class="sxs-lookup"><span data-stu-id="69012-989">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="69012-990">Tenga en cuenta la plantilla de ruta predeterminada siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-990">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="69012-991">Supongamos que genera un vínculo a una acción mediante la plantilla predeterminada con lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="69012-991">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="69012-992">Con el enrutamiento basado en `IRouter`, el resultado siempre es `/Blog/ReadPost/17`, incluso aunque `BlogController` no exista o no tenga un método de acción `ReadPost`.</span><span class="sxs-lookup"><span data-stu-id="69012-992">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="69012-993">Como se esperaba, si el método de acción existe, el enrutamiento de punto de conexión de ASP.NET Core 2.2 o versiones posteriores genera `/Blog/ReadPost/17`.</span><span class="sxs-lookup"><span data-stu-id="69012-993">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="69012-994">*Sin embargo, si la acción no existe, el enrutamiento de punto de conexión genera una cadena vacía.*</span><span class="sxs-lookup"><span data-stu-id="69012-994">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="69012-995">Conceptualmente, el enrutamiento de punto de conexión no supone que, si la acción no existe, sí que exista el punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-995">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="69012-996">El *algoritmo de invalidación del valor de ambiente* de la generación de vínculos tiene otro comportamiento al usarlo con el enrutamiento de punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-996">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="69012-997">La *invalidación del valor de ambiente* es el algoritmo que decide qué valores de ruta de la solicitud que se ejecuta actualmente (los valores de ambiente) se pueden usar en las operaciones de generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-997">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="69012-998">El enrutamiento convencional siempre invalida los valores de ruta adicionales al vincular a otra acción.</span><span class="sxs-lookup"><span data-stu-id="69012-998">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="69012-999">El enrutamiento mediante atributos no tenía este comportamiento antes del lanzamiento de ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="69012-999">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="69012-1000">En versiones anteriores de ASP.NET Core, los vínculos a otra acción que usara los mismos nombres de parámetro de ruta producían errores de generación de vínculo.</span><span class="sxs-lookup"><span data-stu-id="69012-1000">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="69012-1001">En ASP.NET Core 2.2 o versiones posteriores, las dos formas de enrutamiento invalidan los valores cuando se vincula a otra acción.</span><span class="sxs-lookup"><span data-stu-id="69012-1001">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="69012-1002">Considere el ejemplo siguiente de ASP.NET Core 2.1 o una versión anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1002">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="69012-1003">Al vincular a otra acción (o a otra página), los valores de ruta se pueden reutilizar de formas no deseadas.</span><span class="sxs-lookup"><span data-stu-id="69012-1003">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="69012-1004">En */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="69012-1004">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="69012-1005">En */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="69012-1005">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="69012-1006">Si el URI es `/Store/Product/18` en ASP.NET Core 2.1 o versiones anteriores, el vínculo que genera `@Url.Page("/Login")` en la página Store/Info es `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="69012-1006">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="69012-1007">Se reutiliza el valor `id` de 18, aunque el destino del vínculo sea otro elemento totalmente distinto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1007">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="69012-1008">El valor de ruta `id` en el contexto de la página `/Login` probablemente sea un valor de id. de usuario, no un valor de id. de producto de tienda.</span><span class="sxs-lookup"><span data-stu-id="69012-1008">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="69012-1009">En el enrutamiento de punto de conexión con ASP.NET Core 2.2 o versiones posteriores, el resultado es `/Login`.</span><span class="sxs-lookup"><span data-stu-id="69012-1009">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="69012-1010">Los valores de ambiente no se reutilizan cuando el destino vinculado es otra acción o página.</span><span class="sxs-lookup"><span data-stu-id="69012-1010">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="69012-1011">Sintaxis de parámetro de ruta de ida y vuelta: las barras diagonales no se codifican cuando se usa una sintaxis de parámetro comodín de doble asterisco (`**`).</span><span class="sxs-lookup"><span data-stu-id="69012-1011">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="69012-1012">Durante la generación de vínculos, el sistema de enrutamiento codifica el valor capturado en un parámetro comodín de doble asterisco (`**`; por ejemplo, `{**myparametername}`), excepto las barras diagonales.</span><span class="sxs-lookup"><span data-stu-id="69012-1012">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="69012-1013">El comodín de doble asterisco es compatible con el enrutamiento basado en `IRouter` en ASP.NET Core 2.2 o versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="69012-1013">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="69012-1014">La sintaxis de parámetro comodín de un único asterisco en versiones anteriores de ASP.NET Core (`{*myparametername}`) sigue siendo compatible y las barras diagonales se codifican.</span><span class="sxs-lookup"><span data-stu-id="69012-1014">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="69012-1015">Ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1015">Route</span></span>              | <span data-ttu-id="69012-1016">Vínculo generado con</span><span class="sxs-lookup"><span data-stu-id="69012-1016">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="69012-1017">`/search/admin%2Fproducts` (la barra diagonal se codifica)</span><span class="sxs-lookup"><span data-stu-id="69012-1017">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="69012-1018">Ejemplo de middleware</span><span class="sxs-lookup"><span data-stu-id="69012-1018">Middleware example</span></span>

<span data-ttu-id="69012-1019">En el ejemplo siguiente, un middleware usa la API <xref:Microsoft.AspNetCore.Routing.LinkGenerator> para crear el vínculo a un método de acción que enumera los productos de la tienda.</span><span class="sxs-lookup"><span data-stu-id="69012-1019">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="69012-1020">El uso del generador de vínculos mediante su inserción en una clase y la llamada a `GenerateLink` está disponible para cualquier clase de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1020">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="69012-1021">Creación de rutas</span><span class="sxs-lookup"><span data-stu-id="69012-1021">Create routes</span></span>

<span data-ttu-id="69012-1022">La mayoría de las aplicaciones crea rutas mediante una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> o a uno de los métodos de extensión similares definidos en <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-1022">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="69012-1023">Todos los métodos de extensión <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> crean una instancia de <xref:Microsoft.AspNetCore.Routing.Route> y la agregan a la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-1023">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="69012-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> no acepta un parámetro de controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="69012-1025"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> solo agrega las rutas que se controlan mediante <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1025"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="69012-1026">Para obtener más información sobre el enrutamiento en MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="69012-1026">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="69012-1027">El código siguiente es un ejemplo de una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por una definición de ruta típica de ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="69012-1027">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="69012-1028">Esta plantilla coincide con una ruta de dirección URL y extrae los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1028">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="69012-1029">Por ejemplo, la ruta de acceso `/Products/Details/17` genera los valores de ruta siguientes: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1029">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="69012-1030">Los valores de ruta se determinan al dividir la ruta de dirección URL en segmentos y hacer coincidir cada segmento con el nombre del *parámetro de ruta* en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1030">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="69012-1031">Los parámetros de ruta tienen un nombre asignado.</span><span class="sxs-lookup"><span data-stu-id="69012-1031">Route parameters are named.</span></span> <span data-ttu-id="69012-1032">Para definir los parámetros, el nombre del parámetro se incluye entre llaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1032">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="69012-1033">La plantilla anterior también podría coincidir con la ruta de dirección URL `/` y generar los valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1033">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="69012-1034">Esto se debe a que los parámetros de ruta `{controller}` y `{action}` tienen valores predeterminados y el parámetro de ruta `id` es opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1034">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="69012-1035">Un signo igual (`=`) seguido de un valor después del nombre del parámetro de ruta define un valor predeterminado para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1035">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="69012-1036">Un signo de interrogación (`?`) después del nombre del parámetro de ruta define un parámetro opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1036">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="69012-1037">Los parámetros de ruta con un valor predeterminado *siempre* generan un valor de ruta cuando la ruta coincide.</span><span class="sxs-lookup"><span data-stu-id="69012-1037">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="69012-1038">Los parámetros opcionales no generan un valor de ruta si no existe el segmento de ruta de dirección URL correspondiente.</span><span class="sxs-lookup"><span data-stu-id="69012-1038">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="69012-1039">Vea la sección [Referencia de plantilla de ruta](#route-template-reference) para obtener una descripción detallada de los escenarios y la sintaxis de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1039">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="69012-1040">En el ejemplo siguiente, la definición de parámetro de ruta `{id:int}` define una [restricción de ruta](#route-constraint-reference) para el parámetro de ruta `id`:</span><span class="sxs-lookup"><span data-stu-id="69012-1040">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="69012-1041">Esta plantilla coincide con una ruta de dirección URL como `/Products/Details/17`, pero no con `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="69012-1041">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="69012-1042">Las restricciones de ruta implementan <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspeccionan los valores de ruta para comprobarlos.</span><span class="sxs-lookup"><span data-stu-id="69012-1042">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="69012-1043">En este ejemplo, el valor de ruta `id` debe poder convertirse en un entero.</span><span class="sxs-lookup"><span data-stu-id="69012-1043">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="69012-1044">Vea la [Referencia de restricción de ruta](#route-constraint-reference) para obtener una explicación de las restricciones de ruta proporcionadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="69012-1044">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="69012-1045">Las sobrecargas adicionales de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceptan valores para `constraints`, `dataTokens` y `defaults`.</span><span class="sxs-lookup"><span data-stu-id="69012-1045">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="69012-1046">Estos parámetros suelen usarse para pasar un objeto de tipo anónimo, donde los nombres de propiedad del tipo anónimo coinciden con los nombres de los parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1046">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="69012-1047">En los ejemplos <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> siguientes se crean rutas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="69012-1047">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="69012-1048">La sintaxis insertada para definir las restricciones y los valores predeterminados puede ser conveniente para las rutas simples.</span><span class="sxs-lookup"><span data-stu-id="69012-1048">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="69012-1049">Pero hay algunos escenarios, como los tokens de datos, que no son compatibles con la sintaxis insertada.</span><span class="sxs-lookup"><span data-stu-id="69012-1049">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="69012-1050">En el ejemplo siguiente se muestran algunos escenarios más:</span><span class="sxs-lookup"><span data-stu-id="69012-1050">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="69012-1051">La plantilla anterior coincide con una ruta de dirección URL como `/Blog/All-About-Routing/Introduction` y extrae los valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1051">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="69012-1052">La ruta genera los valores de ruta predeterminados para `controller` y `action`, incluso si no hay parámetros de ruta correspondientes en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="69012-1052">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="69012-1053">Los valores predeterminados pueden especificarse en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1053">Default values can be specified in the route template.</span></span> <span data-ttu-id="69012-1054">El parámetro de ruta `article` se define como un *comodín* por la aparición de un asterisco doble (`**`) antes del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1054">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="69012-1055">Los parámetros de ruta comodín capturan el resto de la ruta de dirección URL y también pueden coincidir con la cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="69012-1055">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="69012-1056">En el ejemplo siguiente se agregan restricciones de ruta y tokens de datos:</span><span class="sxs-lookup"><span data-stu-id="69012-1056">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="69012-1057">La plantilla anterior coincide con una ruta de dirección URL como `/en-US/Products/5` y extrae los valores `{ controller = Products, action = Details, id = 5 }` y los tokens de datos `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1057">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens de Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="69012-1059">Generación de direcciones URL de clase de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1059">Route class URL generation</span></span>

<span data-ttu-id="69012-1060">La clase <xref:Microsoft.AspNetCore.Routing.Route> también puede llevar a cabo la generación de dirección URL mediante la combinación de un conjunto de valores de ruta con su plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1060">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="69012-1061">Se trata lógicamente del proceso inverso de hacer coincidir la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1061">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="69012-1062">Para entender mejor la generación de direcciones URL, imagine qué dirección URL quiere generar y, después, piense cómo coincidiría una plantilla de ruta con esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1062">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="69012-1063">¿Qué valores se generarían?</span><span class="sxs-lookup"><span data-stu-id="69012-1063">What values would be produced?</span></span> <span data-ttu-id="69012-1064">Este es un equivalente aproximado de cómo funciona la generación de dirección URL en la clase <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="69012-1064">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="69012-1065">En el ejemplo siguiente se usa una ruta predeterminada de ASP.NET Core MVC general:</span><span class="sxs-lookup"><span data-stu-id="69012-1065">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="69012-1066">Con los valores de ruta `{ controller = Products, action = List }`, se genera la dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="69012-1066">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="69012-1067">Los valores de ruta se sustituyen por los parámetros de ruta correspondientes para formar la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1067">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="69012-1068">Como `id` es un parámetro de ruta opcional, la dirección URL se ha generado correctamente sin ningún valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-1068">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="69012-1069">Con los valores de ruta `{ controller = Home, action = Index }`, se genera la dirección URL `/`.</span><span class="sxs-lookup"><span data-stu-id="69012-1069">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="69012-1070">Los valores de ruta proporcionados coinciden con los valores predeterminados, y los segmentos correspondientes a los valores predeterminados se omiten sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="69012-1070">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="69012-1071">Ambas direcciones URL generadas realizan un recorrido de ida y vuelta con la definición de ruta siguiente (`/Home/Index` y `/`) y generan los mismos valores de ruta que se usaron para generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1071">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="69012-1072">Las aplicaciones con ASP.NET Core MVC deben usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para generar direcciones URL en lugar de llamar directamente al enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1072">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="69012-1073">Para obtener más información sobre la generación de direcciones URL, vea la sección [Referencia de generación de direcciones URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1073">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="69012-1074">Uso de software intermedio de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-1074">Use Routing Middleware</span></span>

<span data-ttu-id="69012-1075">Haga referencia al [metapaquete Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) en el archivo de proyecto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1075">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="69012-1076">Agregue enrutamiento al contenedor de servicios en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-1076">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="69012-1077">Las rutas se deben configurar en el método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="69012-1077">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="69012-1078">En la aplicación de ejemplo se usan las API siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-1078">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="69012-1079"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: solo coincide con solicitudes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="69012-1079"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="69012-1080">En la tabla siguiente se muestran las respuestas con los URI especificados.</span><span class="sxs-lookup"><span data-stu-id="69012-1080">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="69012-1081">Identificador URI</span><span class="sxs-lookup"><span data-stu-id="69012-1081">URI</span></span>                    | <span data-ttu-id="69012-1082">Respuesta</span><span class="sxs-lookup"><span data-stu-id="69012-1082">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="69012-1083">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1083">Hello!</span></span> <span data-ttu-id="69012-1084">Valores de ruta: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="69012-1084">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="69012-1085">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1085">Hello!</span></span> <span data-ttu-id="69012-1086">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="69012-1086">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="69012-1087">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1087">Hello!</span></span> <span data-ttu-id="69012-1088">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="69012-1088">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="69012-1089">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1089">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="69012-1090">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="69012-1090">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="69012-1091">La solicitud pasa; solo coincide con HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="69012-1091">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="69012-1092">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1092">The request falls through, no match.</span></span>              |

<span data-ttu-id="69012-1093">El marco de trabajo proporciona un conjunto de métodos de extensión para crear rutas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="69012-1093">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="69012-1094">Los métodos `Map[Verb]` usan restricciones para limitar la ruta al verbo HTTP en el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="69012-1094">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="69012-1095">Por ejemplo, vea <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> y <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1095">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="69012-1096">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1096">Route template reference</span></span>

<span data-ttu-id="69012-1097">Los tokens entre llaves (`{ ... }`) definen *parámetros de ruta* que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1097">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="69012-1098">Puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="69012-1098">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="69012-1099">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1099">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="69012-1100">Estos parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="69012-1100">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="69012-1101">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1101">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="69012-1102">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1102">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="69012-1103">Para que el delimitador de parámetro de ruta literal coincida (`{` o `}`), repita el carácter (`{{` o `}}`) para usarlo como secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-1103">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="69012-1104">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="69012-1104">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="69012-1105">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1105">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="69012-1106">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="69012-1106">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="69012-1107">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el punto final (`.`) es opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1107">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="69012-1108">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-1108">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="69012-1109">Se puede usar un asterisco (`*`) o un asterisco doble (`**`) como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="69012-1109">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="69012-1110">Se denominan parámetros *comodín*.</span><span class="sxs-lookup"><span data-stu-id="69012-1110">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="69012-1111">Por ejemplo, `blog/{**slug}` coincide con cualquier URI que empiece por `/blog` y que vaya seguido de cualquier valor, que se asigna al valor de ruta `slug`.</span><span class="sxs-lookup"><span data-stu-id="69012-1111">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="69012-1112">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="69012-1112">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="69012-1113">El parámetro catch-all inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos caracteres de separación de ruta de acceso (`/`).</span><span class="sxs-lookup"><span data-stu-id="69012-1113">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="69012-1114">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="69012-1114">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="69012-1115">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-1115">Note the escaped forward slash.</span></span> <span data-ttu-id="69012-1116">Para los caracteres separadores de ruta de acceso de ida y vuelta, use el prefijo de parámetro de ruta `**`.</span><span class="sxs-lookup"><span data-stu-id="69012-1116">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="69012-1117">La ruta `foo/{**path}` con `{ path = "my/path" }` genera `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="69012-1117">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="69012-1118">Los parámetros de ruta pueden tener *valores predeterminados* designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="69012-1118">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="69012-1119">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="69012-1119">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="69012-1120">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1120">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="69012-1121">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro, como en `id?`.</span><span class="sxs-lookup"><span data-stu-id="69012-1121">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="69012-1122">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es que un parámetro de ruta con un valor predeterminado siempre genera un valor, mientras que un parámetro opcional tiene un valor solo cuando la dirección URL de solicitud lo proporciona.</span><span class="sxs-lookup"><span data-stu-id="69012-1122">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="69012-1123">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1123">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="69012-1124">Si se agrega un carácter de dos puntos (`:`) y un nombre de restricción después del nombre del parámetro de ruta, se especifica una *restricción insertada* en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1124">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="69012-1125">Si la restricción requiere argumentos, se incluyen entre paréntesis (`(...)`) después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1125">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="69012-1126">Se pueden especificar varias restricciones insertadas si se anexa otro carácter de dos puntos (`:`) y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1126">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="69012-1127">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1127">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="69012-1128">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="69012-1128">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="69012-1129">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1129">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="69012-1130">Los parámetros de ruta también pueden tener transformadores de parámetros, que transforman el valor de un parámetro al generar vínculos y acciones y páginas coincidentes para las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1130">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="69012-1131">Al igual que las restricciones, los transformadores de parámetros se pueden agregar en línea a un parámetro de ruta al incorporar un carácter de dos puntos (`:`) y un nombre de transformador después del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1131">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="69012-1132">Por ejemplo, la plantilla de ruta `blog/{article:slugify}` especifica un transformador `slugify`.</span><span class="sxs-lookup"><span data-stu-id="69012-1132">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="69012-1133">Para obtener más información sobre los transformadores de parámetros, vea la sección [Referencia de transformadores de parámetros](#parameter-transformer-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1133">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="69012-1134">En la tabla siguiente se muestran algunas plantillas de ruta de ejemplo y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1134">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="69012-1135">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1135">Route Template</span></span>                           | <span data-ttu-id="69012-1136">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1136">Example Matching URI</span></span>    | <span data-ttu-id="69012-1137">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="69012-1137">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="69012-1138">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="69012-1138">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="69012-1139">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="69012-1139">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="69012-1140">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="69012-1140">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="69012-1141">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="69012-1141">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="69012-1142">Se asigna al controlador `Products` y la acción `Details` (`id` se establece en 123).</span><span class="sxs-lookup"><span data-stu-id="69012-1142">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="69012-1143">Se asigna al controlador `Home` y al método `Index` (`id` se omite).</span><span class="sxs-lookup"><span data-stu-id="69012-1143">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="69012-1144">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="69012-1144">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="69012-1145">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1145">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="69012-1146">Habilite el [registro](xref:fundamentals/logging/index) para ver de qué forma las implementaciones de enrutamiento integradas, como <xref:Microsoft.AspNetCore.Routing.Route>, coinciden con las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-1146">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="69012-1147">Nombres de enrutamientos reservados</span><span class="sxs-lookup"><span data-stu-id="69012-1147">Reserved routing names</span></span>

<span data-ttu-id="69012-1148">Las siguientes palabras clave son nombres reservados y no se pueden usar como nombres de ruta o parámetros:</span><span class="sxs-lookup"><span data-stu-id="69012-1148">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="69012-1149">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1149">Route constraint reference</span></span>

<span data-ttu-id="69012-1150">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1150">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="69012-1151">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="69012-1151">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="69012-1152">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="69012-1152">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="69012-1153">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-1153">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="69012-1154">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-1154">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="69012-1155">No use las restricciones para las **validación de entrada**.</span><span class="sxs-lookup"><span data-stu-id="69012-1155">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="69012-1156">Si las restricciones se usan para la **validación de entrada**, los resultados de entrada no válidos producirán un error *404 - No encontrado* en lugar de un error *400 - Solicitud incorrecta* con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="69012-1156">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="69012-1157">Las restricciones de ruta se usan para **eliminar la ambigüedad** entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="69012-1157">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="69012-1158">En la tabla siguiente se muestran algunas restricciones de ruta de ejemplo y su comportamiento esperado.</span><span class="sxs-lookup"><span data-stu-id="69012-1158">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="69012-1159">Restricción</span><span class="sxs-lookup"><span data-stu-id="69012-1159">Constraint</span></span> | <span data-ttu-id="69012-1160">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1160">Example</span></span> | <span data-ttu-id="69012-1161">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1161">Example matches</span></span> | <span data-ttu-id="69012-1162">Notas</span><span class="sxs-lookup"><span data-stu-id="69012-1162">Notes</span></span> |
|------------|---------|-----------------|-------|
| `int` | `{id:int}` | <span data-ttu-id="69012-1163">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-1163">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-1164">Coincide con cualquier entero.</span><span class="sxs-lookup"><span data-stu-id="69012-1164">Matches any integer.</span></span>|
| `bool` | `{active:bool}` | <span data-ttu-id="69012-1165">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="69012-1165">`true`, `FALSE`</span></span> | <span data-ttu-id="69012-1166">Coincide con `true` o `false`.</span><span class="sxs-lookup"><span data-stu-id="69012-1166">Matches `true` or `false`.</span></span> <span data-ttu-id="69012-1167">No distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="69012-1167">Case-insensitive.</span></span>|
| `datetime` | `{dob:datetime}` | <span data-ttu-id="69012-1168">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="69012-1168">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="69012-1169">Coincide con un valor `DateTime` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1169">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="69012-1170">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1170">See preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="69012-1171">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="69012-1171">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="69012-1172">Coincide con un valor `decimal` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1172">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="69012-1173">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1173">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="69012-1174">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-1174">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-1175">Coincide con un valor `double` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1175">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="69012-1176">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1176">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="69012-1177">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-1177">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-1178">Coincide con un valor `float` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1178">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="69012-1179">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1179">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="69012-1180">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="69012-1180">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="69012-1181">Coincide con un valor `Guid` válido.</span><span class="sxs-lookup"><span data-stu-id="69012-1181">Matches a valid `Guid` value.</span></span>|
| `long` | `{ticks:long}` | <span data-ttu-id="69012-1182">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-1182">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-1183">Coincide con un valor `long` válido.</span><span class="sxs-lookup"><span data-stu-id="69012-1183">Matches a valid `long` value.</span></span>|
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="69012-1184">La cadena debe tener al menos 4 caracteres.</span><span class="sxs-lookup"><span data-stu-id="69012-1184">String must be at least 4 characters.</span></span>|
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="69012-1185">La cadena tiene 8 caracteres como máximo.</span><span class="sxs-lookup"><span data-stu-id="69012-1185">String has maximum of 8 characters.</span></span>|
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="69012-1186">La cadena debe tener una longitud exacta de 12 caracteres.</span><span class="sxs-lookup"><span data-stu-id="69012-1186">String must be exactly 12 characters long.</span></span>|
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="69012-1187">La cadena debe tener al menos 8 caracteres y 16 como máximo.</span><span class="sxs-lookup"><span data-stu-id="69012-1187">String must be at least 8 and has maximum of 16 characters.</span></span>|
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="69012-1188">El valor entero debe ser como mínimo 18.</span><span class="sxs-lookup"><span data-stu-id="69012-1188">Integer value must be at least 18.</span></span>|
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="69012-1189">Valor entero máximo de 120.</span><span class="sxs-lookup"><span data-stu-id="69012-1189">Integer value maximum of 120.</span></span>|
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="69012-1190">El valor entero debe ser como mínimo 18 y máximo 120.</span><span class="sxs-lookup"><span data-stu-id="69012-1190">Integer value must be at least 18 and maximum of 120.</span></span>|
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="69012-1191">La cadena debe constar de uno o más caracteres alfabéticos `a`-`z`.</span><span class="sxs-lookup"><span data-stu-id="69012-1191">String must consist of one or more alphabetical characters `a`-`z`.</span></span> <span data-ttu-id="69012-1192">No distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="69012-1192">Case-insensitive.</span></span>|
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="69012-1193">La cadena debe coincidir con la expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-1193">String must match the regular expression.</span></span> <span data-ttu-id="69012-1194">Vea las sugerencias sobre cómo definir una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-1194">See tips about defining a regular expression.</span></span>|
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="69012-1195">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1195">Used to enforce that a non-parameter value is present during URL generation.</span></span>|

<span data-ttu-id="69012-1196">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1196">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="69012-1197">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="69012-1197">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="69012-1198">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR (como `int` o `DateTime`) usan siempre la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1198">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="69012-1199">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="69012-1199">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="69012-1200">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1200">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="69012-1201">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="69012-1201">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="69012-1202">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="69012-1202">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="69012-1203">Expresiones regulares</span><span class="sxs-lookup"><span data-stu-id="69012-1203">Regular expressions</span></span>

<span data-ttu-id="69012-1204">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1204">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="69012-1205">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="69012-1205">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="69012-1206">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="69012-1206">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="69012-1207">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1207">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="69012-1208">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en el enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="69012-1208">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="69012-1209">La expresión debe tener los caracteres de barra diagonal inversa `\` única proporcionados en la cadena como caracteres de barra diagonal inversa `\\` doble en el código fuente.</span><span class="sxs-lookup"><span data-stu-id="69012-1209">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="69012-1210">La expresión regular debe requerir `\\` para aplicar la secuencia de escape el carácter de escape de cadena `\`.</span><span class="sxs-lookup"><span data-stu-id="69012-1210">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="69012-1211">La expresión regular no requiere `\\` al usar [literales de cadena textual](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="69012-1211">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="69012-1212">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento `{`, `}`, `[` y `]`, duplique los caracteres en la expresión `{{`, `}`, `[[` y `]]`.</span><span class="sxs-lookup"><span data-stu-id="69012-1212">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="69012-1213">En la tabla siguiente se muestra una expresión regular y la versión con la secuencia de escape:</span><span class="sxs-lookup"><span data-stu-id="69012-1213">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="69012-1214">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="69012-1214">Regular Expression</span></span>    | <span data-ttu-id="69012-1215">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="69012-1215">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="69012-1216">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter de acento circunflejo `^` y coinciden con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-1216">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="69012-1217">Las expresiones suelen terminar con el carácter del signo de dólar `$` y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-1217">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="69012-1218">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1218">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="69012-1219">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, algo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="69012-1219">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="69012-1220">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no.</span><span class="sxs-lookup"><span data-stu-id="69012-1220">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="69012-1221">Expresión</span><span class="sxs-lookup"><span data-stu-id="69012-1221">Expression</span></span>   | <span data-ttu-id="69012-1222">String</span><span class="sxs-lookup"><span data-stu-id="69012-1222">String</span></span>    | <span data-ttu-id="69012-1223">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="69012-1223">Match</span></span> | <span data-ttu-id="69012-1224">Comentario</span><span class="sxs-lookup"><span data-stu-id="69012-1224">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="69012-1225">hello</span><span class="sxs-lookup"><span data-stu-id="69012-1225">hello</span></span>     | <span data-ttu-id="69012-1226">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1226">Yes</span></span>   | <span data-ttu-id="69012-1227">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-1227">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-1228">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-1228">123abc456</span></span> | <span data-ttu-id="69012-1229">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1229">Yes</span></span>   | <span data-ttu-id="69012-1230">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-1230">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-1231">mz</span><span class="sxs-lookup"><span data-stu-id="69012-1231">mz</span></span>        | <span data-ttu-id="69012-1232">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1232">Yes</span></span>   | <span data-ttu-id="69012-1233">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="69012-1233">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="69012-1234">MZ</span><span class="sxs-lookup"><span data-stu-id="69012-1234">MZ</span></span>        | <span data-ttu-id="69012-1235">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1235">Yes</span></span>   | <span data-ttu-id="69012-1236">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="69012-1236">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="69012-1237">hello</span><span class="sxs-lookup"><span data-stu-id="69012-1237">hello</span></span>     | <span data-ttu-id="69012-1238">No</span><span class="sxs-lookup"><span data-stu-id="69012-1238">No</span></span>    | <span data-ttu-id="69012-1239">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-1239">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="69012-1240">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-1240">123abc456</span></span> | <span data-ttu-id="69012-1241">No</span><span class="sxs-lookup"><span data-stu-id="69012-1241">No</span></span>    | <span data-ttu-id="69012-1242">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-1242">See `^` and `$` above</span></span> |

<span data-ttu-id="69012-1243">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1243">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="69012-1244">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-1244">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="69012-1245">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="69012-1245">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="69012-1246">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="69012-1246">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="69012-1247">Las restricciones que se pasan al diccionario de restricciones (no insertado en una plantilla) que no coinciden con una de las restricciones conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1247">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="69012-1248">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="69012-1248">Custom route constraints</span></span>

<span data-ttu-id="69012-1249">Además de las restricciones de ruta integradas, se pueden crear restricciones de ruta personalizadas implementando la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="69012-1249">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="69012-1250">La interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contiene un único método, `Match`, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="69012-1250">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="69012-1251">Para utilizar una restricción <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, el tipo de restricción de ruta debe registrarse con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1251">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="69012-1252"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> es un diccionario que asigna claves de restricciones de ruta a implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-1252">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="69012-1253">El parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="69012-1253">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="69012-1254">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="69012-1254">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="69012-1255">La restricción puede aplicarse a las rutas de la manera habitual, usando el nombre especificado al registrar el tipo de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1255">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="69012-1256">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="69012-1256">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="69012-1257">Referencia de transformadores de parámetros</span><span class="sxs-lookup"><span data-stu-id="69012-1257">Parameter transformer reference</span></span>

<span data-ttu-id="69012-1258">Transformadores de parámetros:</span><span class="sxs-lookup"><span data-stu-id="69012-1258">Parameter transformers:</span></span>

* <span data-ttu-id="69012-1259">Se ejecutan al generar un vínculo para <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="69012-1259">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="69012-1260">Implemente `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="69012-1260">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="69012-1261">Se configuran con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="69012-1261">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="69012-1262">Toman el valor de ruta del parámetro y lo transforman en un nuevo valor de cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-1262">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="69012-1263">Como resultado, el valor transformado se usa en el vínculo generado.</span><span class="sxs-lookup"><span data-stu-id="69012-1263">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="69012-1264">Por ejemplo, un transformador de parámetros personalizado `slugify` en el patrón de ruta `blog\{article:slugify}` con `Url.Action(new { article = "MyTestArticle" })` genera `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="69012-1264">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="69012-1265">Para usar un transformador de parámetros en un patrón de ruta, configúrelo primero con <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-1265">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="69012-1266">El marco usa los transformadores de parámetros para transformar el URI en el que se resuelve un punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="69012-1266">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="69012-1267">Por ejemplo, ASP.NET Core MVC usa transformadores de parámetros para transformar el valor de ruta usado para hacer coincidir elementos `area`, `controller`, `action` y `page`.</span><span class="sxs-lookup"><span data-stu-id="69012-1267">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="69012-1268">Con la ruta anterior, la acción `SubscriptionManagementController.GetAll` coincide con el URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="69012-1268">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="69012-1269">Un transformador de parámetros no cambia los valores de ruta usados para generar un vínculo.</span><span class="sxs-lookup"><span data-stu-id="69012-1269">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="69012-1270">Por ejemplo, `Url.Action("GetAll", "SubscriptionManagement")` genera `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="69012-1270">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="69012-1271">ASP.NET Core proporciona las convenciones de API para usar transformadores de parámetros con rutas generadas:</span><span class="sxs-lookup"><span data-stu-id="69012-1271">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="69012-1272">ASP.NET Core MVC tiene la convención de API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`.</span><span class="sxs-lookup"><span data-stu-id="69012-1272">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="69012-1273">Esta convención aplica un transformador de parámetro especificado a todas las rutas de atributo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1273">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="69012-1274">El transformador de parámetro transforma los tokens de rutas de atributo a medida que se reemplazan.</span><span class="sxs-lookup"><span data-stu-id="69012-1274">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="69012-1275">Para más información, consulte [Usar un transformador de parámetro para personalizar el reemplazo de tokens](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="69012-1275">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="69012-1276">`Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` Pages tiene la convención de API Razor.</span><span class="sxs-lookup"><span data-stu-id="69012-1276">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="69012-1277">Esta convención aplica un transformador de parámetros especificado a todas las instancias de Razor Pages detectadas de forma automática.</span><span class="sxs-lookup"><span data-stu-id="69012-1277">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="69012-1278">El transformador de parámetros transforma los segmentos de nombre de archivo y carpeta de las rutas de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-1278">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="69012-1279">Para más información, consulte el artículo sobre cómo [usar un transformador de parámetro para personalizar rutas de Razor Pages](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="69012-1279">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="69012-1280">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="69012-1280">URL generation reference</span></span>

<span data-ttu-id="69012-1281">En el ejemplo siguiente se muestra cómo se genera un vínculo a una ruta, dado un diccionario de valores de ruta y un valor <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="69012-1281">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="69012-1282">El valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generado al final del ejemplo anterior es `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="69012-1282">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="69012-1283">El diccionario proporciona los valores de ruta `operation` e `id` de la plantilla "Ruta de paquete de seguimiento", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1283">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="69012-1284">Para obtener más información, vea el código de ejemplo de la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware) o la [aplicación de ejemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="69012-1284">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="69012-1285">El segundo parámetro del constructor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> es una colección de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="69012-1285">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="69012-1286">Los valores de ambiente son adecuados porque limitan el número de valores que el desarrollador debe especificar dentro de un contexto de solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1286">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="69012-1287">Los valores de ruta actuales de la solicitud actual se consideran valores de ambiente para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-1287">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="69012-1288">En la acción `About` de `HomeController` de una aplicación ASP.NET Core MVC, no es necesario especificar el valor de ruta de controlador para vincular a la acción `Index` (se usará el valor de ambiente `Home`).</span><span class="sxs-lookup"><span data-stu-id="69012-1288">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="69012-1289">Los valores de ambiente que no coincidan con un parámetro se omiten.</span><span class="sxs-lookup"><span data-stu-id="69012-1289">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="69012-1290">También se omiten los valores de ambiente cuando un valor proporcionado de forma explícita invalida el valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="69012-1290">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="69012-1291">La coincidencia se produce de izquierda a derecha en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1291">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="69012-1292">Los valores que se proporcionan de forma explícita pero que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="69012-1292">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="69012-1293">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1293">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="69012-1294">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="69012-1294">Ambient Values</span></span>                     | <span data-ttu-id="69012-1295">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="69012-1295">Explicit Values</span></span>                        | <span data-ttu-id="69012-1296">Resultado</span><span class="sxs-lookup"><span data-stu-id="69012-1296">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="69012-1297">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1297">controller = "Home"</span></span>                | <span data-ttu-id="69012-1298">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1298">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-1299">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1299">controller = "Home"</span></span>                | <span data-ttu-id="69012-1300">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1300">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="69012-1301">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-1301">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="69012-1302">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1302">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-1303">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1303">controller = "Home"</span></span>                | <span data-ttu-id="69012-1304">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-1304">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="69012-1305">Si una ruta tiene un valor predeterminado que no se corresponde con un parámetro y ese valor se proporciona de forma explícita, debe coincidir con el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="69012-1305">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="69012-1306">La generación de vínculos solo genera un vínculo para esta ruta si se proporcionan los valores coincidentes para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="69012-1306">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="69012-1307">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="69012-1307">Complex segments</span></span>

<span data-ttu-id="69012-1308">Los segmentos complejos (por ejemplo, `[Route("/x{token}y")]`), se procesan buscando coincidencias de literales de derecha a izquierda de un modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="69012-1308">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="69012-1309">Consulte [este código](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para obtener una explicación detallada de cómo se comparan los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="69012-1309">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="69012-1310">El [código de ejemplo](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) no se usa en ASP.NET Core, pero proporciona una buena explicación de los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="69012-1310">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="69012-1311">El enrutamiento es responsable de asignar los URI de solicitud a los controladores de ruta y de distribuir las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="69012-1311">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="69012-1312">Las rutas se definen en la aplicación y se configuran cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1312">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="69012-1313">Una ruta puede extraer opcionalmente valores de la dirección URL contenida en la solicitud, que se pueden usar para procesar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-1313">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="69012-1314">Mediante las rutas configuradas de la aplicación, el enrutamiento puede generar direcciones URL que se asignan a los controladores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1314">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="69012-1315">Para usar los escenarios de enrutamiento más recientes de ASP.NET Core 2.1, especifique la [versión de compatibilidad](xref:mvc/compatibility-version) en el registro de servicios de MVC en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-1315">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="69012-1316">En este documento se describe el enrutamiento de ASP.NET Core de bajo nivel.</span><span class="sxs-lookup"><span data-stu-id="69012-1316">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="69012-1317">Para obtener información sobre el enrutamiento de ASP.NET Core MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="69012-1317">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="69012-1318">Para obtener más información sobre las convenciones de enrutamiento en Razor Pages, consulte <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="69012-1318">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="69012-1319">[Vea o descargue el código de ejemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([cómo descargarlo](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="69012-1319">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="69012-1320">Fundamentos del enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-1320">Routing basics</span></span>

<span data-ttu-id="69012-1321">La mayoría de las aplicaciones deben elegir un esquema de enrutamiento básico y descriptivo para que las direcciones URL sean legibles y significativas.</span><span class="sxs-lookup"><span data-stu-id="69012-1321">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="69012-1322">La ruta convencional predeterminada `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="69012-1322">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="69012-1323">Admite un esquema de enrutamiento básico y descriptivo.</span><span class="sxs-lookup"><span data-stu-id="69012-1323">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="69012-1324">Se trata de un punto de partida útil para las aplicaciones basadas en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="69012-1324">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="69012-1325">Los desarrolladores suelen agregar rutas breves adicionales a áreas de mucho tráfico de una aplicación en situaciones especializadas (por ejemplo, puntos de conexión de blog y comercio electrónico) con el [enrutamiento mediante atributos](xref:mvc/controllers/routing#attribute-routing) o rutas convencionales dedicadas.</span><span class="sxs-lookup"><span data-stu-id="69012-1325">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="69012-1326">Las API web deben usar el enrutamiento mediante atributos para modelar la funcionalidad de la aplicación como un conjunto de recursos donde las operaciones se representan mediante verbos HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-1326">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="69012-1327">Esto significa que muchas operaciones (por ejemplo, GET y POST) del mismo recurso lógico usarán la misma dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1327">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="69012-1328">El enrutamiento mediante atributos proporciona un nivel de control que es necesario para diseñar cuidadosamente un diseño de puntos de conexión públicos de la API.</span><span class="sxs-lookup"><span data-stu-id="69012-1328">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="69012-1329">En las aplicaciones de Razor Pages se usa el enrutamiento convencional predeterminado para proporcionar recursos con nombre en la carpeta *Páginas* de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1329">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="69012-1330">Existen convenciones adicionales que permiten personalizar el comportamiento de enrutamiento de Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-1330">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="69012-1331">Para obtener más información, vea <xref:razor-pages/index> y <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="69012-1331">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="69012-1332">La compatibilidad de la generación de direcciones URL permite desarrollar la aplicación sin codificar de forma rígida las direcciones URL para vincular la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1332">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="69012-1333">Esta compatibilidad permite empezar con una configuración de enrutamiento básica y modificar las rutas una vez determinado el diseño de los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1333">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="69012-1334">El enrutamiento usa implementaciones de ruta de <xref:Microsoft.AspNetCore.Routing.IRouter> para:</span><span class="sxs-lookup"><span data-stu-id="69012-1334">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="69012-1335">Asignar las solicitudes entrantes a *controladores de ruta*.</span><span class="sxs-lookup"><span data-stu-id="69012-1335">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="69012-1336">Generar las direcciones URL que se usan en las respuestas.</span><span class="sxs-lookup"><span data-stu-id="69012-1336">Generate the URLs used in responses.</span></span>

<span data-ttu-id="69012-1337">De forma predeterminada, una aplicación tiene una sola colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-1337">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="69012-1338">Cuando llega una solicitud, las rutas de la colección se procesan en el orden en el que se encuentran en la colección.</span><span class="sxs-lookup"><span data-stu-id="69012-1338">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="69012-1339">El marco de trabajo intenta hacer coincidir una dirección URL de solicitud entrante con una ruta de la colección mediante una llamada al método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> en cada ruta de la colección.</span><span class="sxs-lookup"><span data-stu-id="69012-1339">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="69012-1340">Una respuesta puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información de ruta. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1340">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="69012-1341">El sistema de enrutamiento tiene las características siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-1341">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="69012-1342">La sintaxis de plantilla de ruta se usa para definir las rutas con parámetros de ruta con tokens.</span><span class="sxs-lookup"><span data-stu-id="69012-1342">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="69012-1343">Se permite la configuración de puntos de conexión de estilo convencional y de estilo de atributo.</span><span class="sxs-lookup"><span data-stu-id="69012-1343">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="69012-1344">Se usa <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para determinar si un parámetro de dirección URL contiene un valor válido para una restricción de punto de conexión determinada.</span><span class="sxs-lookup"><span data-stu-id="69012-1344"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="69012-1345">Los modelos de aplicación, como MVC y Razor Pages, registran todas sus rutas, que tienen una implementación predecible de los escenarios de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1345">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="69012-1346">Una respuesta puede usar el enrutamiento para generar direcciones URL (por ejemplo, para el redireccionamiento o los vínculos) en función de la información de ruta. De este modo, se evita codificar de forma rígida las direcciones URL, lo que facilita el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1346">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="69012-1347">La generación de direcciones URL se basa en rutas, que admiten la extensibilidad arbitraria.</span><span class="sxs-lookup"><span data-stu-id="69012-1347">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="69012-1348"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> ofrece métodos para generar direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1348"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="69012-1349">La clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> conecta el enrutamiento a la canalización de [software intermedio](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="69012-1349">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="69012-1350">[ASP.NET Core MVC](xref:mvc/overview) agrega enrutamiento a la canalización de middleware como parte de su configuración y controla el enrutamiento en las aplicaciones de MVC y Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="69012-1350">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="69012-1351">Para obtener información sobre cómo usar el enrutamiento como componente independiente, vea la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="69012-1351">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="69012-1352">Coincidencia de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-1352">URL matching</span></span>

<span data-ttu-id="69012-1353">La coincidencia de dirección URL es el proceso por el cual el enrutamiento envía una solicitud entrante a un *controlador*.</span><span class="sxs-lookup"><span data-stu-id="69012-1353">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="69012-1354">Este proceso se basa en datos de la ruta de dirección URL, pero se puede ampliar para tener en cuenta cualquier dato de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1354">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="69012-1355">La capacidad de enviar solicitudes a controladores independientes es clave para escalar el tamaño y la complejidad de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1355">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="69012-1356">Las solicitudes entrantes especifican la clase <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, que llama al método <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> en cada ruta de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1356">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="69012-1357">La instancia de <xref:Microsoft.AspNetCore.Routing.IRouter> decide si *controla* la solicitud mediante el establecimiento de [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) en un <xref:Microsoft.AspNetCore.Http.RequestDelegate> que no sea NULL.</span><span class="sxs-lookup"><span data-stu-id="69012-1357">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="69012-1358">Si una ruta establece un controlador para la solicitud, el procesamiento de rutas se detiene y se invoca el controlador para procesar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1358">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="69012-1359">Si no se encuentra ningún controlador de ruta para procesar la solicitud, el middleware entrega la solicitud al siguiente middleware en la canalización de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-1359">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="69012-1360">La entrada principal para <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> es el [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) asociado a la solicitud actual.</span><span class="sxs-lookup"><span data-stu-id="69012-1360">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="69012-1361">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) y [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) son salidas que se establecen después de que una ruta coincida.</span><span class="sxs-lookup"><span data-stu-id="69012-1361">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="69012-1362">Una coincidencia que llama a <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> también establece las propiedades de [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) en los valores adecuados en función del procesamiento de solicitudes realizado hasta el momento.</span><span class="sxs-lookup"><span data-stu-id="69012-1362">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="69012-1363">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) es un diccionario de los *valores de ruta* generados desde la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1363">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="69012-1364">Estos valores se suelen determinar mediante la conversión en tokens de la dirección URL, y se pueden usar para aceptar la entrada del usuario o para tomar otras decisiones sobre el envío dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1364">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="69012-1365">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) es un contenedor de propiedades de datos adicionales relacionados con la ruta coincidente.</span><span class="sxs-lookup"><span data-stu-id="69012-1365">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="69012-1366">Se proporcionan <xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> para permitir la asociación de datos de estado con cada ruta, de modo que la aplicación pueda tomar decisiones en función de las rutas que han coincidido.</span><span class="sxs-lookup"><span data-stu-id="69012-1366"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="69012-1367">Estos valores los define el desarrollador y **no** afectan de ninguna manera al comportamiento del enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1367">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="69012-1368">Además, los valores que se guardan provisionalmente en [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) pueden ser de cualquier tipo, a diferencia de [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), que deben poder convertirse fácilmente en cadenas y a partir de estas.</span><span class="sxs-lookup"><span data-stu-id="69012-1368">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="69012-1369">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) es una lista de las rutas que han participado en encontrar una coincidencia correcta con la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1369">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="69012-1370">Las rutas se pueden anidar unas dentro de otras.</span><span class="sxs-lookup"><span data-stu-id="69012-1370">Routes can be nested inside of one another.</span></span> <span data-ttu-id="69012-1371">La propiedad <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> refleja la ruta de acceso del árbol lógico de rutas que han tenido como resultado una coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1371">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="69012-1372">Por lo general, el primer elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es la colección de rutas y se debe usar para la generación de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1372">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="69012-1373">El último elemento de <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> es el controlador de ruta que ha coincidido.</span><span class="sxs-lookup"><span data-stu-id="69012-1373">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="69012-1374">Generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-1374">URL generation</span></span>

<span data-ttu-id="69012-1375">La generación de dirección URL es el proceso por el cual el enrutamiento puede crear una ruta de dirección URL basada en un conjunto de valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1375">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="69012-1376">Esto permite una separación lógica entre los controladores de ruta y las direcciones URL que tienen acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="69012-1376">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="69012-1377">La generación de direcciones URL sigue un proceso iterativo similar, pero se inicia cuando el código de usuario o de marco de trabajo llama al método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-1377">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="69012-1378">Se llama en secuencia al método <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de cada *ruta* hasta que se devuelva un valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData> distinto de NULL.</span><span class="sxs-lookup"><span data-stu-id="69012-1378">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="69012-1379">La principal entradas de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> son:</span><span class="sxs-lookup"><span data-stu-id="69012-1379">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="69012-1380">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="69012-1380">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="69012-1381">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="69012-1381">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="69012-1382">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="69012-1382">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="69012-1383">Las rutas usan principalmente los valores de ruta proporcionados por <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> y <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> para decidir si es posible generar una dirección URL y qué valores se van a incluir.</span><span class="sxs-lookup"><span data-stu-id="69012-1383">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="69012-1384"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> son el conjunto de valores de ruta producidos a partir de la coincidencia con la solicitud actual.</span><span class="sxs-lookup"><span data-stu-id="69012-1384">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="69012-1385">En cambio, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> son los valores de ruta que especifican cómo se genera la dirección URL deseada para la operación actual.</span><span class="sxs-lookup"><span data-stu-id="69012-1385">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="69012-1386">Se proporciona <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> por si una ruta debe obtener servicios o datos adicionales asociados con el contexto actual.</span><span class="sxs-lookup"><span data-stu-id="69012-1386">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="69012-1387">Piense en [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) como un conjunto de invalidaciones para [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="69012-1387">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="69012-1388">La generación de direcciones URL intenta reutilizar los valores de ruta de la solicitud actual para generar direcciones URL para los vínculos con la misma ruta o valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1388">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="69012-1389">La salida de <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> es <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="69012-1389">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="69012-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> es un valor paralelo de <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="69012-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="69012-1391"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contiene el valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> de la dirección URL de salida y algunas propiedades más que la ruta debe establecer.</span><span class="sxs-lookup"><span data-stu-id="69012-1391"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="69012-1392">La propiedad [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) contiene la *ruta de acceso virtual* generada por la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1392">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="69012-1393">Es posible que deba procesar aún más la ruta de acceso, según sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="69012-1393">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="69012-1394">Si quiere representar la dirección URL generada en HTML, anteponga la ruta de acceso base de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1394">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="69012-1395">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) es una referencia a la ruta que ha generado correctamente la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1395">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="69012-1396">La propiedad [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) es un diccionario de datos adicionales relacionados con la ruta que ha generado la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1396">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="69012-1397">Se trata del valor paralelo de [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="69012-1397">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="69012-1398">Creación de rutas</span><span class="sxs-lookup"><span data-stu-id="69012-1398">Create routes</span></span>

<span data-ttu-id="69012-1399">El enrutamiento proporciona la clase <xref:Microsoft.AspNetCore.Routing.Route> como implementación estándar de <xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="69012-1399">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="69012-1400"><xref:Microsoft.AspNetCore.Routing.Route> usa la sintaxis de *plantilla de ruta* para definir patrones que se hacen coincidir con la ruta de dirección URL cuando se llama a <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1400"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="69012-1401"><xref:Microsoft.AspNetCore.Routing.Route> usa la misma plantilla de ruta para generar una dirección URL cuando se llama a <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1401"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="69012-1402">La mayoría de las aplicaciones crea rutas mediante una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> o a uno de los métodos de extensión similares definidos en <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-1402">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="69012-1403">Todos los métodos de extensión <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> crean una instancia de <xref:Microsoft.AspNetCore.Routing.Route> y la agregan a la colección de rutas.</span><span class="sxs-lookup"><span data-stu-id="69012-1403">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="69012-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> no acepta un parámetro de controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="69012-1405"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> solo agrega las rutas que se controlan mediante <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1405"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="69012-1406">El controlador predeterminado es un elemento `IRouter`, y es posible que el controlador no pueda atender la solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1406">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="69012-1407">Por ejemplo, ASP.NET Core MVC se suele configurar como un controlador predeterminado que solo controla las solicitudes que coinciden con un controlador y una acción disponibles.</span><span class="sxs-lookup"><span data-stu-id="69012-1407">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="69012-1408">Para obtener más información sobre el enrutamiento en MVC, vea <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="69012-1408">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="69012-1409">El código siguiente es un ejemplo de una llamada a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> usada por una definición de ruta típica de ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="69012-1409">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="69012-1410">Esta plantilla coincide con una ruta de dirección URL y extrae los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1410">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="69012-1411">Por ejemplo, la ruta de acceso `/Products/Details/17` genera los valores de ruta siguientes: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1411">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="69012-1412">Los valores de ruta se determinan al dividir la ruta de dirección URL en segmentos y hacer coincidir cada segmento con el nombre del *parámetro de ruta* en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1412">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="69012-1413">Los parámetros de ruta tienen un nombre asignado.</span><span class="sxs-lookup"><span data-stu-id="69012-1413">Route parameters are named.</span></span> <span data-ttu-id="69012-1414">Para definir los parámetros, el nombre del parámetro se incluye entre llaves `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1414">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="69012-1415">La plantilla anterior también podría coincidir con la ruta de dirección URL `/` y generar los valores `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1415">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="69012-1416">Esto se debe a que los parámetros de ruta `{controller}` y `{action}` tienen valores predeterminados y el parámetro de ruta `id` es opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1416">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="69012-1417">Un signo igual (`=`) seguido de un valor después del nombre del parámetro de ruta define un valor predeterminado para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1417">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="69012-1418">Un signo de interrogación (`?`) después del nombre del parámetro de ruta define un parámetro opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1418">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="69012-1419">Los parámetros de ruta con un valor predeterminado *siempre* generan un valor de ruta cuando la ruta coincide.</span><span class="sxs-lookup"><span data-stu-id="69012-1419">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="69012-1420">Los parámetros opcionales no generan un valor de ruta si no existe el segmento de ruta de dirección URL correspondiente.</span><span class="sxs-lookup"><span data-stu-id="69012-1420">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="69012-1421">Vea la sección [Referencia de plantilla de ruta](#route-template-reference) para obtener una descripción detallada de los escenarios y la sintaxis de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1421">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="69012-1422">En el ejemplo siguiente, la definición de parámetro de ruta `{id:int}` define una [restricción de ruta](#route-constraint-reference) para el parámetro de ruta `id`:</span><span class="sxs-lookup"><span data-stu-id="69012-1422">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="69012-1423">Esta plantilla coincide con una ruta de dirección URL como `/Products/Details/17`, pero no con `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="69012-1423">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="69012-1424">Las restricciones de ruta implementan <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> e inspeccionan los valores de ruta para comprobarlos.</span><span class="sxs-lookup"><span data-stu-id="69012-1424">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="69012-1425">En este ejemplo, el valor de ruta `id` debe poder convertirse en un entero.</span><span class="sxs-lookup"><span data-stu-id="69012-1425">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="69012-1426">Vea la [Referencia de restricción de ruta](#route-constraint-reference) para obtener una explicación de las restricciones de ruta proporcionadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="69012-1426">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="69012-1427">Las sobrecargas adicionales de <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> aceptan valores para `constraints`, `dataTokens` y `defaults`.</span><span class="sxs-lookup"><span data-stu-id="69012-1427">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="69012-1428">Estos parámetros suelen usarse para pasar un objeto de tipo anónimo, donde los nombres de propiedad del tipo anónimo coinciden con los nombres de los parámetros de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1428">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="69012-1429">En los ejemplos <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> siguientes se crean rutas equivalentes:</span><span class="sxs-lookup"><span data-stu-id="69012-1429">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="69012-1430">La sintaxis insertada para definir las restricciones y los valores predeterminados puede ser conveniente para las rutas simples.</span><span class="sxs-lookup"><span data-stu-id="69012-1430">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="69012-1431">Pero hay algunos escenarios, como los tokens de datos, que no son compatibles con la sintaxis insertada.</span><span class="sxs-lookup"><span data-stu-id="69012-1431">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="69012-1432">En el ejemplo siguiente se muestran algunos escenarios más:</span><span class="sxs-lookup"><span data-stu-id="69012-1432">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="69012-1433">La plantilla anterior coincide con una ruta de dirección URL como `/Blog/All-About-Routing/Introduction` y extrae los valores `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1433">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="69012-1434">La ruta genera los valores de ruta predeterminados para `controller` y `action`, incluso si no hay parámetros de ruta correspondientes en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="69012-1434">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="69012-1435">Los valores predeterminados pueden especificarse en la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1435">Default values can be specified in the route template.</span></span> <span data-ttu-id="69012-1436">El parámetro de ruta `article` se define como un *comodín* por la aparición de un asterisco (`*`) antes del nombre del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1436">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="69012-1437">Los parámetros de ruta comodín capturan el resto de la ruta de dirección URL y también pueden coincidir con la cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="69012-1437">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="69012-1438">En el ejemplo siguiente se agregan restricciones de ruta y tokens de datos:</span><span class="sxs-lookup"><span data-stu-id="69012-1438">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="69012-1439">La plantilla anterior coincide con una ruta de dirección URL como `/en-US/Products/5` y extrae los valores `{ controller = Products, action = Details, id = 5 }` y los tokens de datos `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="69012-1439">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokens de Windows de variables locales](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="69012-1441">Generación de direcciones URL de clase de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1441">Route class URL generation</span></span>

<span data-ttu-id="69012-1442">La clase <xref:Microsoft.AspNetCore.Routing.Route> también puede llevar a cabo la generación de dirección URL mediante la combinación de un conjunto de valores de ruta con su plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1442">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="69012-1443">Se trata lógicamente del proceso inverso de hacer coincidir la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1443">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="69012-1444">Para entender mejor la generación de direcciones URL, imagine qué dirección URL quiere generar y, después, piense cómo coincidiría una plantilla de ruta con esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1444">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="69012-1445">¿Qué valores se generarían?</span><span class="sxs-lookup"><span data-stu-id="69012-1445">What values would be produced?</span></span> <span data-ttu-id="69012-1446">Este es un equivalente aproximado de cómo funciona la generación de dirección URL en la clase <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="69012-1446">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="69012-1447">En el ejemplo siguiente se usa una ruta predeterminada de ASP.NET Core MVC general:</span><span class="sxs-lookup"><span data-stu-id="69012-1447">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="69012-1448">Con los valores de ruta `{ controller = Products, action = List }`, se genera la dirección URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="69012-1448">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="69012-1449">Los valores de ruta se sustituyen por los parámetros de ruta correspondientes para formar la ruta de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1449">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="69012-1450">Como `id` es un parámetro de ruta opcional, la dirección URL se ha generado correctamente sin ningún valor para `id`.</span><span class="sxs-lookup"><span data-stu-id="69012-1450">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="69012-1451">Con los valores de ruta `{ controller = Home, action = Index }`, se genera la dirección URL `/`.</span><span class="sxs-lookup"><span data-stu-id="69012-1451">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="69012-1452">Los valores de ruta proporcionados coinciden con los valores predeterminados, y los segmentos correspondientes a los valores predeterminados se omiten sin ningún riesgo.</span><span class="sxs-lookup"><span data-stu-id="69012-1452">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="69012-1453">Ambas direcciones URL generadas realizan un recorrido de ida y vuelta con la definición de ruta siguiente (`/Home/Index` y `/`) y generan los mismos valores de ruta que se usaron para generar la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1453">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="69012-1454">Las aplicaciones con ASP.NET Core MVC deben usar <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> para generar direcciones URL en lugar de llamar directamente al enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1454">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="69012-1455">Para obtener más información sobre la generación de direcciones URL, vea la sección [Referencia de generación de direcciones URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1455">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="69012-1456">Uso de middleware de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="69012-1456">Use routing middleware</span></span>

<span data-ttu-id="69012-1457">Haga referencia al [metapaquete Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) en el archivo de proyecto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1457">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="69012-1458">Agregue enrutamiento al contenedor de servicios en `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="69012-1458">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="69012-1459">Las rutas se deben configurar en el método `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="69012-1459">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="69012-1460">En la aplicación de ejemplo se usan las API siguientes:</span><span class="sxs-lookup"><span data-stu-id="69012-1460">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="69012-1461"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: solo coincide con solicitudes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="69012-1461"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="69012-1462">En la tabla siguiente se muestran las respuestas con los URI especificados.</span><span class="sxs-lookup"><span data-stu-id="69012-1462">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="69012-1463">Identificador URI</span><span class="sxs-lookup"><span data-stu-id="69012-1463">URI</span></span>                    | <span data-ttu-id="69012-1464">Respuesta</span><span class="sxs-lookup"><span data-stu-id="69012-1464">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="69012-1465">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1465">Hello!</span></span> <span data-ttu-id="69012-1466">Valores de ruta: [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="69012-1466">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="69012-1467">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1467">Hello!</span></span> <span data-ttu-id="69012-1468">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="69012-1468">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="69012-1469">Hello!</span><span class="sxs-lookup"><span data-stu-id="69012-1469">Hello!</span></span> <span data-ttu-id="69012-1470">Valores de ruta: [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="69012-1470">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="69012-1471">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1471">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="69012-1472">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="69012-1472">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="69012-1473">La solicitud pasa; solo coincide con HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="69012-1473">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="69012-1474">La solicitud pasa; no hay ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="69012-1474">The request falls through, no match.</span></span>              |

<span data-ttu-id="69012-1475">Si va a configurar una única ruta, pase una instancia de `IRouter` para llamar a <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1475">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="69012-1476">No tendrá que usar <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="69012-1476">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="69012-1477">El marco de trabajo proporciona un conjunto de métodos de extensión para crear rutas (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="69012-1477">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="69012-1478">Algunos de los métodos enumerados, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, requieren un <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="69012-1478">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="69012-1479">El valor <xref:Microsoft.AspNetCore.Http.RequestDelegate> se usa como *controlador de ruta* cuando la ruta coincida.</span><span class="sxs-lookup"><span data-stu-id="69012-1479">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="69012-1480">Otros métodos de esta familia permiten configurar una canalización de software intermedio para usarla como controlador de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1480">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="69012-1481">Si el método `Map*` no acepta un controlador, como <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, usa <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1481">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="69012-1482">Los métodos `Map[Verb]` usan restricciones para limitar la ruta al verbo HTTP en el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="69012-1482">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="69012-1483">Por ejemplo, vea <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> y <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="69012-1483">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="69012-1484">Referencia de plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1484">Route template reference</span></span>

<span data-ttu-id="69012-1485">Los tokens entre llaves (`{ ... }`) definen *parámetros de ruta* que se enlazan si se encuentran coincidencias con la ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1485">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="69012-1486">Puede definir más de un parámetro de ruta en un segmento de ruta, pero deben estar separados por un valor literal.</span><span class="sxs-lookup"><span data-stu-id="69012-1486">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="69012-1487">Por ejemplo, `{controller=Home}{action=Index}` no es una ruta válida, ya que no hay ningún valor literal entre `{controller}` y `{action}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1487">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="69012-1488">Estos parámetros de ruta deben tener un nombre y, opcionalmente, atributos adicionales especificados.</span><span class="sxs-lookup"><span data-stu-id="69012-1488">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="69012-1489">El texto literal diferente de los parámetros de ruta (por ejemplo, `{id}`) y el separador de ruta `/` deben coincidir con el texto de la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1489">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="69012-1490">La coincidencia de texto no distingue mayúsculas de minúsculas y se basa en la representación descodificada de la ruta de las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1490">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="69012-1491">Para que el delimitador de parámetro de ruta literal coincida (`{` o `}`), repita el carácter (`{{` o `}}`) para usarlo como secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-1491">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="69012-1492">Los patrones de dirección URL que intentan capturar un nombre de archivo con una extensión de archivo opcional tienen consideraciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="69012-1492">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="69012-1493">Por ejemplo, considere la plantilla `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1493">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="69012-1494">Cuando existen valores para `filename` y `ext`, los dos valores se rellenan.</span><span class="sxs-lookup"><span data-stu-id="69012-1494">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="69012-1495">Si solo existe un valor para `filename` en la dirección URL, la ruta coincide porque el punto final (`.`) es opcional.</span><span class="sxs-lookup"><span data-stu-id="69012-1495">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="69012-1496">Las direcciones URL siguientes coinciden con esta ruta:</span><span class="sxs-lookup"><span data-stu-id="69012-1496">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="69012-1497">Se puede usar el asterisco (`*`) como prefijo de un parámetro de ruta para enlazar con el resto del URI.</span><span class="sxs-lookup"><span data-stu-id="69012-1497">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="69012-1498">Es lo que se denomina un parámetro *comodín*.</span><span class="sxs-lookup"><span data-stu-id="69012-1498">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="69012-1499">Por ejemplo, `blog/{*slug}` coincide con cualquier URI que empiece por `/blog` y que vaya seguido de cualquier valor, que se asigna al valor de ruta `slug`.</span><span class="sxs-lookup"><span data-stu-id="69012-1499">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="69012-1500">Los parámetros comodín también pueden coincidir con una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="69012-1500">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="69012-1501">El parámetro catch-all inserta los caracteres de escape correspondientes cuando se usa la ruta para generar una dirección URL, incluidos caracteres de separación de ruta de acceso (`/`).</span><span class="sxs-lookup"><span data-stu-id="69012-1501">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="69012-1502">Por ejemplo, la ruta `foo/{*path}` con valores de ruta `{ path = "my/path" }` genera `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="69012-1502">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="69012-1503">Tenga en cuenta la barra diagonal de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-1503">Note the escaped forward slash.</span></span>

<span data-ttu-id="69012-1504">Los parámetros de ruta pueden tener *valores predeterminados* designados mediante la especificación del valor predeterminado después del nombre de parámetro, separado por un signo igual (`=`).</span><span class="sxs-lookup"><span data-stu-id="69012-1504">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="69012-1505">Por ejemplo, `{controller=Home}` define `Home` como el valor predeterminado de `controller`.</span><span class="sxs-lookup"><span data-stu-id="69012-1505">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="69012-1506">El valor predeterminado se usa si no hay ningún valor en la dirección URL para el parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1506">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="69012-1507">Los parámetros de ruta se pueden convertir en opcionales si se anexa un signo de interrogación (`?`) al final del nombre del parámetro, como en `id?`.</span><span class="sxs-lookup"><span data-stu-id="69012-1507">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="69012-1508">La diferencia entre los valores opcionales y los parámetros de ruta predeterminados es que un parámetro de ruta con un valor predeterminado siempre genera un valor, mientras que un parámetro opcional tiene un valor solo cuando la dirección URL de solicitud lo proporciona.</span><span class="sxs-lookup"><span data-stu-id="69012-1508">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="69012-1509">Los parámetros de ruta pueden tener restricciones que deben coincidir con el valor de ruta enlazado desde la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1509">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="69012-1510">Si se agrega un carácter de dos puntos (`:`) y un nombre de restricción después del nombre del parámetro de ruta, se especifica una *restricción insertada* en un parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1510">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="69012-1511">Si la restricción requiere argumentos, se incluyen entre paréntesis (`(...)`) después del nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1511">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="69012-1512">Se pueden especificar varias restricciones insertadas si se anexa otro carácter de dos puntos (`:`) y un nombre de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1512">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="69012-1513">El nombre de restricción y los argumentos se pasan al servicio <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> para crear una instancia de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> para su uso en el procesamiento de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1513">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="69012-1514">Por ejemplo, la plantilla de ruta `blog/{article:minlength(10)}` especifica una restricción `minlength` con el argumento `10`.</span><span class="sxs-lookup"><span data-stu-id="69012-1514">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="69012-1515">Para obtener más información sobre las restricciones de ruta y una lista de las restricciones proporcionadas por el marco de trabajo, vea la sección [Referencia de restricciones de ruta](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1515">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="69012-1516">En la tabla siguiente se muestran algunas plantillas de ruta de ejemplo y su comportamiento.</span><span class="sxs-lookup"><span data-stu-id="69012-1516">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="69012-1517">Plantilla de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1517">Route Template</span></span>                           | <span data-ttu-id="69012-1518">URI coincidente de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1518">Example Matching URI</span></span>    | <span data-ttu-id="69012-1519">El URI de la solicitud&hellip;</span><span class="sxs-lookup"><span data-stu-id="69012-1519">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="69012-1520">Solo coincide con la ruta de acceso única `/hello`.</span><span class="sxs-lookup"><span data-stu-id="69012-1520">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="69012-1521">Coincide y establece `Page` en `Home`.</span><span class="sxs-lookup"><span data-stu-id="69012-1521">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="69012-1522">Coincide y establece `Page` en `Contact`.</span><span class="sxs-lookup"><span data-stu-id="69012-1522">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="69012-1523">Se asigna al controlador `Products` y la acción `List`.</span><span class="sxs-lookup"><span data-stu-id="69012-1523">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="69012-1524">Se asigna al controlador `Products` y la acción `Details` (`id` se establece en 123).</span><span class="sxs-lookup"><span data-stu-id="69012-1524">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="69012-1525">Se asigna al controlador `Home` y al método `Index` (`id` se omite).</span><span class="sxs-lookup"><span data-stu-id="69012-1525">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="69012-1526">El uso de una plantilla suele ser el método de enrutamiento más sencillo.</span><span class="sxs-lookup"><span data-stu-id="69012-1526">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="69012-1527">Las restricciones y los valores predeterminados también se pueden especificar fuera de la plantilla de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1527">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="69012-1528">Habilite el [registro](xref:fundamentals/logging/index) para ver de qué forma las implementaciones de enrutamiento integradas, como <xref:Microsoft.AspNetCore.Routing.Route>, coinciden con las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="69012-1528">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="69012-1529">Referencia de restricción de ruta</span><span class="sxs-lookup"><span data-stu-id="69012-1529">Route constraint reference</span></span>

<span data-ttu-id="69012-1530">Las restricciones de ruta se ejecutan cuando se ha producido una coincidencia con la dirección URL entrante y la ruta de dirección URL se convierte en tokens en valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1530">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="69012-1531">En general, las restricciones de ruta inspeccionan el valor de ruta asociado a través de la plantilla de ruta y deciden si el valor es aceptable o no.</span><span class="sxs-lookup"><span data-stu-id="69012-1531">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="69012-1532">Algunas restricciones de ruta usan datos ajenos al valor de ruta para decidir si la solicitud se puede enrutar.</span><span class="sxs-lookup"><span data-stu-id="69012-1532">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="69012-1533">Por ejemplo, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> puede aceptar o rechazar una solicitud basada en su verbo HTTP.</span><span class="sxs-lookup"><span data-stu-id="69012-1533">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="69012-1534">Las restricciones se usan en las solicitudes de enrutamiento y la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-1534">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="69012-1535">No use las restricciones para las **validación de entrada**.</span><span class="sxs-lookup"><span data-stu-id="69012-1535">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="69012-1536">Si las restricciones se usan para la **validación de entrada**, los resultados de entrada no válidos producirán un error *404 - No encontrado* en lugar de un error *400 - Solicitud incorrecta* con un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="69012-1536">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="69012-1537">Las restricciones de ruta se usan para **eliminar la ambigüedad** entre rutas similares, no para validar las entradas de una ruta determinada.</span><span class="sxs-lookup"><span data-stu-id="69012-1537">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="69012-1538">En la tabla siguiente se muestran algunas restricciones de ruta de ejemplo y su comportamiento esperado.</span><span class="sxs-lookup"><span data-stu-id="69012-1538">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="69012-1539">restricción</span><span class="sxs-lookup"><span data-stu-id="69012-1539">constraint</span></span> | <span data-ttu-id="69012-1540">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1540">Example</span></span> | <span data-ttu-id="69012-1541">Coincidencias de ejemplo</span><span class="sxs-lookup"><span data-stu-id="69012-1541">Example Matches</span></span> | <span data-ttu-id="69012-1542">Notas</span><span class="sxs-lookup"><span data-stu-id="69012-1542">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="69012-1543">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-1543">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-1544">Coincide con cualquier entero</span><span class="sxs-lookup"><span data-stu-id="69012-1544">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="69012-1545">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="69012-1545">`true`, `FALSE`</span></span> | <span data-ttu-id="69012-1546">Coincide con `true` o `false` (no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="69012-1546">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="69012-1547">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="69012-1547">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="69012-1548">Coincide con un valor `DateTime` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1548">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="69012-1549">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1549">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="69012-1550">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="69012-1550">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="69012-1551">Coincide con un valor `decimal` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1551">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="69012-1552">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1552">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="69012-1553">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-1553">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-1554">Coincide con un valor `double` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1554">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="69012-1555">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1555">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="69012-1556">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="69012-1556">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="69012-1557">Coincide con un valor `float` válido en la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1557">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="69012-1558">Vea la advertencia anterior.</span><span class="sxs-lookup"><span data-stu-id="69012-1558">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="69012-1559">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="69012-1559">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="69012-1560">Coincide con un valor `Guid` válido</span><span class="sxs-lookup"><span data-stu-id="69012-1560">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="69012-1561">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="69012-1561">`123456789`, `-123456789`</span></span> | <span data-ttu-id="69012-1562">Coincide con un valor `long` válido</span><span class="sxs-lookup"><span data-stu-id="69012-1562">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="69012-1563">La cadena debe tener al menos cuatro caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-1563">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="69012-1564">La cadena no debe tener más de ocho caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-1564">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="69012-1565">La cadena debe tener una longitud de exactamente 12 caracteres</span><span class="sxs-lookup"><span data-stu-id="69012-1565">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="69012-1566">La cadena debe tener una longitud como mínimo de ocho caracteres y como máximo de 16</span><span class="sxs-lookup"><span data-stu-id="69012-1566">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="69012-1567">El valor entero debe ser como mínimo 18</span><span class="sxs-lookup"><span data-stu-id="69012-1567">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="69012-1568">El valor entero debe ser como máximo 120</span><span class="sxs-lookup"><span data-stu-id="69012-1568">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="69012-1569">El valor entero debe ser como mínimo 18 y máximo 120</span><span class="sxs-lookup"><span data-stu-id="69012-1569">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="69012-1570">La cadena debe constar de uno o más caracteres alfabéticos (`a`-`z`, no distingue mayúsculas de minúsculas)</span><span class="sxs-lookup"><span data-stu-id="69012-1570">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="69012-1571">La cadena debe coincidir con la expresión regular (vea las sugerencias sobre cómo definir una expresión regular)</span><span class="sxs-lookup"><span data-stu-id="69012-1571">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="69012-1572">Se usa para exigir que un valor que no es de parámetro esté presente durante la generación de dirección URL</span><span class="sxs-lookup"><span data-stu-id="69012-1572">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="69012-1573">Es posible aplicar varias restricciones delimitadas por dos puntos a un único parámetro.</span><span class="sxs-lookup"><span data-stu-id="69012-1573">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="69012-1574">Por ejemplo, la siguiente restricción permite limitar un parámetro a un valor entero de 1 o superior:</span><span class="sxs-lookup"><span data-stu-id="69012-1574">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="69012-1575">Las restricciones de ruta que comprueban la dirección URL y que se convierten en un tipo CLR (como `int` o `DateTime`) usan siempre la referencia cultural invariable.</span><span class="sxs-lookup"><span data-stu-id="69012-1575">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="69012-1576">Estas restricciones dan por supuesto que la dirección URL no es localizable.</span><span class="sxs-lookup"><span data-stu-id="69012-1576">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="69012-1577">Las restricciones de ruta proporcionadas por el marco de trabajo no modifican los valores almacenados en los valores de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1577">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="69012-1578">Todos los valores de ruta analizados desde la dirección URL se almacenan como cadenas.</span><span class="sxs-lookup"><span data-stu-id="69012-1578">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="69012-1579">Por ejemplo, la restricción `float` intenta convertir el valor de ruta en un valor Float, pero el valor convertido se usa exclusivamente para comprobar que se puede convertir en Float.</span><span class="sxs-lookup"><span data-stu-id="69012-1579">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="69012-1580">Expresiones regulares</span><span class="sxs-lookup"><span data-stu-id="69012-1580">Regular expressions</span></span>

<span data-ttu-id="69012-1581">El marco de trabajo de ASP.NET Core agrega `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` al constructor de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1581">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="69012-1582">Vea <xref:System.Text.RegularExpressions.RegexOptions> para obtener una descripción de estos miembros.</span><span class="sxs-lookup"><span data-stu-id="69012-1582">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="69012-1583">Las expresiones regulares usan delimitadores y tokens similares a los que usan el enrutamiento y el lenguaje C#.</span><span class="sxs-lookup"><span data-stu-id="69012-1583">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="69012-1584">Es necesario usar secuencias de escape con los tokens de expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1584">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="69012-1585">Para usar la expresión regular `^\d{3}-\d{2}-\d{4}$` en el enrutamiento, los caracteres `\` (una barra diagonal inversa) de la cadena se deben proporcionar como caracteres `\\` (barra diagonal inversa doble) en el archivo de código fuente de C# para que el carácter de escape de cadena `\` tenga una secuencia de escape (a menos que se usen [literales de cadena textuales](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="69012-1585">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="69012-1586">Para aplicar secuencias de escape a los caracteres delimitadores de parámetro de enrutamiento (`{`, `}`, `[` y `]`), duplique los caracteres en la expresión (`{{`, `}`, `[[` y `]]`).</span><span class="sxs-lookup"><span data-stu-id="69012-1586">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="69012-1587">En la tabla siguiente se muestra una expresión regular y la versión con la secuencia de escape.</span><span class="sxs-lookup"><span data-stu-id="69012-1587">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="69012-1588">Expresión regular</span><span class="sxs-lookup"><span data-stu-id="69012-1588">Regular Expression</span></span>    | <span data-ttu-id="69012-1589">Expresión regular con secuencia de escape</span><span class="sxs-lookup"><span data-stu-id="69012-1589">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="69012-1590">Las expresiones regulares que se usan en el enrutamiento suelen empezar con el carácter de acento circunflejo (`^`) y coinciden con la posición inicial de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-1590">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="69012-1591">Las expresiones suelen terminar con el carácter del signo de dólar (`$`) y coincidir con el final de la cadena.</span><span class="sxs-lookup"><span data-stu-id="69012-1591">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="69012-1592">Los caracteres `^` y `$` garantizan que la expresión regular coincide con el valor completo del parámetro de ruta.</span><span class="sxs-lookup"><span data-stu-id="69012-1592">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="69012-1593">Sin los caracteres `^` y `$`, la expresión regular coincide con cualquier subcadena de la cadena, algo que normalmente no es deseable.</span><span class="sxs-lookup"><span data-stu-id="69012-1593">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="69012-1594">En la tabla siguiente se proporcionan ejemplos y se explica por qué coinciden o no.</span><span class="sxs-lookup"><span data-stu-id="69012-1594">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="69012-1595">Expresión</span><span class="sxs-lookup"><span data-stu-id="69012-1595">Expression</span></span>   | <span data-ttu-id="69012-1596">String</span><span class="sxs-lookup"><span data-stu-id="69012-1596">String</span></span>    | <span data-ttu-id="69012-1597">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="69012-1597">Match</span></span> | <span data-ttu-id="69012-1598">Comentario</span><span class="sxs-lookup"><span data-stu-id="69012-1598">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="69012-1599">hello</span><span class="sxs-lookup"><span data-stu-id="69012-1599">hello</span></span>     | <span data-ttu-id="69012-1600">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1600">Yes</span></span>   | <span data-ttu-id="69012-1601">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-1601">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-1602">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-1602">123abc456</span></span> | <span data-ttu-id="69012-1603">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1603">Yes</span></span>   | <span data-ttu-id="69012-1604">Coincidencias de subcadenas</span><span class="sxs-lookup"><span data-stu-id="69012-1604">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="69012-1605">mz</span><span class="sxs-lookup"><span data-stu-id="69012-1605">mz</span></span>        | <span data-ttu-id="69012-1606">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1606">Yes</span></span>   | <span data-ttu-id="69012-1607">Coincide con la expresión</span><span class="sxs-lookup"><span data-stu-id="69012-1607">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="69012-1608">MZ</span><span class="sxs-lookup"><span data-stu-id="69012-1608">MZ</span></span>        | <span data-ttu-id="69012-1609">Sí</span><span class="sxs-lookup"><span data-stu-id="69012-1609">Yes</span></span>   | <span data-ttu-id="69012-1610">No distingue mayúsculas de minúsculas</span><span class="sxs-lookup"><span data-stu-id="69012-1610">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="69012-1611">hello</span><span class="sxs-lookup"><span data-stu-id="69012-1611">hello</span></span>     | <span data-ttu-id="69012-1612">No</span><span class="sxs-lookup"><span data-stu-id="69012-1612">No</span></span>    | <span data-ttu-id="69012-1613">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-1613">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="69012-1614">123abc456</span><span class="sxs-lookup"><span data-stu-id="69012-1614">123abc456</span></span> | <span data-ttu-id="69012-1615">No</span><span class="sxs-lookup"><span data-stu-id="69012-1615">No</span></span>    | <span data-ttu-id="69012-1616">Vea `^` y `$` más arriba</span><span class="sxs-lookup"><span data-stu-id="69012-1616">See `^` and `$` above</span></span> |

<span data-ttu-id="69012-1617">Para obtener más información sobre la sintaxis de expresiones regulares, vea [Expresiones regulares de .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="69012-1617">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="69012-1618">Para restringir un parámetro a un conjunto conocido de valores posibles, use una expresión regular.</span><span class="sxs-lookup"><span data-stu-id="69012-1618">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="69012-1619">Por ejemplo, `{action:regex(^(list|get|create)$)}` solo hace coincidir el valor de ruta `action` con `list`, `get` o `create`.</span><span class="sxs-lookup"><span data-stu-id="69012-1619">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="69012-1620">Si se pasa al diccionario de restricciones, la cadena `^(list|get|create)$` es equivalente.</span><span class="sxs-lookup"><span data-stu-id="69012-1620">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="69012-1621">Las restricciones que se pasan al diccionario de restricciones (no insertado en una plantilla) que no coinciden con una de las restricciones conocidas también se tratan como expresiones regulares.</span><span class="sxs-lookup"><span data-stu-id="69012-1621">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="69012-1622">Restricciones de ruta personalizadas</span><span class="sxs-lookup"><span data-stu-id="69012-1622">Custom Route Constraints</span></span>

<span data-ttu-id="69012-1623">Además de las restricciones de ruta integradas, se pueden crear restricciones de ruta personalizadas implementando la interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="69012-1623">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="69012-1624">La interfaz <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> contiene un único método, `Match`, que devuelve `true` si se cumple la restricción, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="69012-1624">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="69012-1625">Para utilizar una restricción <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> personalizada, el tipo de restricción de ruta debe registrarse con el parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de la aplicación en el contenedor de servicios de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69012-1625">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="69012-1626"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> es un diccionario que asigna claves de restricciones de ruta a implementaciones de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> que validen esas restricciones.</span><span class="sxs-lookup"><span data-stu-id="69012-1626">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="69012-1627">El parámetro <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> de una aplicación puede actualizarse en `Startup.ConfigureServices` como parte de una llamada a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) o configurando <xref:Microsoft.AspNetCore.Routing.RouteOptions> directamente con `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="69012-1627">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="69012-1628">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="69012-1628">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="69012-1629">La restricción puede aplicarse a las rutas de la manera habitual, usando el nombre especificado al registrar el tipo de restricción.</span><span class="sxs-lookup"><span data-stu-id="69012-1629">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="69012-1630">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="69012-1630">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="69012-1631">Referencia de generación de direcciones URL</span><span class="sxs-lookup"><span data-stu-id="69012-1631">URL generation reference</span></span>

<span data-ttu-id="69012-1632">En el ejemplo siguiente se muestra cómo se genera un vínculo a una ruta, dado un diccionario de valores de ruta y un valor <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="69012-1632">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="69012-1633">El valor <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generado al final del ejemplo anterior es `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="69012-1633">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="69012-1634">El diccionario proporciona los valores de ruta `operation` e `id` de la plantilla "Ruta de paquete de seguimiento", `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1634">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="69012-1635">Para obtener más información, vea el código de ejemplo de la sección [Uso de software intermedio de enrutamiento](#use-routing-middleware) o la [aplicación de ejemplo](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="69012-1635">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="69012-1636">El segundo parámetro del constructor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> es una colección de *valores de ambiente*.</span><span class="sxs-lookup"><span data-stu-id="69012-1636">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="69012-1637">Los valores de ambiente son adecuados porque limitan el número de valores que el desarrollador debe especificar dentro de un contexto de solicitud.</span><span class="sxs-lookup"><span data-stu-id="69012-1637">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="69012-1638">Los valores de ruta actuales de la solicitud actual se consideran valores de ambiente para la generación de vínculos.</span><span class="sxs-lookup"><span data-stu-id="69012-1638">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="69012-1639">En la acción `About` de `HomeController` de una aplicación ASP.NET Core MVC, no es necesario especificar el valor de ruta de controlador para vincular a la acción `Index` (se usará el valor de ambiente `Home`).</span><span class="sxs-lookup"><span data-stu-id="69012-1639">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="69012-1640">Los valores de ambiente que no coincidan con un parámetro se omiten.</span><span class="sxs-lookup"><span data-stu-id="69012-1640">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="69012-1641">También se omiten los valores de ambiente cuando un valor proporcionado de forma explícita invalida el valor de ambiente.</span><span class="sxs-lookup"><span data-stu-id="69012-1641">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="69012-1642">La coincidencia se produce de izquierda a derecha en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="69012-1642">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="69012-1643">Los valores que se proporcionan de forma explícita pero que no coinciden con un segmento de la ruta se agregan a la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="69012-1643">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="69012-1644">En la tabla siguiente se muestra el resultado cuando se usa la plantilla de ruta `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="69012-1644">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="69012-1645">Valores de ambiente</span><span class="sxs-lookup"><span data-stu-id="69012-1645">Ambient Values</span></span>                     | <span data-ttu-id="69012-1646">Valores explícitos</span><span class="sxs-lookup"><span data-stu-id="69012-1646">Explicit Values</span></span>                        | <span data-ttu-id="69012-1647">Resultado</span><span class="sxs-lookup"><span data-stu-id="69012-1647">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="69012-1648">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1648">controller = "Home"</span></span>                | <span data-ttu-id="69012-1649">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1649">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-1650">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1650">controller = "Home"</span></span>                | <span data-ttu-id="69012-1651">controller = "Order", action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1651">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="69012-1652">controller = "Home", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-1652">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="69012-1653">action = "About"</span><span class="sxs-lookup"><span data-stu-id="69012-1653">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="69012-1654">controller = "Home"</span><span class="sxs-lookup"><span data-stu-id="69012-1654">controller = "Home"</span></span>                | <span data-ttu-id="69012-1655">action = "About", color = "Red"</span><span class="sxs-lookup"><span data-stu-id="69012-1655">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="69012-1656">Si una ruta tiene un valor predeterminado que no se corresponde con un parámetro y ese valor se proporciona de forma explícita, debe coincidir con el valor predeterminado:</span><span class="sxs-lookup"><span data-stu-id="69012-1656">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="69012-1657">La generación de vínculos solo genera un vínculo para esta ruta si se proporcionan los valores coincidentes para `controller` y `action`.</span><span class="sxs-lookup"><span data-stu-id="69012-1657">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="69012-1658">Segmentos complejos</span><span class="sxs-lookup"><span data-stu-id="69012-1658">Complex segments</span></span>

<span data-ttu-id="69012-1659">Los segmentos complejos (por ejemplo, `[Route("/x{token}y")]`), se procesan buscando coincidencias de literales de derecha a izquierda de un modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="69012-1659">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="69012-1660">Consulte [este código](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) para obtener una explicación detallada de cómo se comparan los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="69012-1660">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="69012-1661">El [código de ejemplo](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) no se usa en ASP.NET Core, pero proporciona una buena explicación de los segmentos complejos.</span><span class="sxs-lookup"><span data-stu-id="69012-1661">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>

::: moniker-end
